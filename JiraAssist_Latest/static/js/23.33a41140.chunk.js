(this["webpackJsonpjira-assistant"]=this["webpackJsonpjira-assistant"]||[]).push([[23],{244:function(e,t,a){"use strict";a.d(t,"c",(function(){return O})),a.d(t,"a",(function(){return x.a}));var r=a(5),n=a(6),o=a(46),i=a(15),s=a(16),l=a(2),c=a.n(l),u=a(114),p=a(22),d=a.n(p),h=a(29),f=a(259),v=a(13),m=a.n(v),g=a(32),y=(a(315),a(329)),b=(a(354),a(271)),k=a(10),w=function(){function e(){Object(r.a)(this,e)}return Object(n.a)(e,[{key:"export",value:function(){this.format&&"XLSX"===this.format.toUpperCase()?this.exportToXlsx():this.format&&this.format===b.a.PDF?this.exportToPDF():this.exportToCsv()}},{key:"exportToXlsx",value:function(){var e=p(this.element),t=new b.b(b.a.XLSX);e.find("table.exportable").each((function(e,a){return t.addTable(a)})),t.export(this.fileName)}},{key:"exportToCsv",value:function(){var e=p(this.element);e.is("table")||(e=e.find("table.exportable")),this.exportTable(e,e.attr("export-sheet-name")||this.fileName||"download")}},{key:"exportToPDF",value:function(){var e=p(this.element).find("table.exportable:first-child"),t=e.attr("export-sheet-name")||this.fileName||"download",a=new y.default({orientation:"landscape",unit:"in",format:"a3"});a.autoTable({html:e.get(0)}),a.save("".concat(t,".pdf"))}},{key:"exportTable",value:function(e,t){var a=[],r=null;function n(e,t){var a=[];e.each((function(e,r){p(r).children("th,td").each((function(r,n){n=p(n);var o=a[e];for(o||(o=a[e]=[]);null!=o[r];)r++;var i=t[r];i&&i.noExport||(t[r]={noExport:n.is("[no-export]")||n.is(":hidden")&&!n.is("[force-export]")}),o[r]=function(e){var t={encode:!0,trim:!0},a=e.attr("export-option");a=a&&a.length>10?p.extend(t,JSON.parse(a)):t;var r=e.find("[export-data]:first"),n=(e.attr("export-data")||r.attr("export-data")||r.text()||e.text()).replace(/\r?\n|\r/g," ");return a.trim&&(n=n.trim()),n.indexOf('"')>=0&&(n=n.replace(/"/g,'""')),a.encode&&n.indexOf(",")>=0&&(n='"'.concat(n,'"')),n}(n);for(var s=parseInt(n.attr("colspan"));s>1;)o[r+s-1]="",s--;for(var l=parseInt(n.attr("rowspan"));l>1;){var c=a[e+l-1];c||(c=a[e+l-1]=[]),c[r]="",l--}}))}));for(var r="",n=0;n<a.length;n++){for(var o="",i=a[n],s=0;s<i.length;s++){var l;null!==(l=t[s])&&void 0!==l&&l.noExport||(o+=",".concat(i[s]||""))}r+="".concat(o.substring(1).replace(/\r?\n|\r/g," "),"\r\n")}return r}r="string"===typeof e?n(p("#".concat(e," thead:not([no-export]) tr:not([no-export]):visible")),a)+n(p("#".concat(e," tbody:visible tr:not([no-export]):visible")),a):n(e.find("thead:not([no-export]) tr:not([no-export]):visible"),a)+n(e.find("tbody:visible tr:not([no-export]):visible"),a),Object(k.a)(r,t)}}]),e}(),x=a(47),C=a(35),S=a(1),O=new h.EventEmitter,E=function(e){Object(i.a)(a,e);var t=Object(s.a)(a);function a(e,n,i){var s;Object(r.a)(this,a),(s=t.call(this,e)).eventReceived=function(e){return s.executeEvent(e)},s.toggleFullScreen=function(){var e=s.state.isFullScreen;e=!e,s.$analytics.trackEvent("Toggle full screen",S.i.GadgetActions,s.title,e),e?s.bodyTag.addClass("fs-layout"):s.bodyTag.removeClass("fs-layout"),s.columnResizeMode=e?"fit":"expand",s.setState({isFullScreen:e}),s.onResize()},s.addWorklogOn=function(e){s.addWorklog({ticketNo:e})},s.removeGadget=function(){s.$analytics.trackEvent("Gadget removed",S.i.GadgetActions,s.title),s.performAction(x.a.RemoveGadget)},s.exportData=function(e){var t=new w;t.fileName=s.title,t.format=e||s.exportFormat,t.element=s.el,s.$analytics.trackEvent("Export data",S.i.GadgetActions,t.format),t.export()},s.showGadgetGontextMenu=function(e){return Object(g.showContextMenu)(e,s.getContextMenu())},s.getHeader=function(){var e=Object(o.a)(s),t=e.title,a=e.subTitle,r=e.isGadget,n=e.props.draggableHandle,i="gadget-header".concat(n?" movable":"");return c.a.createElement("div",{ref:n,className:i,onContextMenu:r?s.showGadgetGontextMenu:null,onDoubleClick:s.toggleFullScreen},c.a.createElement("i",{className:"fa ".concat(s.iconClass)})," ",t," ",a&&c.a.createElement("span",null," - ",a),c.a.createElement("div",{className:"pull-right"},s.renderCustomActions&&s.renderCustomActions(r),!s.hideRefresh&&s.getRefreshButton(),!s.hideMenu&&c.a.createElement(f.a,{icon:"fa fa-wrench",onClick:function(e){return Object(g.showContextMenu)(e,s.getContextMenu())}})))},s.setRef=function(e){s.el=e;var t=s.props.dropProps,a=(t=void 0===t?{}:t).dropConnector;a&&a(e)},Object(C.b)(Object(o.a)(s),"AnalyticsService"),s.title=n,s.iconClass=i,s.isGadget=!1!==e.isGadget,s.settings=e.settings||{fullWidth:!1,fullHeight:!1},s.bodyTag=d()(document.body);var l=s.settings,u=l.fullWidth,p=void 0!==u&&u,h=l.fullHeight,v=void 0!==h&&h;return s.state={fullWidth:p,fullHeight:v},s}return Object(n.a)(a,[{key:"getContextMenu",value:function(){var e=this,t=this.state,a=t.isFullScreen,r=t.fullWidth,n=t.fullHeight,o=this.isGadget?[{separator:!0},{label:"Full width",icon:"fa fa-".concat(r?"check-":"","circle fs-16 margin-r-5"),command:function(){return e.setSizeOptions(!r,n)}},{label:"Full height",icon:"fa fa-".concat(n?"check-":"","circle fs-16 margin-r-5"),command:function(){return e.setSizeOptions(r,!n)}},{separator:!0},{label:"Remove",icon:"fa fa-remove",command:function(){return e.removeGadget()}}]:[],i=[];return this.hideExport||(i.push({separator:!0}),this.hideCSVExport||i.push({label:"Export to CSV",icon:"fa fa-file-text-o",disabled:!this.exportData,command:function(){return e.exportData(b.a.CSV)}}),this.hideXLSXExport||i.push({label:"Export to Excel",icon:"fa fa-file-excel-o",disabled:!this.exportData,command:function(){return e.exportData(b.a.XLSX)}}),this.hidePDFExport||i.push({label:"Export to PDF",icon:"fa fa-file-pdf-o",disabled:!this.exportData,command:function(){return e.exportData(b.a.PDF)}})),[{label:"Toggle full screen",icon:"fa fa-".concat(a?"compress":"expand"),command:function(){return e.toggleFullScreen()}}].concat(i,o)}},{key:"componentDidMount",value:function(){this.isGadget&&(O.on("change",this.eventReceived),this.$analytics.trackEvent("Gadget loaded",S.i.GadgetActions,this.title))}},{key:"componentWillUnmount",value:function(){O.off("change",this.eventReceived)}},{key:"onResize",value:function(e){}},{key:"setSizeOptions",value:function(e,t){var a=this.settings;a.fullWidth=e,a.fullHeight=t,this.setState({fullWidth:e,fullHeight:t}),this.saveSettings()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){if(e.layout&&this.onResize(),this.settings!==e.settings){this.settings=e.settings||{};var t=this.settings,a=t.fullWidth,r=t.fullHeight;this.setState({fullWidth:a,fullHeight:r})}}},{key:"performAction",value:function(e,t){var a=this.props.onAction;a&&a({type:e,data:t},this.props.model,this.props.index)}},{key:"addWorklog",value:function(e){this.performAction(x.a.AddWorklog,e)}},{key:"editWorklog",value:function(e){this.performAction(x.a.AddWorklog,{id:e})}},{key:"saveSettings",value:function(){this.performAction(x.a.SettingsChanged,this.settings)}},{key:"executeEvent",value:function(e){e.type===x.a.RemoveGadget&&this.onResize()}},{key:"getFullScreenButton",value:function(){if(this.isGadget)return null;var e=this.state.isFullScreen;return c.a.createElement(f.a,{icon:e?"fa fa-compress":"fa fa-expand",onClick:this.toggleFullScreen,title:"Toggle full screen"})}},{key:"getRefreshButton",value:function(e){var t=this.state,a=t.disableRefresh,r=t.isLoading;return c.a.createElement(f.a,{icon:"fa fa-refresh",disabled:a||r,onClick:e||this.refreshData,title:"Refresh data"})}},{key:"renderBase",value:function(e){var t=this.state,a=t.fullWidth,r=t.fullHeight,n=t.isLoading,o=t.isFullScreen,i=this.isGadget;if(this.props.tabLayout)return c.a.createElement(c.a.Fragment,null,e,this.renderFooter&&this.renderFooter());var s=a||!i,l=r||!i,p=m()("gadget",this.className,{docked:!i,"full-width":s&&!o,"full-height":l&&!o,"half-width":!s&&!o,"half-height":!l&&!o,"full-screen":o});return c.a.createElement("div",{ref:this.setRef,className:p},n&&c.a.createElement("div",{className:"data-loader"},c.a.createElement("i",{className:"fa fa-refresh fa-spin"})),c.a.createElement(u.Panel,{header:this.getHeader()},e,this.renderFooter&&this.renderFooter()))}},{key:"render",value:function(){return c.a.createElement("div",{ref:this.setRef,className:"gadget half-width half-height"},c.a.createElement(u.Panel,{header:"Gadget Unavailable"},c.a.createElement("div",{className:"pad-22"},"This section contains an un-known gadget. Please report about this issue to have it fixed!")))}}]),a}(l.PureComponent);t.b=E},271:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c}));var r=a(5),n=a(6),o=a(22),i=a(355),s=a.n(i),l=function(){function e(t){Object(r.a)(this,e);var a=new s.a.Workbook;a.created=new Date,a.creator="Jira Assistant",a.lastModifiedBy="Jira Assistant",this.document=a}return Object(n.a)(e,[{key:"addTable",value:function(e){var t=this;e=o(e);var a=this.normalizeSheetName(e.attr("export-sheet-name"));console.log("Exporting ",a),this.worksheet=this.document.addWorksheet(a),this.sheetOptions={mergeCells:[],width:{},styles:[],rowsToRemove:[],rowsToHide:[]},this.curRowNum=1;var r=e.find("> thead:not([exportignore]) > tr:not([exportignore])");this.prepareData(r),console.log("header rows",r.length);var n=e.find("> tbody:not([exportignore]) > tr:not([exportignore])");this.prepareData(n),console.log("bodyRows rows",n.length),this.worksheet.views=[{state:"frozen",xSplit:0,ySplit:r.length}],this.sheetOptions.mergeCells.forEach((function(e){return t.worksheet.mergeCells(e)}));var i=this.sheetOptions.width;Object.keys(i).forEach((function(e){var a=t.worksheet.getColumn(e),r=parseFloat(i[e])/7.178;a.width=r})),this.sheetOptions.styles.forEach((function(e){var a=t.worksheet.getCell(e.key),r=e.style,n={};"left"!==r.textAlign&&(n.horizontal=r.textAlign),"left"!==r.verticalAlign&&(n.vertical=r.verticalAlign),a.alignment=n;var o=r.fontWeight||"";a.style.font={size:t.getFontSize(r.fontSize),bold:o.indexOf("bold")>-1||o>=550}})),this.sheetOptions.rowsToHide.forEach((function(e){return t.worksheet.getRow(e).hidden=!0})),this.sheetOptions.rowsToRemove.orderByDescending().forEach((function(e){return t.worksheet.spliceRows(e,1)})),this.worksheet=null,this.sheetOptions=null,this.curRowNum=null}},{key:"normalizeSheetName",value:function(e){return e?e.replace(/\[/g,"(").replace(/\]/g,")").replace(/:/g,"-").replace(/[?/\\]/g,""):e}},{key:"trim",value:function(e){return e.replace(/^\s+|\s+$/gm,"")}},{key:"getFontSize",value:function(e){return e?e.endsWith("px")?.75*parseInt(e.replace("px",""),10):e.endsWith("pt")?parseInt(e.replace("pt",""),10):e.endsWith("em")?.0833333*parseInt(e.replace("em",""),10):void 0:e}},{key:"rgbaToHex",value:function(e){if(!e)return e;var t=e.substring(e.indexOf("(")).split(","),a=parseInt(this.trim(t[0].substring(1)),10),r=parseInt(this.trim(t[1]),10),n=parseInt(this.trim(t[2]),10);t[3]=t[3]||"1)";var o=parseFloat(this.trim(t[3].substring(0,t[3].length-1))).toFixed(2);return this.fixSize(a.toString(16))+this.fixSize(r.toString(16))+this.fixSize(n.toString(16))+this.fixSize((255*o).toString(16).substring(0,2))}},{key:"fixSize",value:function(e){return 1===e.length?"0".concat(e):e}},{key:"prepareData",value:function(e){var t=this,a=this.worksheet,r=[];e.each((function(e,n){n=o(n);var i=t.getColArray(n,r);i&&(a.addRow(i).commit(),t.curRowNum++)}))}},{key:"getColArray",value:function(e,t){var a=this,r=e.find("> th, > td"),n=[],i=!!e.attr("exportignore");return i&&this.sheetOptions.rowsToRemove.push(this.curRowNum),e.attr("exporthidden")&&this.sheetOptions.rowsToHide.push(this.curRowNum),r.each((function(e,r){for(;t[n.length]>0;)t[n.length]=t[n.length]-1,n[n.length]=null;var s=(r=o(r)).attr("exportValue");if(s||(s=r.text()),s&&!i)switch(s=s.trim(),r.attr("exportType")){case"int":s=function(e){if(!e)return e;var t=parseInt(e,10);return isNaN(t)?e:t}(s);break;case"float":case"number":s=function(e){if(!e)return e;var t=parseFloat(e);return isNaN(t)?e:t}(s);break;case"date":s=u(s,!0);break;case"datetime":s=u(s,!1)}n[n.length]=s;var l=r.attr("colspan")||1,c=(r.attr("rowspan")||1)-1;c&&(t[n.length-1]=c);var p=a.numToChar(n.length),d=a.curRowNum;if(l>1||c>0){var h=a.numToChar(n.length+(l-1)),f=a.curRowNum+c;a.sheetOptions.mergeCells.push("".concat(p+d,":").concat(h).concat(f))}if(!i){if(!l||l<2){var v=r.width();v>20&&(a.sheetOptions.width[p]=v)}a.sheetOptions.styles.push({key:p+d,style:window.getComputedStyle(r.get(0),null)})}for(;l>1;)l-=1,n[n.length]=null,c&&(t[n.length-1]=c)})),n}},{key:"export",value:function(e){this.document.xlsx.writeBuffer().then((function(t){!function(e,t){var a=new FileReader;a.onload=function(r){!function(e,t,a){var r=btoa(e),n="data:".concat(t,";base64,").concat(r),o=document.createElement("a");"download"in o?(o.href=n,o.setAttribute("download",a),document.body.appendChild(o),setTimeout((function(){o.click(),document.body.removeChild(o)}),66)):document.location.href=n}(a.result,e.type,t)},a.readAsBinaryString(e)}(new Blob([t],{type:"application/octet-stream"}),"".concat(e,".xlsx"))}))}},{key:"charToNum",value:function(e){for(var t=0,a=1;t<a;t++,a++)e==this.numToChar(t)&&(a=t)}},{key:"numToChar",value:function(e){var t=(e-1)%26,a=this.chr(65+t),r=parseInt((e-1)/26,10);return r>0?this.numToChar(r)+a:a}},{key:"chr",value:function(e){return e>65535?(e-=65536,String.fromCharCode(55296+(e>>10),56320+(1023&e))):String.fromCharCode(e)}}]),e}(),c={XLSX:"XLSX",CSV:"CSV",PDF:"PDF"};function u(e,t){if(!e)return e;var a=new Date(e);return isNaN(a.getTime())?e:a}},297:function(e,t,a){"use strict";var r=a(5),n=a(6),o=a(243),i=a(37),s=a(15),l=a(16),c=a(2),u=a.n(c),p=a(247),d=a(242),h=function(e){Object(s.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e,"Save Report As")).nameChanged=function(e){return n.setState({newQueryName:e})},n.copyChanged=function(e){return n.setState({copyQuery:e})},n.done=function(){var e=n.state,t=e.newQueryName,a=e.copyQuery;n.props.onChange(t,a)},n.style={width:"350px"},n.state={showDialog:!0,newQueryName:e.queryName||"",copyQuery:!1},n}return Object(n.a)(a,[{key:"getFooter",value:function(){var e=this.state.newQueryName;return u.a.createElement(u.a.Fragment,null,u.a.createElement(d.b,{type:"secondary",label:"Cancel",onClick:this.onHide}),u.a.createElement(d.b,{type:"primary",icon:"fa fa-floppy-o",label:"Save",disabled:!e||e.length<3,onClick:this.done}))}},{key:"render",value:function(){var e=this.props.allowCopy,t=this.state,r=t.newQueryName,n=t.copyQuery;return Object(o.a)(Object(i.a)(a.prototype),"renderBase",this).call(this,u.a.createElement("div",{className:"pad-15"},u.a.createElement("label",null,"Report Name"),u.a.createElement("div",null,u.a.createElement(d.j,{value:r,onChange:this.nameChanged,style:{width:"100%"}})),e&&u.a.createElement("div",null,u.a.createElement(d.c,{checked:n,onChange:this.copyChanged,label:"Save as new report"}))))}}]),a}(p.a);t.a=h},315:function(e,t,a){},332:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var r=a(54);function n(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=Object(r.a)(e))){var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}},400:function(e,t,a){"use strict";var r=a(8),n=a(0),o=a.n(n),i=a(4),s=a(5),l=a(6),c=a(46),u=a(243),p=a(37),d=a(15),h=a(16),f=a(2),v=a.n(f),m=a(264),g=a(242),y=a(244),b=a(9),k=a(31),w=a(332),x=a(253),C=a(49);function S(e){return O.apply(this,arguments)}function O(){return(O=Object(i.a)(o.a.mark((function e(t){var a,r,n,i,s,l,c,u,p,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",{});case 2:return a=Object(b.c)("JiraService"),r=t.fields.map((function(e){return e.field})),e.next=6,a.searchTickets(t.jql,r);case 6:return n=e.sent,i={},s=t.fields.map(E.bind(i)),i.fieldWithExpr=s.filter((function(e){return!!e.ast})),l=n.map(j.bind(i)),i.hasWorklogs&&(c=i.usersObj,(u=Object.keys(c).map((function(e){return{field:e,displayText:c[e].displayName,type:"seconds",groupText:"Log Work",allowGrouping:!1,viewComponent:x.j,props:{}}}))).push({field:"totalWorklog",displayText:"Total Log Work",type:"seconds",groupText:"Log Work",allowGrouping:!1,viewComponent:x.j,props:{}}),p=s.findIndex((function(e){return"worklog"===e.field})),s.splice.apply(s,[p,1].concat(Object(k.a)(u)))),d={isLoading:!1,reportData:l,columnList:s,settings:t.settings},e.abrupt("return",d);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){var t=e.id,a=e.field,r=e.name,n=e.header,o=void 0===n?r:n,i=e.type,s=e.isArray,l=e.expr,c={id:t,field:a,displayText:o,type:i,props:{},allowSorting:!s,allowGrouping:"summary"!==a&&"description"!==a};return l?(c.ast=Object(C.c)(l),c.exprField=a,c.field=t,c.viewComponent=x.l):c.viewComponent=function(e,t,a){var r=t.props;switch(e){case"issuekey":return x.i;case"epicLink":return r.hideContext=!0,x.i;case"project":return t.fieldKey="".concat(t.field,".name"),x.g;case"user":return t.fieldKey="".concat(t.field,".displayName"),x.m;case"comment":return t.allowSorting=!1,x.a;case"issuelinks":return x.d;case"seconds":return x.j;case"workratio":return r.converter=function(e){return-1===e?null:e},x.j;case"timetracking":return x.k;case"parent":return t.fieldKey="".concat(t.field,".key"),x.c;case"progress":case"aggregateprogress":return t.fieldKey="".concat(t.field,".percent"),x.f;case"sprint":return x.h;case"attachment":return r.hrefProp="content",r.iconClass="fa-paperclip",r.tagProp="filename",x.h;case"component":return r.titleProp="description",x.h;case"version":return r.titleProp="releaseDate",x.h;case"option":return t.fieldKey="".concat(t.field,".value"),r.tagProp="value",x.h;case"votes":return t.fieldKey="".concat(t.field,".votes"),r.tagProp="votes",r.hideZero=!0,x.h;case"watches":return t.fieldKey="".concat(t.field,".watchCount"),r.tagProp="watchCount",r.hideZero=!0,x.h;case"date":case"datetime":return x.b;case"issuetype":case"status":case"priority":case"resolution":return t.fieldKey="".concat(t.field,".name"),x.e;case"epicStatus":return r.textField="value",r.iconField="",t.fieldKey="".concat(t.field,".value"),x.e;case"string":return a?(r.tagProp="",x.h):null;case"number":return x.l;default:return t.allowSorting=!1,t.allowGrouping=!1,x.l}}("issuekey"===a?"issuekey":i,c,s),c.allowSorting||(c.allowGrouping=!1),c.allowGrouping&&function(e){var t=[{type:"check",label:"Issue count",prop:"showGroupCount",value:!0},{separator:!0}];switch(e.type){default:return;case"issuetype":case"status":case"priority":case"resolution":t.splice(1,1);break;case"string":t.push({type:"radio",label:"Show value",prop:"valueType",value:"value",default:!0}),t.push({type:"radio",label:"Show count",prop:"valueType",value:"count"}),t.push({type:"radio",label:"Distinct count",prop:"valueType",value:"distinct"});break;case"user":t[1]={type:"check",label:"Show Image",prop:"showImage"},t.push({separator:!0}),t.push({type:"radio",label:"Show name",prop:"valueType",value:"name",default:!0}),t.push({type:"radio",label:"Show email id",prop:"valueType",value:"email"}),t.push({type:"radio",label:"Show both",prop:"valueType",value:"both"});break;case"project":t.push({type:"radio",label:"Show name",prop:"valueType",value:"name"}),t.push({type:"radio",label:"Show key",prop:"valueType",value:"key",default:!0}),t.push({type:"radio",label:"Show both",prop:"valueType",value:"both"});break;case"parent":t[1]={type:"check",label:"Show status",prop:"showStatus",default:!0},t.push({separator:!0}),t.push({type:"radio",label:"Show key",prop:"valueType",value:"key",default:!0}),t.push({type:"radio",label:"Show summary",prop:"valueType",value:"summary"}),t.push({type:"radio",label:"Show both",prop:"valueType",value:"both"});break;case"date":case"datetime":t.push({type:"radio",label:"Friendly date",prop:"funcType",value:"friendly"}),t.push({type:"radio",label:"Group by year",prop:"funcType",value:"yyyy"}),t.push({type:"radio",label:"Group by month",prop:"funcType",value:"MMMM"}),t.push({type:"radio",label:"Group by both",prop:"funcType",value:"yyyy-MM (MMMM)",default:!0}),t.push({type:"radio",label:"Group by date",prop:"funcType",value:"yyyy-MM-dd"});break;case"number":case"seconds":t.push({type:"radio",label:"Group by field",prop:"funcType",value:"",default:!0}),t.push({type:"radio",label:"Sum of field",prop:"funcType",value:"sum"}),t.push({type:"radio",label:"Avg of field",prop:"funcType",value:"avg"}),t.push({type:"radio",label:"Count having value",prop:"funcType",value:"count"})}e.groupOptions=t}(c),c}function j(e){var t=e.fields;return t.issuekey=e.key,t.id=e.id,F.call(this,t),function(e){if(!e.comment)return;e.comment=e.comment.comments}(t),R.call(this,t),t}function F(e){if(e.worklog)if(e.worklog=e.worklog.worklogs,e.worklog.length){this.hasWorklogs=!0;var t=this.usersObj||{};this.usersObj=t;var a,r=Object(w.a)(e.worklog);try{for(r.s();!(a=r.n()).done;){var n=a.value,o=n.author,i=n.timeSpentSeconds,s=o.accountId,l=o.emailAddress||s;t[l]||(t[l]=o),e[l]=(e[l]||0)+i,e.totalWorklog=(e.totalWorklog||0)+i}}catch(c){r.e(c)}finally{r.f()}}else delete e.worklog}function R(e){if(this.fieldWithExpr.length){var t,a=Object(w.a)(this.fieldWithExpr);try{for(a.s();!(t=a.n()).done;){var r=t.value;if("string"!==typeof r.ast)try{var n=Object(C.b)(r.ast,{this:e[r.exprField],Fields:e,parseInt:parseInt,parseFloat:parseFloat,Math:Math,Number:Number});e[r.id]=n}catch(o){e[r.id]="Error: ".concat((null===o||void 0===o?void 0:o.message)||o)}else e[r.id]=r.ast}}catch(o){a.e(o)}finally{a.f()}}}var N=function(e){Object(d.a)(a,e);var t=Object(h.a)(a);function a(e){var n;Object(s.a)(this,a);var l=e.query;return(n=t.call(this,e,(null===l||void 0===l?void 0:l.queryName)||"Custom report viewer","fa-clock-o")).toggleGroupOptions=function(){return n.setState({hideGroups:!n.state.hideGroups})},n.refreshData=function(){return n.loadData(n.props.query||n.state.query)},n.loadData=function(){var e=Object(i.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({isLoading:!0,hasError:!1}),e.prev=1,e.t0=n,e.next=5,S(t);case 5:e.t1=e.sent,e.t0.setState.call(e.t0,e.t1),e.next=12;break;case 9:e.prev=9,e.t2=e.catch(1),n.setState({isLoading:!1,hasError:!0});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),n.tableSettingsChanged=function(e){n.settings=Object(r.a)(Object(r.a)({},n.settings),e),n.isGadget?(n.saveSettings(),n.setState({settings:e})):n.props.settingsChanged(e)},Object(b.a)(Object(c.a)(n),"AnalyticsService","ReportService","JiraService","UtilsService","UserUtilsService"),n.state.isLoading=!0,n.state.hideGroups=n.isGadget,n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.initWithProps(this.props)}},{key:"renderCustomActions",value:function(e){return e?v.a.createElement(g.b,{type:"success",title:"Click to toggle group options",icon:this.state.hideGroups?"fa fa-toggle-off":"fa fa-toggle-on",onClick:this.toggleGroupOptions}):v.a.createElement(g.b,{type:"success",label:"Edit",title:"Click to edit the report",icon:"fa fa-edit",onClick:this.props.onEditClicked})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){Object(u.a)(Object(p.a)(a.prototype),"UNSAFE_componentWillReceiveProps",this).call(this,e),this.initWithProps(e)}},{key:"initWithProps",value:function(e){var t=e.query,a=e.reportId;a?this.reportId!==a&&(this.reportId=a,this.loadReportDefinition(a)):t&&this.query!==t&&(this.query=t,this.loadReportData(t))}},{key:"loadReportDefinition",value:function(){var e=Object(i.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$report.getReportDefinition(t);case 2:a=e.sent,this.title=(null===a||void 0===a?void 0:a.queryName)||"Custom report viewer",this.setState({query:a}),this.loadReportData(a);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadReportData",value:function(e){this.settings=Object(r.a)(Object(r.a)({},e.settings),this.settings),this.jql===e.jql&&this.fields===e.fields||(this.jql=e.jql,this.fields=e.fields,this.loadData(e))}},{key:"render",value:function(){var e=this.props.query,t=this.state.query,r=void 0===t?e:t,n=this.state,o=n.loading,i=n.reportData,s=n.columnList,l=n.settings,c=n.hasError,d=n.hideGroups,h=this.settings||l||{},f=h.displayColumns,g=h.groupBy,y=h.groupFoldable,b=h.sortField,k=h.isDesc;return c?Object(u.a)(Object(p.a)(a.prototype),"renderBase",this).call(this,v.a.createElement("div",{className:"error-block"},"Unable to load this report due to an error.")):o||!i?Object(u.a)(Object(p.a)(a.prototype),"renderBase",this).call(this):Object(u.a)(Object(p.a)(a.prototype),"renderBase",this).call(this,v.a.createElement(m.a,{dataset:i,hideGroups:d,exportSheetName:r.queryName,columns:s,allowSorting:!0,onChange:this.tableSettingsChanged,displayColumns:f,groupBy:g,groupFoldable:y,sortField:b,isDesc:k,noRowsMessage:"No ticket details available"}))}}]),a}(y.b);t.a=N},532:function(e,t,a){},860:function(e,t,a){"use strict";a.r(t);var r=a(56),n=a(8),o=a(0),i=a.n(o),s=a(4),l=a(5),c=a(6),u=a(46),p=a(15),d=a(16),h=a(2),f=a.n(h),v=a(9),m=a(243),g=a(37),y=a(112),b=a(296),k=a(31),w=a(33),x=a(115),C=function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){var e=this.props,t=e.isDragging,a=e.dragHandle,r=e.children,n=e.item;return"function"===typeof r?r(n,{dragHandle:a,isDragging:t}):a(r)}}]),a}(h.PureComponent);var S=Object(x.DragSource)((function(e){return e.itemType}),{beginDrag:function(e){return e}},(function(e,t){return{dragHandle:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:t.isDragging(),monitor:t}}))(C),O=function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(c.a)(a,[{key:"render",value:function(){var e=this.props,t=e.children,a=e.dropConnector;return"function"===typeof t?t({dropConnector:a}):a(t)}}]),a}(h.PureComponent);var E=Object(x.DropTarget)((function(e){return e.accepts}),{canDrop:function(e,t,a){if(!t.didDrop())return!0},drop:function(e,t,a){if(!t.didDrop()){var r=t.getItem(),n=r.index,o=r.item,i=r.onRemove;i&&i(o,n,e);var s=e.onDrop;s&&s(o,r,e)}}},(function(e,t){return{dropConnector:e.dropTarget(),isOver:t.isOver(),isOverCurrent:t.isOver({shallow:!0}),canDrop:t.canDrop(),monitor:t}}))(O),j=0,F=function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).handleRemove=function(e,t,a){if(a.containerId!==r.containerId){var n=r.props,o=n.items,i=n.onChange,s=Object(k.a)(o);s.splice(t,1),i(s)}},r.handleDrop=function(e,t,a){var n=r.props,o=n.items,i=n.onChange,s=Object(k.a)(o),l=t.containerId===r.containerId,c=a.index,u=e;if(l){var p=s.splice(t.index,1);u=Object(w.a)(p,1)[0]}c>=s.length?s.push(u):s.splice(c,0,u),i(s)},r.containerId=++j,r}return Object(c.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.items,r=t.itemTemplate,n=t.itemType,o=t.itemTypePropName,i=t.accepts,s=void 0===i?[n]:i,l=this.props,c=l.placeholder,u=l.itemPlaceholder;if(u&&(u=f.a.createElement(E,{key:"addItemPlaceholder",containerId:this.containerId,index:a.length,accepts:s,onDrop:this.handleDrop},u)),!a.length)return(c=c&&f.a.createElement(E,{key:"emptyItemPlaceholder",containerId:this.containerId,index:a.length,accepts:s,onDrop:this.handleDrop},c))||u||null;var p=a.map((function(t,a){return f.a.createElement(E,{key:a,containerId:e.containerId,index:a,accepts:s,onDrop:e.handleDrop},(function(i){return f.a.createElement(S,{index:a,containerId:e.containerId,itemType:t[o]||n,item:t,onRemove:e.handleRemove},(function(e,t){return r(e,a,t,i)}))}))}));return u?[p,u]:p}}]),a}(h.PureComponent),R=a(245),N=a(332),T=a(242),D=function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).displayFieldAdded=function(t){t&&!t.items&&e.props.onChange(t,e.jiraFields[t])},Object(v.a)(Object(u.a)(e),"JiraService","MessageService","AnalyticsService"),e.state={fields:[]},e.loadCustomFields(),e}return Object(c.a)(a,[{key:"loadCustomFields",value:function(){var e=Object(s.a)(i.a.mark((function e(){var t,a,r,n,o,s,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$jira.getCustomFields();case 2:t=e.sent,a={},this.jiraFields=a,r=[],n=[],o=Object(N.a)(t);try{for(o.s();!(s=o.n()).done;)(l=s.value).label=l.name+(l.name.toLowerCase()!==l.id.toLowerCase()?" (".concat(l.id,")"):""),l.value=l.id,a[l.id]=l,l.custom?n.push(l):r.push(l)}catch(i){o.e(i)}finally{o.f()}r=r.orderBy((function(e){return e.name})),n=n.orderBy((function(e){return e.name})),this.setState({fields:[{label:"Basic Fields",items:r},{label:"Custom Fields",items:n}]});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.fields;return f.a.createElement(T.i,{dataset:e,value:"",style:{width:"100%"},placeholder:"Choose a column to add to the list",group:!0,displayField:"name",valueField:"id",dataKey:"id",filterPlaceholder:"Type the field name to filter",onChange:this.displayFieldAdded},(function(e){return f.a.createElement("span",null,e.name)}),(function(e){return f.a.createElement("strong",null,e.label)}))}}]),a}(h.PureComponent),q=a(1);function A(e){var t=e.id,a=e.name,r=e.custom,n=e.schema,o=(n=void 0===n?{}:n).system,i=n.items,s=n.custom,l=n.type,c=void 0===l?r?"(Unsupported)":t:l,u={id:q.r.generate(),field:t,name:a,custom:r,type:c};if("issuekey"===t)return u.type="string",u;switch(c){case"comments-page":case"securitylevel":u.knownObj=!0,u.type=o;break;case"number":switch(o){case"timeoriginalestimate":case"aggregatetimespent":case"aggregatetimeoriginalestimate":case"timespent":case"timeestimate":case"aggregatetimeestimate":u.type="seconds";break;case"workratio":u.type=o;break;default:u.type=c}break;case"array":if(u.isArray=!0,e.custom)if("numeric"===i)u.type=i;else if("json"===i&&(null===s||void 0===s?void 0:s.indexOf("sprint"))>-1)u.type="sprint";else{var p=I(i,s),d=p.type,h=p.knownObj;u.type=d,u.knownObj=h}else switch(o){case"versions":case"fixVersions":case"attachment":case"components":case"issuelinks":case"subtasks":u.knownObj=!0,u.type=i||o;break;case"worklog":u.type=i||o,u.isArray=!1;break;case"labels":u.type=i||o;break;default:u.type=JSON.stringify(e)}break;default:var f=I(c,null),v=f.type,m=f.knownObj;v?(u.type=v,u.knownObj=m):(null===s||void 0===s?void 0:s.indexOf("epic-link"))>-1?u.type="epicLink":r&&(u.type=s)}return u}function I(e,t){var a={};switch(e){case"user":case"parent":case"thumbnail":case"statusCategory":case"project":case"resolution":case"issuetype":case"watches":case"priority":case"status":case"progress":case"timetracking":case"votes":a.knownObj=!0;case"string":case"date":case"datetime":case"issuerestriction":case"option":a.type=e;break;default:a.type=t}return a}var P=a(249),G=function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(){var e;Object(l.a)(this,a);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state={expression:""},e.fieldAdded=function(t,a){var r=e.props,n=r.fields;(0,r.onChange)(n.concat(A(a)))},e.removeField=function(t){var a=e.props,r=a.fields;(0,a.onChange)(r.filter((function(e,a){return a!==t})))},e.headerChanged=function(t,a){var r=e.props.fields,o=(r=Object(k.a)(r))[a];o=Object(n.a)({},o),r[a]=o,o.header=t,e.props.onChange(r)},e.editExpression=function(t){var a=e.props.fields,r=a[t],o=r.expr||"";e.setState({expression:o}),P.b.alert(f.a.createElement(f.a.Fragment,null,f.a.createElement(T.j,{className:"expr-editor",multiline:!0,placeholder:"Provide JavaScript expression (e.g. this.name or this - Fields.timespent + Fields.aggregatetimespent)",value:o,onChange:function(t){return e.setState({expression:t})}}),f.a.createElement("span",null,'Provide JavaScript expression to print a value. You can use "this" to refer to the current field and "Fields" variable to refer to the object containing all the fields.')),"Edit Expression",{width:"600px"}).then((function(){(e.state.expression||"")!==(r.expr||"")&&((r=Object(n.a)({},r)).expr=e.state.expression,r.expr||delete r.expr,(a=Object(k.a)(a))[t]=r,e.props.onChange(a))}))},e.getControls=function(t,a,r,n){return f.a.createElement(W,{key:a,dragHandle:r.dragHandle,dropConnector:n.dropConnector,field:t,index:a,onRemove:e.removeField,editExpression:e.editExpression,updateHeader:e.headerChanged})},e}return Object(c.a)(a,[{key:"render",value:function(){var e=this.props,t=e.fields,a=e.onChange;return f.a.createElement(R.c,{className:"display-fields"},f.a.createElement(R.e,null,f.a.createElement("tr",null,f.a.createElement("th",null,"#"),f.a.createElement("th",null,"Jira Field"),f.a.createElement("th",null,"Header Text"),f.a.createElement("th",null,"Type"),f.a.createElement("th",null,"Use Expr."),f.a.createElement("th",null,"Remove"))),f.a.createElement("tbody",null,f.a.createElement(F,{items:t,itemType:"field",accepts:["field"],onChange:a,itemTemplate:this.getControls})),f.a.createElement("tfoot",null,f.a.createElement("tr",null,f.a.createElement("td",{className:"data-center"},t.length+1),f.a.createElement("td",null,f.a.createElement(D,{onChange:this.fieldAdded})),f.a.createElement("td",{colSpan:"4"},"Note: Select the column from the list to add it as output"))))}}]),a}(h.PureComponent),W=function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e)).remove=function(){return r.props.onRemove(r.props.index)},r.editExpression=function(){return r.props.editExpression(r.props.index)},r.updateHeader=function(){var e,t=r.state.header;t=(null===(e=t)||void 0===e?void 0:e.trim())||void 0,r.props.updateHeader(t,r.props.index)},r.headerChanged=function(e){return r.setState({header:e})},r.state={header:e.field.header},r}return Object(c.a)(a,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState({header:e.field.header})}},{key:"render",value:function(){var e=this.props,t=e.dragHandle,a=e.dropConnector,r=e.index,n=e.field,o=e.field,i=o.name,s=o.field,l=o.type,c=o.isArray,u=o.knownObj,p=o.expr,d=this.state.header;return a(f.a.createElement("tr",null,f.a.createElement("td",{className:"data-center",ref:t},r+1),f.a.createElement("td",null,i," (",s,")"),f.a.createElement("td",null,f.a.createElement(T.j,{value:d,placeholder:i,onChange:this.headerChanged,onBlur:this.updateHeader})),(u||l)&&f.a.createElement("td",null,l," ",!!c&&"(multiple)"),!u&&!l&&f.a.createElement("td",null,JSON.stringify(n)),f.a.createElement("td",{className:"data-center"},p?f.a.createElement("span",{className:"fa fa-edit",onClick:this.editExpression,title:"Click to edit the expression"}):f.a.createElement(T.c,{checked:!1,onChange:this.editExpression,title:"Click to add an expression"})),f.a.createElement("td",{className:"data-center"},f.a.createElement("span",{className:"fa fa-times",onClick:this.remove}))))}}]),a}(h.PureComponent),M=G,L=function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(l.a)(this,a),(r=t.call(this,e,"Query Editor","fa-filter")).displayFieldChanged=function(e){return r.props.onChange(Object(n.a)(Object(n.a)({},r.props.query),{},{fields:e}))},r.jqlChanged=function(e){return r.props.onChange(Object(n.a)(Object(n.a)({},r.props.query),{},{jql:e}))},r.className="query-editor-gadget",r.isGadget=!1,r.hideMenu=!0,r.hideRefresh=!0,r}return Object(c.a)(a,[{key:"renderFooter",value:function(){var e=this.props,t=e.query,a=t.id,r=t.isSystemQuery,n=e.deleteQuery,o=e.showSaveDialog,i=e.saveAs,s=e.viewReport,l=e.allowSave,c=this.isSaveEnabled(),u=a>0;return f.a.createElement("div",{className:"pnl-footer"},a&&f.a.createElement("div",{className:"pull-left"},f.a.createElement(T.b,{icon:"fa fa-trash",label:"Delete Query",type:"danger",onClick:n}),f.a.createElement(T.b,{icon:"fa fa-floppy-o",label:"Save Query As",type:"success",disabled:!c,onClick:o})),f.a.createElement("div",{className:"pull-right"},f.a.createElement(T.b,{icon:"fa fa-floppy-o",label:"Save Query",type:"success",disabled:!c||r||!l,onClick:u?i:o}),f.a.createElement(T.b,{icon:"fa fa-list",label:"View Report",type:"info",disabled:!c,onClick:s})))}},{key:"renderCustomActions",value:function(){var e=this.props,t=e.reportsList,a=e.reportId;return t&&0!==t.length?f.a.createElement(f.a.Fragment,null,f.a.createElement(T.i,{dataset:t,value:a,valueField:"value",onChange:this.props.querySelected,placeholder:"Select a report to edit"}),f.a.createElement(T.b,{icon:"fa fa-plus",onClick:this.props.initModel,label:"New query"})):null}},{key:"isSaveEnabled",value:function(){var e,t=this.props.query,a=t.jql,r=t.fields;return(null===a||void 0===a||null===(e=a.trim())||void 0===e?void 0:e.length)>10&&(null===r||void 0===r?void 0:r.length)>=1}},{key:"render",value:function(){var e=this.props.query,t=e.fields,r=e.jql;return Object(m.a)(Object(g.a)(a.prototype),"renderBase",this).call(this,f.a.createElement("div",{className:"query-editor"},f.a.createElement(y.TabView,null,f.a.createElement(y.TabPanel,{header:"Filter (JQL)"},f.a.createElement(b.a,{jql:r,onChange:this.jqlChanged})),f.a.createElement(y.TabPanel,{header:"Display Settings"},f.a.createElement(M,{fields:t,onChange:this.displayFieldChanged})))))}}]),a}(a(244).b),H=a(297),Q=a(400),U=(a(532),function(e){Object(p.a)(a,e);var t=Object(d.a)(a);function a(e){var r;Object(l.a)(this,a),(r=t.call(this)).initModel=function(){return r.querySelected("")},r.loadReport=function(){var e=Object(s.a)(i.a.mark((function e(t){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.fillQueriesList(t);case 2:if(t){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,r.$report.getReportDefinition(t);case 6:return a=e.sent,e.next=9,r.convertFromOldReport(a);case 9:n=e.sent,r.reportConverted=a!==n,r.setState({reportId:t,query:n,renderReport:!1,hasUnsavedChanges:r.reportConverted});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.fillQueriesList=function(){var e=Object(s.a)(i.a.mark((function e(t){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.$report.getReportsList();case 2:a=e.sent,n=a.filter((function(e){return!e.advanced})).map((function(e){return{value:e.id,label:e.queryName}})),r.setState({reportId:t,reportsList:n});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.querySelected=function(e){var t=r.props.history,a=r.props.match.path;if(a.indexOf(":reportId")>=0)a=a.replace(":reportId",e).clearEnd("/");else{if(!e)return void r.setState(r.getEmptyReport());a="".concat(a,"/").concat(e)}t.push(a)},r.queryChanged=function(e){return r.setState({query:e,hasUnsavedChanges:!0})},r.deleteQuery=function(){var e=r.state,t=e.reportId,a=e.query.queryName;P.b.confirmDelete('Are you sure to delete the report named "'.concat(a,'" permanently?')).then((function(){r.$report.deleteSavedQuery(t).then((function(e){r.$message.success("Report deleted successfully!"),r.$analytics.trackEvent("Custom Report Deleted"),r.querySelected("")}))}))},r.viewReport=function(){var e=r.state.renderReport;r.setState({renderReport:!e}),e||r.$analytics.trackEvent("".concat(r.reportConverted?"Old: ":"","Custom Report Preview"),q.i.UserActions)},r.showSaveDialog=function(){return r.setState({showSaveDialog:!0})},r.saveAs=function(){return r.saveQuery(r.state.query.queryName)},r.hideSaveDialog=function(){return r.setState({showSaveDialog:!1})},r.saveQuery=function(e,t){var a=r.state.query,o=(a=Object(n.a)({},a)).queryName,i=!1;a.queryName=e,t?(delete a.id,i=!0):o!==e&&(i=!0),r.$report.saveQuery(a).then((function(e){a.id=e,r.setState({showSaveDialog:!1,hasUnsavedChanges:!1,reportId:e,query:a}),r.$message.success("Report saved successfully!"),r.reportConverted?(r.reportConverted=!1,r.$analytics.trackEvent("Custom Report migrated")):r.$analytics.trackEvent("Custom Report Saved"),i&&(r.fillQueriesList(e),t&&r.querySelected(e))}),(function(e){e&&e.message&&r.$message.error(e.message)}))},r.settingsChanged=function(e){var t=r.state.query;t=Object(n.a)(Object(n.a)({},t),{},{settings:e}),r.setState({query:t,hasUnsavedChanges:!0})},Object(v.a)(Object(u.a)(r),"ReportService","MessageService","AnalyticsService");var o=e.match.params.reportId;return o&&(o=parseInt(o)),r.state=r.getEmptyReport(o),r.loadReport(o),r}return Object(c.a)(a,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.match.params.reportId;t&&(t=parseInt(t)),this.state.reportId!==t&&this.loadReport(t)}},{key:"getEmptyReport",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{reportId:e,query:{jql:"",fields:[]}}}},{key:"convertFromOldReport",value:function(){var e=Object(s.a)(i.a.mark((function e(t){var a,o,s,l,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Array.isArray(null===t||void 0===t?void 0:t.fields)){e.next=2;break}return e.abrupt("return",t);case 2:return a=f.a.createElement(f.a.Fragment,null,"Making changes and saving the report from here will upgrade the existing report definition.",f.a.createElement("br",null),f.a.createElement("br",null),"You will not be able to use it with old report once you save changes from here.",f.a.createElement("br",null),f.a.createElement("br",null),f.a.createElement("b",null,"Note:"),' Only once you click on "Save Query" button, conversion will happen. Untill then you can safely preview the report without converting it.'),e.next=5,new Promise((function(e){return P.b.alert(a,"Convert report",null,{waitFor:5}).then(e)}));case 5:return t.filterFields,o=t.outputFields,s=Object(r.a)(t,["filterFields","outputFields"]),l=[],s.settings={groupBy:l},c={"formatSecs?1":"sum","sum?0":"sum","sum?1":"sum","avg?0":"avg","avg?1":"avg","count?0":"count","count?2":"count","formatUser?1":"name","formatUser?2":"email","formatUser?4":"both"},s.fields=o.map((function(e){var t=e.functions,a=e.groupBy,o=e.id,i=Object(r.a)(e,["functions","groupBy","id"]);i.id=q.r.generate(),i.field=o;var s=null===t||void 0===t?void 0:t.id;if(a||"sum?1"===s||"avg?1"===s||"count?2"===s){var u={showGroupCount:!0};if(s){var p=i.type,d=c[s];d&&("number"===p||"seconds"===p?u.funcType=d:"user"===p&&s.startsWith("formatUser")&&(u.valueType=d))}l.push(Object(n.a)(Object(n.a)({},i),{},{settings:u}))}return i})),e.abrupt("return",s);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.reportId,a=e.query,r=e.renderReport,n=e.reportsList,o=e.showSaveDialog,i=e.hasUnsavedChanges;return f.a.createElement("div",{className:"custom-report"},!r&&f.a.createElement(L,{reportId:t,query:a,reportsList:n,onChange:this.queryChanged,querySelected:this.querySelected,deleteQuery:this.deleteQuery,viewReport:this.viewReport,showSaveDialog:this.showSaveDialog,saveAs:this.saveAs,allowSave:i,initModel:this.initModel}),r&&f.a.createElement(Q.a,{isGadget:!1,query:a,settingsChanged:this.settingsChanged,onEditClicked:this.viewReport}),o&&f.a.createElement(H.a,{queryName:a.queryName,allowCopy:a.id>0,onHide:this.hideSaveDialog,onChange:this.saveQuery}))}}]),a}(h.PureComponent));t.default=U}}]);
//# sourceMappingURL=23.33a41140.chunk.js.map