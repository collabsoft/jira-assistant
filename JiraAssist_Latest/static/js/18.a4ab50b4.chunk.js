(this["webpackJsonpjira-assistant"]=this["webpackJsonpjira-assistant"]||[]).push([[18],{255:function(e,t,a){"use strict";var n=a(8),r=a(5),o=a(6),i=a(46),s=a(243),l=a(37),c=a(15),u=a(16),d=a(2),m=a.n(d),p=a(113),g=a(247),f=a(9),h=a(242),v=a(3),k=a.n(v),y=a(262),b=a(1),E=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;Object(r.a)(this,a),(o=t.call(this,e,"Add worklog",{width:"550px"})).searchTickets=function(e){return e=(e||"").toLowerCase(),o.allTicketList.filter((function(t){return t.label.toLowerCase().indexOf(e)>-1}))},o.saveWorklog=function(e,t,a){if(!o.validateData(e,t,o.state.ctlClass))return o.$message.warning("Please provide value for all the mandatory fields","Incomplete worklog details"),!1;o.setState({isLoading:!0}),o.$worklog.saveWorklog({ticketNo:o.getTicketNo(e),dateStarted:e.dateStarted,overrideTimeSpent:e.overrideTimeSpent,description:e.description,worklogId:e.worklogId,isUploaded:e.isUploaded,timeSpent:e.timeSpent,parentId:e.parentId,id:e.id},a).then((function(t){o.props.onDone(e.id>0?{type:y.c.WorklogModified,edited:t,previousTime:o.previousTime}:{type:y.c.WorklogModified,added:t}),o.onHide()}),(function(e){o.setState({isLoading:!1}),"string"===typeof e?o.$message.error(e):console.error(e)}))},o.setValue=function(e,t){var a=o.state.log;t?a[e]=t:delete a[e],a=Object(n.a)({},a),o.setState({log:a})},o.formatTs=function(e){return e},o.handleKeyPress=function(e){var t=e.ctrlKey,a=e.charCode;if(t&&13===a){var n=Object(i.a)(o),r=n.isLoading,s=n.state,l=s.log,c=s.vald,u=s.uploadImmediately;r||o.saveWorklog(l,c,u&&!(l.id>0))}},Object(f.a)(Object(i.a)(o),"SessionService","SuggestionService","WorklogService","MessageService","UtilsService"),o.displayDateFormat="yyyy-MM-dd HH:mm";var s=o.$session.CurrentUser,l=s.commentLength,c=s.autoUpload;o.minCommentLength=l||0;var u=e.worklog,d=e.uploadImmediately;return o.state=o.getState(u),o.state.uploadImmediately="boolean"===typeof d?d:c||!1,o.allTicketList=[],o}return Object(o.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){var e=this;this.$suggestion.getTicketSuggestion().then((function(t){e.allTicketList=t})),this.loadWorklog(this.state.log)}},{key:"loadWorklog",value:function(e){e.id&&this.fillWorklog(e,e.copy)}},{key:"getState",value:function(e){var t={showDialog:!0,vald:{},ctlClass:{},isLoading:!1,log:e};if(!e.id){t.log={ticketNo:e.ticketNo,dateStarted:k()(e.startTime||e.dateStarted||new Date).toDate(),allowOverride:e.allowOverride},e.parentId&&(t.log.parentId=e.parentId);var a=e.timeSpent;"number"===typeof a&&(a=this.$utils.formatSecs(a,!1,!0)),!e.allowOverride&&a&&(t.log.timeSpent=a),a?t.log.overrideTimeSpent=a:(t.log.overrideTimeSpent="01:00",t.log.allowOverride=!0),this.validateData(t.log,t.vald,t.ctlClass)}return t}},{key:"fillWorklog",value:function(e,t){var a=this;return this.$worklog.getWorklog(e).then((function(e){e.timeSpent&&(e.timeSpent=e.timeSpent.substring(0,5),"00:00"===e.timeSpent&&(e.timeSpent=null)),e.overrideTimeSpent&&(e.overrideTimeSpent=e.overrideTimeSpent.substring(0,5),e.allowOverride=!0),t?(a.$analytics.trackEvent("Worklog copy",b.i.UserActions,e.isUploaded?"Uploaded worklog":"Pending worklog"),delete e.id,delete e.isUploaded,delete e.worklogId,delete e.parentId,e.dateStarted=k()("".concat((new Date).format("yyyy/MM/dd")," ").concat(e.dateStarted.format("HH:mm:ss"))).toDate()):(a.previousTime=e.dateStarted,a.$analytics.trackEvent("Worklog view",b.i.UserActions,e.isUploaded?"Uploaded worklog":"Pending worklog"));var n={log:e,vald:a.state.vald,ctlClass:a.state.ctlClass};return a.validateData(n.log,n.vald,n.ctlClass),a.setState(n),e}))}},{key:"validateData",value:function(e,t,a){e.allowOverride&&(e.overrideTimeSpent=e.overrideTimeSpent||e.timeSpent||"00:00");var n=!0,r=this.getTicketNo(e);return n=(t.ticketNo=!(!r||r.length<3))&&n,n=(t.dateStarted=!(!e.dateStarted||e.dateStarted.length<16))&&n,t.overrideTimeSpent=e.allowOverride&&e.overrideTimeSpent&&e.overrideTimeSpent.length>=4,t.overrideTimeSpent=t.overrideTimeSpent&&this.$worklog.getTimeSpent(e.overrideTimeSpent)>0,n=(t.overrideTimeSpent=t.overrideTimeSpent||!e.allowOverride&&e.timeSpent&&e.timeSpent.length>=4)&&n,n=(t.description=this.minCommentLength<1||!(!e.description||e.description.length<this.minCommentLength))&&n,a.ticketNo=t.ticketNo?"is-valid":"is-invalid",a.dateStarted=t.dateStarted?"is-valid":"is-invalid",a.overrideTimeSpent=t.overrideTimeSpent?"is-valid":"is-invalid",a.description=t.description?"is-valid":"is-invalid",n}},{key:"getTicketNo",value:function(e){return e&&e.ticketNo?"string"===typeof e.ticketNo?e.ticketNo:e.ticketNo.value:null}},{key:"deleteWorklog",value:function(e){var t=this;this.setState({isLoading:!0});var a=e.ticketNo;e.ticketNo=a.value||a,this.$worklog.deleteWorklog(e).then((function(a){t.setState({isLoading:!1}),t.props.onDone({type:y.c.DeletedWorklog,removed:e.id,deleted:e.id,deletedObj:e}),t.onHide()}),(function(){e.ticketNo=a}))}},{key:"getFooter",value:function(){var e=this,t=this.isLoading,a=this.state,n=a.log,r=a.vald,o=a.uploadImmediately;return m.a.createElement(m.a.Fragment,null,!n.id&&m.a.createElement(h.c,{checked:o,className:"pull-left",label:"Upload immediately to Jira",onChange:function(t){return e.setState({uploadImmediately:t})}}),n.id>0&&m.a.createElement(h.b,{type:"danger",icon:"fa fa-trash-o",label:"Delete",className:"pull-left",disabled:t,onClick:function(){return e.deleteWorklog(n)}}),n.id>0&&!n.worklogId&&m.a.createElement(h.b,{type:"success",isLoading:t,icon:"fa fa-upload",label:"Save & Upload",className:"pull-left",disabled:t,onClick:function(){return e.saveWorklog(n,r,!0)}}),m.a.createElement(h.b,{type:"primary",icon:"fa fa-save",label:"Save",isLoading:t,disabled:t,onClick:function(){return e.saveWorklog(n,r,o&&!(n.id>0))}}),m.a.createElement(h.b,{type:"secondary",icon:"fa fa-times",label:"Cancel",onClick:this.onHide}))}},{key:"render",value:function(){var e=this,t=this.minCommentLength,n=this.state,r=n.log,o=n.vald;return Object(s.a)(Object(l.a)(a.prototype),"renderBase",this).call(this,m.a.createElement("div",{className:"pad-22",onKeyPress:this.handleKeyPress},m.a.createElement("div",{className:"row pad-b"},m.a.createElement("div",{className:"col-sm-3"},m.a.createElement("strong",null,"Log time")),m.a.createElement("div",{className:"p-col-9 col-sm-9"},m.a.createElement("div",{className:"form-group"},m.a.createElement("div",{className:"ctlClass.dateStarted"},m.a.createElement(h.e,{value:r.dateStarted,showTime:!0,onChange:function(t){return e.setValue("dateStarted",t)}})),m.a.createElement("span",{className:"help-block ".concat(o.dateStarted?"":"msg-error")},"Provide the time you had started the work")))),m.a.createElement("div",{className:"row pad-b"},m.a.createElement("div",{className:"col-sm-3"},m.a.createElement("strong",null,"Ticket no")),m.a.createElement("div",{className:"col-sm-9"},m.a.createElement(h.a,{value:r.ticketNo,displayField:"value",className:"w-p-100",placeholder:"Enter the ticket number or start typing the summary to get suggestion",dataset:this.searchTickets,disabled:r.isUploaded,maxlength:20,onChange:function(t){return e.setValue("ticketNo",t)},autoFocus:!0},(function(e){return m.a.createElement("span",{style:{fontSize:12,margin:"10px 10px 0 0"}},e.label)})),m.a.createElement("span",{className:"help-block ".concat(o.ticketNo?"":"msg-error")},"Provide the ticket no on which you had to log your work"))),m.a.createElement("div",{className:"row pad-b"},m.a.createElement("div",{className:"col-sm-3"},m.a.createElement("strong",null,"Actual time spent")),m.a.createElement("div",{className:"col-sm-2"},m.a.createElement("strong",null,this.formatTs(r.timeSpent)||"-")),m.a.createElement("div",{className:"col-sm-4"},m.a.createElement("strong",null,"Override time spent")),m.a.createElement("div",{className:"col-sm-3"},m.a.createElement("div",{className:"form-group no-margin"},m.a.createElement("div",{className:"p-inputgroup ctlClass.overrideTimeSpent"},m.a.createElement("span",{className:"p-inputgroup-addon"},m.a.createElement(h.c,{checked:r.allowOverride||!1,onChange:function(t){return e.setValue("allowOverride",t)}})),m.a.createElement(p.InputMask,{mask:"99:99",className:"w-80",value:r.overrideTimeSpent||"",placeholder:"00:00",maxlength:5,disabled:!r.allowOverride,onChange:function(t){return e.setValue("overrideTimeSpent",t.value)}})))),m.a.createElement("div",{className:"col-sm-3"}),m.a.createElement("div",{className:"col-sm-9 no-t-padding"},m.a.createElement("span",{className:"help-block ".concat(o.overrideTimeSpent?"":"msg-error")},"Provide the time spent on this task (override to change existing)"))),m.a.createElement("div",{className:"row"},m.a.createElement("div",{className:"col-sm-3"},m.a.createElement("strong",null,"Comments")),m.a.createElement("div",{className:"col-sm-9"},m.a.createElement(h.j,{multiline:!0,rows:5,value:r.description||"",className:"form-control ".concat(o.description?"":"ctl-error"),onChange:function(t){return e.setValue("description",t)},placeholder:"Provide a brief info about the task you had done.".concat(t?" Should be atleast ".concat(t," chars is length."):"")})))))}}]),a}(g.a);t.a=E},262:function(e,t,a){"use strict";a.d(t,"c",(function(){return n.a})),a.d(t,"a",(function(){return R})),a.d(t,"b",(function(){return Z})),a.d(t,"k",(function(){return ce})),a.d(t,"e",(function(){return me})),a.d(t,"f",(function(){return fe})),a.d(t,"g",(function(){return ke})),a.d(t,"h",(function(){return be})),a.d(t,"j",(function(){return Ee})),a.d(t,"i",(function(){return _})),a.d(t,"d",(function(){return we}));var n=a(47),r=a(31),o=a(0),i=a.n(o),s=a(4),l=a(8),c=a(5),u=a(6),d=a(46),m=a(15),p=a(16),g=a(243),f=a(37),h=a(2),v=a.n(h),k=a(22),y=a.n(k),b=a(244),E=a(9),w=a(316),S=a(294),C=a(317),N=a(318),j=a(3),T=a.n(j),O=a(259),D=a(283),W=a(32),x=a(255),U=a(295),A=a(10),L=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={},e.toggleShowAttendees=function(){return e.setState({showAttendees:!e.state.showAttendees})},e.toggleShowDesc=function(){return e.setState({showFullDesc:!e.state.showFullDesc})},e}return Object(u.a)(a,[{key:"render",value:function(){var e=this.props,t=e.cut,a=e.eventDetails,n=this.state,r=n.showAttendees,o=n.showFullDesc;return a?v.a.createElement("div",{className:"event-details"},v.a.createElement("div",{className:"header"},v.a.createElement("div",{className:"controls"}),v.a.createElement("div",{className:"title"},t(a.summary,75))),v.a.createElement("div",{className:"body"},v.a.createElement("div",{className:"detail"},v.a.createElement("div",{className:"title"},v.a.createElement("i",{className:"fa fa-clock-o"})),v.a.createElement("div",{className:"info"},v.a.createElement("span",null,a.date),v.a.createElement("span",{className:"info"},a.startTime," - ",a.endTime," ",a.remaining))),a.location&&v.a.createElement("div",{className:"detail"},v.a.createElement("div",{className:"title"},v.a.createElement("i",{className:"fa fa-map-marker"})),v.a.createElement("div",{className:"info"},a.location)),a.videoCall&&v.a.createElement("div",{className:"detail"},v.a.createElement("div",{className:"title"},v.a.createElement("i",{className:"fa fa-video-camera"})),v.a.createElement("div",{className:"info"},v.a.createElement("a",{href:a.videoCall.url,target:"_blank",rel:"noopener noreferrer"},"Join meeting: ",a.videoCall.name))),a.attendees&&v.a.createElement("div",{className:"detail pointer"},v.a.createElement("div",{className:"title"},v.a.createElement("i",{className:"fa fa-users"})),v.a.createElement("div",{className:"info",onClick:this.toggleShowAttendees},v.a.createElement("div",{className:"icon pull-right"},v.a.createElement("i",{className:"fa ".concat(r?"fa-angle-up":"fa-angle-down")})),v.a.createElement("div",null,v.a.createElement("span",null,a.attendees.total," guests"),a.attendees&&v.a.createElement("span",{className:"info"},a.attendees.yes&&v.a.createElement("font",null,a.attendees.yes," yes,"),a.attendees.no&&v.a.createElement("font",null,a.attendees.no," no,"),a.attendees.tentative&&v.a.createElement("font",null," ",a.attendees.tentative," tentative,"),a.attendees.awaiting&&v.a.createElement("font",null," ",a.attendees.awaiting," awaiting")))),r&&a.attendees&&v.a.createElement("div",{className:"attendees"},a.attendees.list.map((function(e,t){return v.a.createElement("div",{key:t,className:"attendee"},e.displayName&&v.a.createElement("span",{className:"name"}," ",e.displayName),e.email&&v.a.createElement("span",{className:"email"}," (",e.email,")"))})))),a.description&&v.a.createElement("div",{className:"detail"},v.a.createElement("div",{className:"title"},v.a.createElement("i",{className:"fa fa-align-justify"})),v.a.createElement("div",{className:"info"},Object(A.f)(o?a.description:t(a.description,350))),a.description.length>350&&v.a.createElement("div",{style:{textAlign:"center"}},v.a.createElement("span",{className:"link",onClick:this.toggleShowDesc},o?"show less":"show all"))))):null}}]),a}(h.PureComponent),I=a(247),M=a(242),P=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e,"Calendar configurations")).setValue=function(e,t){var a=n.state.settings;a=Object(l.a)({},a),e?a[t]=e:delete a[t],n.setState({settings:a})},n.onDone=function(){n.props.onDone(n.state.settings),n.onHide()},n.state={showDialog:!0,settings:Object(l.a)({},e.settings)},n.style={width:"667px"},n}return Object(u.a)(a,[{key:"getFooter",value:function(){return v.a.createElement(v.a.Fragment,null,v.a.createElement(M.b,{type:"default",icon:"fa fa-times",label:"Cancel",onClick:this.onHide}),v.a.createElement(M.b,{type:"success",icon:"fa fa-floppy-o",label:"Done",onClick:this.onDone}))}},{key:"render",value:function(){var e=this,t=this.state.settings;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement("div",{className:"pad-22"},v.a.createElement("h3",{className:"control-sidebar-heading"},"Item Colors"),v.a.createElement("div",{className:"form-group row"},v.a.createElement("label",{className:"col-md-3 col-form-label"},"Meeting entry color"),v.a.createElement("div",{className:"col-md-9 col-form-label"},v.a.createElement(M.d,{value:t.eventColor,fieldName:"eventColor",onChange:this.setValue}),v.a.createElement("label",{className:"form-check-label"},"Specify the color of the entry for meeting"))),v.a.createElement("div",{className:"form-group row"},v.a.createElement("label",{className:"col-md-3 col-form-label"},"Worklog entry color"),v.a.createElement("div",{className:"col-md-9 col-form-label"},v.a.createElement(M.d,{value:t.worklogColor,fieldName:"worklogColor",onChange:this.setValue}),v.a.createElement("label",{className:"form-check-label"},"Specify the color of the worklog entry"))),v.a.createElement("div",{className:"form-group row"},v.a.createElement("label",{className:"col-md-3 col-form-label"},"Info color (Valid)"),v.a.createElement("div",{className:"col-md-9 col-form-label"},v.a.createElement(M.d,{value:t.infoColor_valid,fieldName:"infoColor_valid",onChange:this.setValue}),v.a.createElement("label",{className:"form-check-label"},"Specify the color of the info entry when the total hours logged is equal to the max hours to log setting"))),v.a.createElement("div",{className:"form-group row"},v.a.createElement("label",{className:"col-md-3 col-form-label"},"Info color (Less)"),v.a.createElement("div",{className:"col-md-9 col-form-label"},v.a.createElement(M.d,{value:t.infoColor_less,fieldName:"infoColor_less",onChange:this.setValue}),v.a.createElement("label",{className:"form-check-label"},"Specify the color of the info entry when the total hours logged is lesser than the max hours to log"))),v.a.createElement("div",{className:"form-group row"},v.a.createElement("label",{className:"col-md-3 col-form-label"},"Info color (High)"),v.a.createElement("div",{className:"col-md-9 col-form-label"},v.a.createElement(M.d,{value:t.infoColor_high,fieldName:"infoColor_high",onChange:this.setValue}),v.a.createElement("label",{className:"form-check-label"},"Specify the color of the info entry when the total hours logged is higher than the max hours to log"))),v.a.createElement("h3",{className:"control-sidebar-heading"},"Show / Hide Entries"),v.a.createElement("div",{className:"form-group"},v.a.createElement(M.c,{checked:t.showMeetings||!1,onChange:function(t){return e.setValue(t,"showMeetings")},label:"Display entry for meetings integrated from calendar"})),v.a.createElement("div",{className:"form-group"},v.a.createElement(M.c,{checked:t.showWorklogs||!1,onChange:function(t){return e.setValue(t,"showWorklogs")},label:"Display worklog added by you"})),v.a.createElement("div",{className:"form-group"},v.a.createElement(M.c,{checked:t.showInfo||!1,onChange:function(t){return e.setValue(t,"showInfo")},label:"Display information about total hours logged on daily basis"}))))}}]),a}(I.a),$=a(1),F=(a(272),[{value:"dayGridMonth",label:"Month"},{value:"timeGridWeek",label:"Week"},{value:"timeGridDay",label:"Day"}]),R=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n,r;return Object(c.a)(this,a),(r=t.call(this,e,"Calendar","fa-calendar")).refreshData=function(){r.fillEvents(r.startDate,r.endDate)},r.viewModeChanged=function(e){r.setState({viewMode:e}),r.fc.calendar.changeView(e),r.saveSettings(Object(l.a)(Object(l.a)({},r.state.settings),{},{viewMode:e}),!0)},r.hideWorklogDialog=function(){return r.setState({showAddWorklogPopup:!1})},r.toggleSettingsDialog=function(){return r.setState({showSettingsPopup:!r.state.showSettingsPopup})},r.addEvent=function(e){if(0!==e.type){var t=!1,a=Object(d.a)(r).events;if(e.removed){var n=e.removed+(e.deletedObj.worklogId?"#".concat(e.deletedObj.worklogId):"");e=a.first((function(e){return e.id===n&&1===e.entryType})),a.remove(e),r.latestData.remove((function(t){return t.id===e.id&&1===t.entryType}))}else if(e.added||e.edited){var o=e.previousTime;(e=e.added||e.edited).backgroundColor=r.state.settings.worklogColor,e.borderColor=e.backgroundColor,a.removeAll((function(t){return t.id===e.id&&1===t.entryType})),a.push(e),r.latestData.removeAll((function(t){return t.id===e.id&&1===t.entryType})),r.latestData.push(e),t=!0,o&&r.updateAllDayEvent({start:o})}return r.updateAllDayEvent(e),r.setEventsData(a),t}},r.hideOPEvent=function(){return r.setState({showOpEvent:!1})},r.saveSettings=function(e,t){if(r.isGadget)return Object(g.a)((n=Object(d.a)(r),Object(f.a)(a.prototype)),"saveSettings",n).call(n),void(!0!==t&&r.refreshData());r.$session.pageSettings.calendar=e,r.setState({settings:e},!0!==t?r.refreshData:null),r.$config.saveSettings("calendar",e)},Object(E.a)(Object(d.a)(r),"SessionService","WorklogService","MessageService","AnalyticsService","OutlookService","CalendarService","UtilsService","UserUtilsService","ConfigService","TicketService"),r.hideMenu=!e.isGadget,r.hideExport=!0,e.isGadget&&(r.className="calendar-view"),r.$session.pageSettings.calendar?r.state.settings=Object.assign({showMeetings:!0,showWorklogs:!0,showInfo:!0},r.$session.pageSettings.calendar):r.state.settings={viewMode:"timeGridWeek",showMeetings:!0,showWorklogs:!0,showInfo:!0},r.setMenuItems(),r.CurrentUser=r.$session.CurrentUser,r.maxTime=r.CurrentUser.maxHours,r.maxTime&&(r.maxTime=60*r.maxTime*60),r.fullCalendarOpts=r.getCalendarOptions(),r}return Object(u.a)(a,[{key:"setMenuItems",value:function(){var e=Object(s.a)(i.a.mark((function e(){var t,a,n,r=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.mnuWL_Upload={label:"Upload worklog",icon:"fa fa-upload",command:function(){return r.uploadWorklog()}},this.contextMenuItems=[{label:"Edit worklog",icon:"fa fa-edit",command:function(){return r.showWorklogPopup(r.currentWLItem)}},{label:"Open ticket",icon:"fa fa-external-link",command:function(){return r.openTicket(r.currentWLItem)}},{label:"Copy worklog",icon:"fa fa-copy",command:function(){return r.copyWorklog()}},this.mnuWL_Upload,{label:"Delete worklog",icon:"fa fa-times",command:function(){return r.deleteWorklog()}}],t=(this.$session.CurrentUser.meetingTicket||"").trim().split(",").select((function(e){return e||null})),e.next=5,this.$ticket.getTicketDetails(t);case 5:a=e.sent,n=[],t.length>0&&(t.forEach((function(e){var t=(a[e.toUpperCase()]||{}).fields,o=(t=void 0===t?{}:t).summary,i=void 0===o?"":o;n.push({label:i?"".concat(e,": ").concat(r.$utils.cut(i,65,!0)):e,icon:"fa fa-ticket",command:function(t){return r.createWorklog(t.originalEvent,r.currentMeetingItem,e)}})})),1===t.length&&(this.defaultMeetingTicket=t[0])),n.length>0&&n.push({separator:!0}),n.push({label:"Choose ticket",icon:"fa fa-pencil-square-o",command:function(e){return r.createWorklog(e.originalEvent,r.currentMeetingItem,"")}}),this.mnuCal_AddWL={label:"Add worklog to",icon:"fa fa-clock-o",items:n,command:function(e){return r.createWorklog(e.originalEvent,r.currentMeetingItem,"")}},this.mnuCal_OpenUrl={label:"Open video call",icon:"fa fa-video-camera",command:function(){return r.openVideoCall(r.currentMeetingItem)}},this.calMenuItems=[this.mnuCal_AddWL,{label:"Show details",icon:"fa fa-info-circle",command:function(e){return r.showCalendarDetails({extendedProps:{sourceObject:r.currentMeetingItem}},e.originalEvent,null)}},this.mnuCal_OpenUrl];case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCalendarOptions",value:function(){var e=this.CurrentUser,t=e.startOfWeek,a=e.startOfDay,n=e.endOfDay,r=e.workingDays,o=e.timeFormat,i=this.props.viewMode;this.isGadget||("agendaWeek"===(i=this.state.settings.viewMode)?i="timeGridWeek":"month"===i?i="dayGridMonth":"agendaDay"===i&&(i="timeGridDay"));var s=t;s&&s>0?s-=1:s=null;var l=(o||"").indexOf("tt")>-1,c=!!l&&"short";return{plugins:[S.d,C.a,N.a],timezone:"local",selectHelper:!0,displayEventTime:!0,selectable:!0,firstDay:s,height:"parent",fixedWeekCount:!1,eventLimit:!0,editable:!0,droppable:!0,slotDuration:"00:15:00",minTime:a||"10:00",maxTime:n||"19:00",allDayText:"total",header:!1,nowIndicator:!0,navLinks:!0,defaultView:i,businessHours:{dow:r||[1,2,3,4,5],start:a||"10:00",end:n||"19:00"},slotLabelFormat:{hour:"numeric",minute:"2-digit",omitZeroMinute:l,meridiem:c,hour12:l},eventTimeFormat:{hour:"numeric",minute:"2-digit",omitZeroMinute:l,meridiem:c,hour12:l},select:this.select.bind(this),eventRender:this.eventRender.bind(this),datesRender:this.viewRender.bind(this),eventDrop:this.eventDrop.bind(this),eventResize:this.eventResize.bind(this),eventClick:this.eventClick.bind(this)}}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.viewMode&&this.setState({settings:Object(l.a)(Object(l.a)({},this.state.settings),{},{viewMode:e.viewMode})}),Object(g.a)(Object(f.a)(a.prototype),"UNSAFE_componentWillReceiveProps",this).call(this,e)}},{key:"createWorklog",value:function(e,t,a){var n=this;if(Object(W.hideContextMenu)(),t.start.dateTime){e.stopPropagation(),e.preventDefault();var r=j.duration(j(t.end.dateTime).diff(t.start.dateTime)),o={dateStarted:t.start.dateTime,timeSpent:"".concat(r.hours().pad(2),":").concat(r.minutes().pad(2)),description:t.summary,parentId:t.id};return a?(o.ticketNo=a,this.$worklog.saveWorklog(o).then((function(t){n.addEvent({added:t}),y()(e.currentTarget).remove()}),(function(e){"string"===typeof e?n.$message.error(e):console.error(e)})),this.$analytics.trackEvent("Quick add WL",$.i.UserActions)):this.showWorklogPopup(o),!1}}},{key:"fillEvents",value:function(e,t){var a=this;e=j(e).startOf("day"),t=j(t).endOf("day");var n=[this.$worklog.getWorklogsEntry(e,t)];this.CurrentUser.gIntegration&&this.CurrentUser.hasGoogleCreds&&this.state.settings.showMeetings&&n.push(this.$calendar.getEvents(e,t).then(null,(function(e){var t="Unable to fetch Google meetings!";return e.error&&e.error.message&&(t+="<br /><br />Reason:- ".concat(e.error.message)),a.$message.warning(t),[]}))),this.CurrentUser.oIntegration&&this.CurrentUser.hasOutlookCreds&&this.state.settings.showMeetings&&n.push(this.$outlook.getEvents(e,t).then(null,(function(e){var t="Unable to fetch Outlook meetings!";return e.error&&e.error.message&&(t+="<br /><br />Reason:- ".concat(e.error.message)),a.$message.warning(t),[]}))),this.setState({isLoading:!0,uploading:!1}),Promise.all(n).then((function(e){a.setState({isLoading:!1});var t=e[0],n=t.filter((function(e){return 1===e.entryType})).groupBy((function(e){return j(e.start).format("YYYY-MM-DD")})).map((function(e){return a.getAllDayObj(e)}));a.latestData=t,function(e){var t=[],n=a.state.settings;switch(n.showMeetings&&t.push(2),n.showWorklogs&&t.push(1),n.showInfo&&t.push(3),t.length){case 0:e=[];break;case 3:break;default:e=e.filter((function(e){return t.indexOf(e.entryType)>-1}))}a.setColors(e),a.setEventsData(e)}(t.addRange(n).addRange(e[1]))}),(function(e){return a.setState({isLoading:!1}),Promise.reject(e)}))}},{key:"setLoggedTime",value:function(e,t){var a=this.getTimeSpent(e);t.logged=a;var n="Logged: ".concat(this.$utils.formatSecs(a));return t.diff=a-this.maxTime,this.maxTime&&t.diff&&(n+=" (".concat(t.diff>0?"+":"-").concat(this.$utils.formatSecs(Math.abs(t.diff)),")")),this.setInfoColor(t,this.state.settings),t.title=n,t}},{key:"setInfoColor",value:function(e,t){this.maxTime&&e.diff?e.backgroundColor=e.diff>0?t.infoColor_high:t.infoColor_less:e.backgroundColor=t.infoColor_valid,e.borderColor=e.backgroundColor}},{key:"getTimeSpent",value:function(e){return e.sum((function(e){var t=j(e.start),a=j(e.end);return j.duration(a.diff(t)).asSeconds()}))}},{key:"updateAllDayEvent",value:function(e){var t=j(e.start).format("YYYY-MM-DD"),a=this.events;a.removeAll((function(e){return e.id===t&&3===e.entryType}));var r=a.filter((function(e){return 1===e.entryType&&j(e.start).format("YYYY-MM-DD")===t}));if(r&&r.length>0){var o=this.getAllDayObj({key:t,values:r});o.logged&&(a.push(o),this.setLoggedTime(r,o))}this.setEventsData(a),this.performAction(n.a.WorklogModified)}},{key:"openTicket",value:function(e){var t=this.$userutils.getTicketUrl(e.ticketNo);window.open(t)}},{key:"showWorklogPopup",value:function(e){Object(W.hideContextMenu)();var t,a={showAddWorklogPopup:!0};if(e.copy)return a.worklogItem=e.copy,void this.setState(a);if(e.id||e.parentId)t=e;else{var n=j.duration(e.end.diff(e.start));t={timeSpent:"".concat(n.hours().pad(2),":").concat(n.minutes().pad(2)),allowOverride:!0},e.dateStarted?t.startTime=e.dateStarted:t.startTime=e.isMonthMode?j("".concat(e.start.format("YYYY-MM-DD")," ").concat(this.CurrentUser.startOfDay),"YYYY-MM-DD HH:mm").toDate():e.start.toDate()}a.worklogItem=t,this.setState(a)}},{key:"setEventsData",value:function(e){this.events=Object(r.a)(e),this.setState({isLoading:!1,events:Object(r.a)(e),pendingWorklogCount:this.getPendingWorklogs(e).length})}},{key:"getAllDayObj",value:function(e){return this.setLoggedTime(e.values,{id:e.key,entryType:3,start:e.key,allDay:!0,editable:!1})}},{key:"setColors",value:function(e){var t=this,a=this.state.settings,n=a.worklogColor,r=a.eventColor;e.forEach((function(e){switch(e.entryType){case 1:e.backgroundColor=n,e.borderColor=n;break;case 2:e.backgroundColor=r,e.borderColor=r;break;case 3:t.setInfoColor(e,a)}}))}},{key:"select",value:function(e){var t=e.start,a=e.end,n=e.allDay,r="dayGridMonth"===this.state.settings.viewMode&&!this.isGadget;return!r&&n||(this.$analytics.trackEvent("Worklog drag",$.i.UserActions),this.showWorklogPopup({isMonthMode:r,start:j(t),end:j(a)})),!1}},{key:"showCalendarDetails",value:function(e,t,a){Object(W.hideContextMenu)(),t.preventDefault(),t.stopPropagation();var n=e.extendedProps.sourceObject;if(this.$analytics.trackEvent("View event details",$.i.UserActions,e.extendedProps.source),"goolge"===e.extendedProps.source)this.currentMeetingItem=this.getGoogleEventView(n);else if("outlook"===e.extendedProps.source)return void(this.currentMeetingItem=this.getOutlookEventView(n));if(this.$session.isQuickView){var r=y()(".app-header.navbar > button[appmobilesidebartoggler]").get(0);r&&(t={currentTarget:r})}else this.currentMeetingViewItem&&(t={currentTarget:this.currentMeetingViewItem});this.opEvent.show(t),this.setState({showOpEvent:!0})}},{key:"getGoogleEventView",value:function(e){var t={summary:e.summary,htmlLink:e.htmlLink,location:e.location,description:e.description,descrLimit:350,creator:e.creator,organizer:e.organizer};if(e.start){t.date=this.$userutils.formatDate(e.start.dateTime),t.startTime=this.$userutils.formatTime(e.start.dateTime);var a=j(e.start.dateTime).diff(j());a=a<0?e.end&&e.end.dateTime&&j().diff(e.end.dateTime)<0?"(now ongoing)":"":"(in ".concat(this.$utils.formatTs(a),")"),t.remaining=a}if(e.end&&e.end.dateTime&&(t.endTime=this.$userutils.formatTime(e.end.dateTime)),e.attendees&&(t.attendees={total:e.attendees.length,yes:e.attendees.count((function(e){return"accepted"===e.responseStatus})),no:e.attendees.count((function(e){return"notAccepted"===e.responseStatus})),awaiting:e.attendees.count((function(e){return"needsAction"===e.responseStatus})),tentative:e.attendees.count((function(e){return"tentative"===e.responseStatus})),list:e.attendees}),e.hangoutLink){var n=e.hangoutLink;n.lastIndexOf("/")>0&&(n=n.substring(n.lastIndexOf("/")+1)),t.videoCall={url:e.hangoutLink,name:n}}return t}},{key:"getOutlookEventView",value:function(e){var t={summary:e.subject,htmlLink:e.webLink,location:(e.location||{}).displayName,description:e.bodyPreview,descrLimit:350,creator:e.creator,organizer:((e.organizer||{}).emailAddress||{}).name};if(e.start){t.date=this.$userutils.formatDate(e.start.dateTime),t.startTime=this.$userutils.formatTime(e.start.dateTime);var a=j(e.start.dateTime).diff(j());a=a<0?e.end&&e.end.dateTime&&j().diff(e.end.dateTime)<0?"(now ongoing)":"":"(in ".concat(this.$utils.formatTs(a),")"),t.remaining=a}if(e.end&&e.end.dateTime&&(t.endTime=this.$userutils.formatTime(e.end.dateTime)),e.attendees&&(t.attendees={total:e.attendees.length,yes:e.attendees.count((function(e){return"accepted"===(e.status||{}).response})),no:e.attendees.count((function(e){return"notAccepted"===(e.status||{}).response})),awaiting:e.attendees.count((function(e){return"needsAction"===(e.status||{}).response})),tentative:e.attendees.count((function(e){return"tentative"===(e.status||{}).response})),list:e.attendees.map((function(e){var t=e.emailAddress;return{email:t.address,displayName:t.name}}))}),e.onlineMeetingUrl){var n=e.onlineMeetingUrl;n.lastIndexOf("/")>0&&(n=n.substring(n.lastIndexOf("/")+1)),t.videoCall={url:e.onlineMeetingUrl,name:n}}return t}},{key:"openVideoCall",value:function(e){Object(W.hideContextMenu)(),e&&e.hangoutLink&&window.open(e.hangoutLink)}},{key:"eventClick",value:function(e){var t=e.event,a=e.jsEvent,n=e.view;return this.currentMeetingViewItem=null,1===t.extendedProps.entryType?this.showWorklogPopup(t.extendedProps.sourceObject):2===t.extendedProps.entryType&&this.showCalendarDetails(t,a,n),!1}},{key:"viewRender",value:function(e){var t=e.view;this.startDate=t.activeStart,this.endDate=t.activeEnd,this.title="Calendar - [".concat(t.title.replace(/[^a-zA-Z0-9, ]+/g,"-"),"]"),this.saveSettings(Object(l.a)(Object(l.a)({},this.state.settings),{},{viewMode:t.type}))}},{key:"eventDrop",value:function(e){var t=this,a=e.event,n=e.revert,r=e.jsEvent;if(r.ctrlKey||r.altKey){n();var o=this.events.first((function(e){return 1===e.entryType&&e.id===a.id}));if(o){var i=o.sourceObject;o.start=j(new Date(i.dateStarted)).toDate(),o.end=j(new Date(i.dateStarted)).add(this.$worklog.getTimeSpent(i),"minutes").toDate()}this.$worklog.copyWorklog(a.extendedProps.sourceObject,a.start).then((function(e){t.addEvent({added:e}),t.$analytics.trackEvent("Worklog quick copied",$.i.UserActions,a.extendedProps.sourceObject.isUploaded?"Uploaded worklog":"Pending worklog")}))}else{var s=a.extendedProps.sourceObject.dateStarted;this.$worklog.changeWorklogDate(a.extendedProps.sourceObject,a.start).then((function(e){t.$analytics.trackEvent("Worklog moved",$.i.UserActions,a.extendedProps.sourceObject.isUploaded?"Uploaded worklog":"Pending worklog"),t.addEvent({previousTime:s,edited:e})}))}}},{key:"eventResize",value:function(e){var t=this,a=e.event;this.$worklog.changeWorklogTS(a.extendedProps.sourceObject,this.getEventDuration(a)).then((function(e){t.addEvent({edited:e}),t.$analytics.trackEvent("Worklog resized",$.i.UserActions,a.extendedProps.sourceObject.isUploaded?"Uploaded worklog":"Pending worklog")}))}},{key:"getEventDuration",value:function(e){if(e.end&&e.start){var t=j.duration(j(e.end).diff(e.start));return"".concat(t.hours().pad(2),":").concat(t.minutes().pad(2))}if(e.extendedProps.sourceObject){var a=e.extendedProps.sourceObject,n=a.overrideTimeSpent||a.timespent;if(n&&~n.indexOf(":"))return n}return"00:00"}},{key:"eventRender",value:function(e){var t=this,a=e.event,n=e.el,r=y()(n),o=" (".concat(this.$utils.formatTs(this.getEventDuration(a)),")"),i=a.extendedProps.sourceObject;if(i){var s="".concat(r.find(".fc-time").text()+o,"\n").concat(a.title);r.attr("title",s)}r.find(".fc-time").append('<span class="fc-hour">'.concat(o,"</span>"));var l=a.extendedProps.entryType;if(1===l){var c=i,u=function(e){e.stopPropagation(),e.preventDefault(),t.mnuWL_Upload.disabled=c.isUploaded,t.currentWLItem=c,Object(W.showContextMenu)(e,t.contextMenuItems)},d=y()('<i class="fa fa-ellipsis-v pull-left" title="Show options"></i>').on("click",u);r.find(".fc-time").prepend(d),r.bind("contextmenu",u)}else if(2===l){var m=null,p=i,g=this.latestData.some((function(e){return e.parentId===a.id&&1===e.entryType})),f=function(e){e.stopPropagation(),e.preventDefault(),e.currentTarget=m.get(0),t.currentMeetingItem=p,t.currentMeetingViewItem=h.find("i.fa").get(0),t.mnuCal_AddWL.disabled=g,t.mnuCal_OpenUrl.disabled=!p.hangoutLink,Object(W.showContextMenu)(e,t.calMenuItems)};m=g?y()('<i class="fa fa-ellipsis-v pull-left" title="Show options"></i>').on("click",f):y()('<i class="fa fa-clock-o pull-left" title="Create worklog for this meeting"></i>').on("click",(function(e){e.stopPropagation(),t.createWorklog(e,p,t.defaultMeetingTicket)}));var h=r.find(".fc-time");h.prepend(m),r.bind("contextmenu",f)}}},{key:"uploadWorklog",value:function(e){var t=this;if(this.setState({uploading:!0}),Object(W.hideContextMenu)(),e){var a=this.getPendingWorklogs().map((function(e){return e.sourceObject.id}));this.$worklog.uploadWorklogs(a).then((function(){t.$message.success("".concat(a.length," worklog(s) uploaded successfully!")),t.$analytics.trackEvent("Worklog uploaded: All",$.i.UserActions),t.refreshData()}),(function(){t.refreshData()}))}else this.$worklog.uploadWorklogs([this.currentWLItem.id],!0).then((function(e){t.setState({uploading:!1}),t.$message.success("Worklog uploaded successfully!"),t.events.removeAll((function(e){return 1===e.entryType&&e.id.toString()===t.currentWLItem.id.toString()})),t.addEvent({added:t.$worklog.getWLCalendarEntry(e[0])}),t.$analytics.trackEvent("Worklog uploaded: Individual",$.i.UserActions)}),(function(){return t.setState({uploading:!1})}))}},{key:"deleteWorklog",value:function(){var e=this;Object(W.hideContextMenu)(),this.$worklog.deleteWorklog(this.currentWLItem).then((function(){e.$analytics.trackEvent("Worklog deleted",$.i.UserActions,e.currentWLItem.isUploaded?"Uploaded worklog":"Pending worklog"),e.addEvent({removed:e.currentWLItem.id,deletedObj:e.currentWLItem})}))}},{key:"copyWorklog",value:function(){Object(W.hideContextMenu)();var e=Object.create(this.currentWLItem);e.copy=!0,this.showWorklogPopup({copy:e})}},{key:"getPendingWorklogs",value:function(e){return e||(e=this.events),e.filter((function(e){return 1===e.entryType&&!e.sourceObject.isUploaded}))}},{key:"executeEvent",value:function(e){e.type===n.a.AddWorklog||e.type===n.a.DeletedWorklog||e.type===n.a.WorklogModified?this.refreshData():Object(g.a)(Object(f.a)(a.prototype),"executeEvent",this).call(this,e)}},{key:"renderCustomActions",value:function(){var e=this,t=this.isGadget,a=this.state,n=a.pendingWorklogCount,r=a.isLoading,o=a.uploading;return v.a.createElement(v.a.Fragment,null,!this.isGadget&&v.a.createElement(v.a.Fragment,null,v.a.createElement(O.a,{icon:"fa fa-arrow-left",onClick:function(){return e.calendar.prev()}}),v.a.createElement(O.a,{icon:"fa fa-arrow-right",onClick:function(){return e.calendar.next()}}),v.a.createElement(D.a,{dataset:F,value:this.state.settings.viewMode,valueField:"value",displayField:"label",placeholder:"Select a view mode",onChange:this.viewModeChanged})),v.a.createElement("span",{className:"info-badge",title:n?"Upload ".concat(n," pending worklog(s)"):"No worklog pending to be uploaded"},n>0&&v.a.createElement("span",{className:"info btn-warning"},n),v.a.createElement(O.a,{type:"success",icon:o?"fa fa-spin fa-spinner":"fa fa-upload",disabled:o||n<1||r,onClick:function(){return e.uploadWorklog(!0)}})),!t&&v.a.createElement(O.a,{icon:"fa fa-refresh",disabled:r||o,onClick:this.refreshData,title:"Refresh meetings and worklogs"}),!t&&v.a.createElement(O.a,{icon:"fa fa-cogs",onClick:this.toggleSettingsDialog,title:"Show settings"}))}},{key:"render",value:function(){var e=this,t=this.hideWorklogDialog,n=this.addEvent,r=this.state,o=r.showAddWorklogPopup,i=r.showSettingsPopup,s=r.worklogItem,l=r.events,c=r.showOpEvent;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement(v.a.Fragment,null,v.a.createElement(w.FullCalendar,{ref:function(t){t&&(e.fc=t,e.calendar=t.calendar)},events:l,options:this.fullCalendarOpts}),o&&v.a.createElement(x.a,{worklog:s,onDone:n,onHide:t}),i&&v.a.createElement(P,{settings:this.state.settings,onDone:this.saveSettings,onHide:this.toggleSettingsDialog}),v.a.createElement(U.OverlayPanel,{className:"op-event-details",ref:function(t){e.opEvent=t},showCloseIcon:!0,dismissable:!0,appendTo:document.body,onHide:this.hideOPEvent},c&&this.currentMeetingItem&&v.a.createElement(L,{eventDetails:this.currentMeetingItem,cut:this.$utils.cut}))))}}]),a}(b.b),B=a(264),G=a(253),V=(a(273),function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;Object(c.a)(this,a),n=t.call(this,e),Object(E.a)(Object(d.a)(n),"JiraService","SessionService");var r=n.$session.CurrentUser,o=r.epicNameField,i=r.storyPointField;n.epicNameField=null===o||void 0===o?void 0:o.id,n.storyPointField=null===i||void 0===i?void 0:i.id;var s=["key","summary","project","status","parent","assignee","issuetype","reporter","created","changeLog","timeestimate","aggregatetimeestimate","timeoriginalestimate","aggregatetimeoriginalestimate"];return n.epicNameField&&s.push(n.epicNameField),n.storyPointField&&s.push(n.storyPointField),n.fieldNames=s,n.state={},n}return Object(u.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){this.fetchData()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.jql;this.jql!==(null===t||void 0===t?void 0:t.trim())&&this.fetchData()}},{key:"fetchData",value:function(){var e=Object(s.a)(i.a.mark((function e(){var t,a,n,r,o,s,l,c,u=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props,a=t.jql,n=t.setLoader,this.jql=null===a||void 0===a?void 0:a.trim(),this.jql){e.next=5;break}return this.setState({reportData:[],statusList:[]}),e.abrupt("return");case 5:return n&&n(!0),e.next=8,this.$jira.searchTickets(a,this.fieldNames,0,{expand:["changelog"]});case 8:return r=e.sent,o=(new Date).getTime(),s=r.map((function(e){for(var t=e.key,a=e.changelog,n=(a=void 0===a?{}:a).histories,r=e.fields,i=r.summary,s=r.status,l=r.issuetype,c=r.assignee,d=r.reporter,m=r.created,p=r.project,g=r.parent,f=r.timeestimate,h=r.aggregatetimeestimate,v=r.timeoriginalestimate,k=r.aggregatetimeoriginalestimate,y=r[u.epicNameField],b=r[u.storyPointField],E=[],w=n.length,S=function(){var e=n[w],t=e.created;e.items.filter((function(e){return"status"===e.field})).forEach((function(e){var a=e.fromString,n=e.toString;E.push({date:T()(t).toDate().getTime(),from:a,to:n})}))};--w>=0;)S();var C=T()(m).toDate().getTime(),N=E.length-1,j=E.reduce((function(e,t,a){var n=t.date,r=t.from,i=t.to;return e[r]=(e[r]||0)+(n-C),C=n,N===a&&(e[i]=(e[i]||0)+(o-C)),e}),{});return Object.keys(j).forEach((function(e){j[e]||delete j[e]})),{key:t,summary:i,status:s,issuetype:l,assignee:c,reporter:d,created:m,project:p,parent:g,timeestimate:f,aggregatetimeestimate:h,timeoriginalestimate:v,aggregatetimeoriginalestimate:k,statusData:j,changelog:E,epic:y,storyPoint:b}})),l=s.distinct((function(e){return e.project.key})),e.next=14,this.getStatuses(l);case 14:c=e.sent,this.columnList=this.getFieldList(c),n&&n(!1),this.setState({reportData:s,statusList:c});case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getFieldList",value:function(e){var t=this.props.onAddWorklog;return[{field:"key",displayText:"Ticket No",type:"string",viewComponent:G.i,props:{onAddWorklog:t}},{field:"summary",displayText:"Summary",type:"string"},{field:"project",fieldKey:"project.key",displayText:"Project",type:"string",viewComponent:G.g},{field:"issuetype",fieldKey:"issuetype.name",displayText:"Issue Type",type:"string",viewComponent:G.e},{field:"epic",displayText:"Epic",type:"string",viewComponent:G.i,props:{hideWorklog:!0}},{field:"storyPoint",displayText:"Story Points",type:"number"},{field:"timeestimate",displayText:"Time Estimate",type:"number",viewComponent:G.j},{field:"aggregatetimeestimate",displayText:"\u03a3 Time Estimate",type:"number",viewComponent:G.j},{field:"timeoriginalestimate",displayText:"Original Estimate",type:"number",viewComponent:G.j},{field:"aggregatetimeoriginalestimate",displayText:"\u03a3 Original Estimate",type:"number",viewComponent:G.j},{field:"parent",fieldKey:"project.key",displayText:"Parent",type:"string",viewComponent:G.c,props:{onAddWorklog:t}},{field:"status",fieldKey:"status.name",displayText:"Status",type:"string",viewComponent:G.e},{field:"created",displayText:"Created",type:"datetime",viewComponent:G.b},{field:"assignee",fieldKey:"assignee.displayName",displayText:"Assignee",type:"string",viewComponent:G.m},{field:"reporter",fieldKey:"reporter.displayName",displayText:"Reporter",type:"string",viewComponent:G.m}].concat(Object(r.a)(e.map((function(e){return{field:"statusData.".concat(e.name),displayText:"Spent on ".concat(e.name),type:"number",viewComponent:G.j,props:{inputType:"ticks",days:!0}}}))))}},{key:"getStatuses",value:function(){var e=Object(s.a)(i.a.mark((function e(t){var a,n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$jira.getProjectStatuses(t);case 2:return a=e.sent,n=[],r=[],a.forEach((function(e){e.forEach((function(e){e.statuses.forEach((function(e){if(!~n.indexOf(e.id)){var t=e.id,a=e.name,o=e.iconUrl;n.push(t),r.push({name:a,iconUrl:o})}}))}))})),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.columnList,t=this.state,a=t.loading,n=t.reportData,r=this.props,o=r.settings,i=r.settingsChanged,s=o||{},l=s.displayColumns,c=s.groupBy,u=s.groupFoldable,d=s.sortField,m=s.isDesc;return v.a.createElement("div",{className:"statuswise-ts-grid"},!a&&n&&v.a.createElement(B.a,{dataset:n,exportSheetName:"Status wise time spent",columns:e,allowSorting:!0,onChange:i,displayColumns:l,groupBy:c,groupFoldable:u,sortField:d,isDesc:m,noRowsMessage:"No ticket details available"}))}}]),a}(h.PureComponent)),H=a(296),q=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;Object(c.a)(this,a),(n=t.call(this,e,"Gadget configurations")).onDone=function(){n.onHide(n.state.pageSettings)},n.onChange=function(e,t){var a=n.state.pageSettings;a=Object(l.a)(Object(l.a)({},a),{},{jql:e,jqlSettings:t}),n.setState({pageSettings:a})},n.className="no-padding";var r=e.pageSettings;return n.state={showDialog:!0,pageSettings:Object(l.a)({},r)},n}return Object(u.a)(a,[{key:"getFooter",value:function(){return v.a.createElement(M.b,{icon:"fa fa-floppy-o",label:"Done",onClick:this.onDone})}},{key:"render",value:function(){var e=this.state.pageSettings,t=e.jql,n=e.jqlSettings;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement("div",null,v.a.createElement(H.a,{jql:t,settings:n,onChange:this.onChange})))}}]),a}(I.a),_=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e,"Status Wise Time Spent","fa-list-alt")).settingsChanged=function(e){n.pageSettingsChanged({gridSettings:e})},n.pageSettingsChanged=function(e){e&&(n.settings=Object(l.a)(Object(l.a)({},n.settings),e),n.saveSettings()),n.setState({showSettings:!1,settings:e})},n.showSettings=function(){n.setState({showSettings:!0})},n.setLoader=function(e){n.setState({isLoading:e})},n.refreshData=function(){var e=n.state.gridKey;e++,n.setState({gridKey:e})},Object(E.a)(Object(d.a)(n),"SessionService","AnalyticsService"),n.state.gridKey=0,n}return Object(u.a)(a,[{key:"renderCustomActions",value:function(){return v.a.createElement(M.b,{icon:"fa fa-cogs",onClick:this.showSettings,title:"Show settings"})}},{key:"render",value:function(){var e=this.state,t=e.showSettings,n=e.gridKey,r=this.settings||{},o=r.jql,i=r.gridSettings;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement("div",{className:"status-wise-ts-gadget"},!o&&v.a.createElement("div",{className:"no-jql"},"No JQL was set to fetch the data. Click on ",v.a.createElement("span",{className:"fa fa-cogs"})," icon from top right corner of the gadget and modify the JQL to fetch data from Jira."),o&&v.a.createElement(V,{key:n,setLoader:this.setLoader,jql:o,settings:i,settingsChanged:this.settingsChanged,onAddWorklog:this.addWorklogOn}),t&&v.a.createElement(q,{pageSettings:this.settings,onHide:this.pageSettingsChanged})))}}]),a}(b.b),Y=a(33),K=a(35),z=a(245),Q=a(282),Z=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e,"Daywise worklog","fa-list-alt")).refreshData=function(){var e=n.settings.dateRange;if(e){var t=Object(Q.b)(e.quickDate)||[],a=Object(Y.a)(t,2),r=a[0],o=a[1];r&&(e.fromDate=r,e.toDate=o),e.fromDate&&(n.setState({isLoading:!0}),e.dateWise=!0,n.$worklog.getWorklogs(e).then((function(e){e.forEach((function(e){return e.rowClass=n.$utils.getRowStatus(e)})),n.setState({worklogs:e,isLoading:!1})})))}},Object(K.b)(Object(d.a)(n),"WorklogService","UtilsService","UserUtilsService"),n.contextMenu=[{label:"Upload worklog",icon:"fa fa-clock-o",command:function(){return n.uploadWorklog()}},{label:"Add worklog",icon:"fa fa-bookmark",command:function(){return n.addWorklog()}}],n}return Object(u.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){this.refreshData()}},{key:"getWorklogUrl",value:function(e,t){return this.$userutils.getWorklogUrl(e,t)}},{key:"showContext",value:function(e,t){this.selectedDay=t,Object(W.showContextMenu)(e,this.contextMenu)}},{key:"dateSelected",value:function(e){this.settings.dateRange=e,e.toDate&&(this.refreshData(),e.auto||this.saveSettings())}},{key:"uploadWorklog",value:function(){var e=this,t=this.selectedDay.ticketList.filter((function(e){return!e.worklogId})).map((function(e){return e.id}));0!==t.length&&(this.setState({isLoading:!0}),this.$worklog.uploadWorklogs(t).then((function(){e.refreshData(),Object(g.a)(Object(f.a)(a.prototype),"performAction",e).call(e,b.a.WorklogModified)}),(function(t){e.setState({isLoading:!1})})))}},{key:"addWorklog",value:function(){var e=T()(this.selectedDay.dateLogged).toDate(),t=null;this.selectedDay.pendingUpload>0&&(t=this.$utils.formatTs(this.selectedDay.pendingUpload,!0)),Object(g.a)(Object(f.a)(a.prototype),"addWorklog",this).call(this,{startTime:e,timeSpent:t,allowOverride:!!t})}},{key:"executeEvent",value:function(e){e.type===b.a.AddWorklog||e.type===b.a.DeletedWorklog||e.type===b.a.WorklogModified?this.refreshData():Object(g.a)(Object(f.a)(a.prototype),"executeEvent",this).call(this,e)}},{key:"renderCustomActions",value:function(){var e=this;return v.a.createElement(M.e,{range:!0,value:this.settings.dateRange,onChange:function(t){return e.dateSelected(t)},style:{marginRight:"35px"}})}},{key:"render",value:function(){var e=this,t=this.state.worklogs;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement(z.c,{dataset:t,exportSheetName:"Datewise worklog"},v.a.createElement(z.e,null,v.a.createElement("tr",null,v.a.createElement(z.a,{sortBy:"dateLogged",style:{width:"100px"}},"Logged Date"),v.a.createElement(z.a,{sortBy:"totalHours"},"Total Hours"),v.a.createElement(z.a,{sortBy:"uploaded"},"Uploaded"),v.a.createElement(z.a,{sortBy:"pendingUpload"},"Pending Upload"),v.a.createElement(z.a,null,"Ticket List"))),v.a.createElement(z.d,null,(function(t){return v.a.createElement("tr",{key:t.dateLogged,onContextMenu:function(a){return e.showContext(a,t)},className:t.rowClass},v.a.createElement("td",null,e.$userutils.formatDate(t.dateLogged)),v.a.createElement("td",null,e.$utils.formatTs(t.totalHours)),v.a.createElement("td",null,e.$utils.formatTs(t.uploaded)),v.a.createElement("td",null,e.$utils.formatTs(t.pendingUpload)),v.a.createElement("td",null,v.a.createElement("ul",{className:"tags"},t.ticketList.map((function(t,a){return v.a.createElement("li",{key:a},t.worklogId&&v.a.createElement("a",{className:"link badge badge-pill skin-bg-font",href:e.getWorklogUrl(t.ticketNo,t.worklogId),target:"_blank",rel:"noopener noreferrer",title:t.comment},v.a.createElement("span",{className:"fa fa-clock-o"})," ",t.ticketNo,": ",t.uploaded),!t.worklogId&&v.a.createElement("span",{className:"link badge badge-pill skin-bg-font",onClick:function(){return e.editWorklog(t.id)},title:t.comment},v.a.createElement("span",{className:"fa fa-clock-o"})," ",t.ticketNo,": ",t.uploaded))})))))})),v.a.createElement(z.b,{span:5},"No worklog exists for selected date range!")))}}]),a}(b.b),J=a(274),X=a(112),ee=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;Object(c.a)(this,a),(n=t.call(this,e,"Report configurations")).onDone=function(){n.$config.saveSettings("reports_UserDayWise",n.state.pageSettings),n.onHide(n.state.pageSettings)},n.setValue=function(e,t){var a=n.state.pageSettings;a[e]=t,a=Object(l.a)({},a),n.setState({pageSettings:a})},Object(K.b)(Object(d.a)(n),"ConfigService"),n.className="no-padding";var r=e.pageSettings;return n.state={showDialog:!0,pageSettings:Object(l.a)({},r)},n.hideEstimate=r.hideEstimate,n}return Object(u.a)(a,[{key:"getFooter",value:function(){return v.a.createElement(M.b,{icon:"fa fa-floppy-o",label:"Done",onClick:this.onDone})}},{key:"render",value:function(){var e=this.setValue,t=this.state.pageSettings,n=t.logFormat,r=t.breakupMode,o=t.timeZone,i=t.jql,s=t.hideEstimate;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement(X.TabView,{styleclass:"query-tab"},v.a.createElement(X.TabPanel,{header:"General",leftIcon:"fa fa-cog",contentClassName:"pad-22"},v.a.createElement("div",{className:"form-group row"},v.a.createElement("label",{className:"col-md-3 col-form-label"},"Log hour format"),v.a.createElement("div",{className:"col-md-9 col-form-label"},v.a.createElement("div",{className:"form-check"},v.a.createElement("label",{className:"form-check-label"},v.a.createElement("input",{className:"form-check-input",value:n,onChange:function(){return e("logFormat","1")},type:"radio",checked:"1"===n,name:"hourformat"}),"Format hours (2h 30m)")),v.a.createElement("div",{className:"form-check"},v.a.createElement("label",{className:"form-check-label"},v.a.createElement("input",{className:"form-check-input",value:n,onChange:function(){return e("logFormat","2")},type:"radio",checked:"2"===n,name:"hourformat"}),"Show in hours (2.5)")))),v.a.createElement("div",{className:"form-group row"},v.a.createElement("label",{className:"col-md-3 col-form-label"},"Log breakup"),v.a.createElement("div",{className:"col-md-9 col-form-label"},v.a.createElement("div",{className:"form-check"},v.a.createElement("label",{className:"form-check-label"},v.a.createElement("input",{className:"form-check-input",value:r,onChange:function(){return e("breakupMode","1")},type:"radio",checked:"1"===r,name:"logbreakup"}),"Single entry (Sum worklog added for same ticket on same day)")),v.a.createElement("div",{className:"form-check"},v.a.createElement("label",{className:"form-check-label"},v.a.createElement("input",{className:"form-check-input",value:r,onChange:function(){return e("breakupMode","2")},type:"radio",checked:"2"===r,name:"logbreakup"}),"Individual entry (Display individual entry for each of the worklog)")))),v.a.createElement("div",{className:"form-group row"},v.a.createElement("label",{className:"col-md-3 col-form-label"},"Report timezone (experimental)"),v.a.createElement("div",{className:"col-md-9 col-form-label"},v.a.createElement("div",{className:"form-check"},v.a.createElement("label",{className:"form-check-label"},v.a.createElement("input",{className:"form-check-input",value:o,onChange:function(){return e("timeZone","1")},type:"radio",checked:"1"===o,name:"timezone"}),"Use my local time zone for all users")),v.a.createElement("div",{className:"form-check"},v.a.createElement("label",{className:"form-check-label"},v.a.createElement("input",{className:"form-check-input",value:o,onChange:function(){return e("timeZone","2")},type:"radio",checked:"2"===o,name:"timezone"}),"Use containing groups timezone for all users")),v.a.createElement("div",{className:"form-check"},v.a.createElement("label",{className:"form-check-label"},v.a.createElement("input",{className:"form-check-input",value:o,onChange:function(){return e("timeZone","3")},type:"radio",checked:"3"===o,name:"timezone"}),"Use individual users timezone")))),v.a.createElement("div",{className:"form-group row"},v.a.createElement("div",{className:"form-check"},v.a.createElement("label",{className:"form-check-label"},v.a.createElement(M.c,{checked:s,onChange:function(t){return e("hideEstimate",t)},label:"Hide estimate related fields"}),this.hideEstimate&&!s&&v.a.createElement("span",{className:"pad-left-15"}," ( ",v.a.createElement("i",{className:"fa fa-exclamation-triangle"})," Change will take effect only after report is refreshed )"))))),v.a.createElement(X.TabPanel,{header:"JQL Filter",leftIcon:"fa fa-filter"},v.a.createElement(M.j,{multiline:!0,value:i,onChange:function(t){return e("jql",t)},style:{width:"100%",height:323},placeholder:"Provide the additional JQL filters to be applied while fetching data.",defaultValue:""}),v.a.createElement("span",null,v.a.createElement("strong",null,"Note:")," Date range and user list filter will be added automatically."))))}}]),a}(I.a),te=["-originalestimate","-totalLogged","-remainingestimate","-estVariance"],ae=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).settingsChanged=function(e,t){n.props.onChange(e,t)},n.setPropsInClass(e),n.state=n.getNewState(e),n.state.groupBy=[],n}return Object(u.a)(a,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.updateData(e)}},{key:"updateData",value:function(e){this.data===e.flatData&&this.pageSettings===e.pageSettings||(this.setPropsInClass(e),this.setState(this.getNewState(e)))}},{key:"getNewState",value:function(e){return{columns:this.getColumnSettings(e)}}},{key:"setPropsInClass",value:function(e){this.data=e.flatData,this.pageSettings=this.props.pageSettings}},{key:"getColumnSettings",value:function(e){var t=this,a=e.formatDateTime,n=e.convertSecs;return[{field:"groupName",displayText:"Group Name",type:"string"},{field:"projectName",displayText:"Project Name",type:"string"},{field:"issueType",displayText:"Issue Type",type:"string"},{field:"epicDisplay",displayText:"Epic",type:"string",format:function(e,a){return t.formatTicket(e,a.epicUrl)}},{field:"parent",displayText:"Parent",type:"string",format:function(e,a){return t.formatTicket(e,a.parentUrl)}},{field:"ticketNo",displayText:"Ticket No",type:"string",format:function(e,a){return t.formatTicket(e,a.ticketUrl)}},{field:"statusName",displayText:"Status",type:"string"},{field:"summary",displayText:"Summary",type:"string"},{field:"logTime",displayText:"Log Date & Time",type:"datetime",format:a},{field:"userDisplay",displayText:"Assignee",type:"string"},{field:"timeSpent",displayText:"Hr. Spent",type:"number",format:n},{field:"originalestimate",displayText:"Ori. Estm.",type:"number",format:n},{field:"totalLogged",displayText:"Total Worklogs",type:"number",format:n},{field:"remainingestimate",displayText:"Rem. Estm.",type:"number",format:n},{field:"estVariance",displayText:"Estm. Variance",type:"number",format:function(e){return(e>0?"+":"")+n(e)}},{field:"comment",displayText:"Comment"}]}},{key:"formatTicket",value:function(e,t){return e&&v.a.createElement("a",{href:t,className:"link",target:"_blank",rel:"noopener noreferrer"},e)}},{key:"render",value:function(){var e=this.props,t=e.flatData,a=e.pageSettings,n=(a=void 0===a?{}:a).hideEstimate,r=a.flatTableSettings,o=(r=void 0===r?{displayColumns:n?te:null}:r).groupBy,i=r.groupFoldable,s=r.displayColumns,l=r.sortField,c=r.isDesc,u=this.state.columns;return v.a.createElement(B.a,{className:"flat-data-grid",dataset:t,exportSheetName:"Flat Worklogs",columns:u,allowSorting:!0,onChange:this.settingsChanged,displayColumns:s,groupBy:o,groupFoldable:i,sortField:l,isDesc:c,noRowsMessage:"No worklog details available"})}}]),a}(h.PureComponent),ne=a(12),re=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={groupedData:n.generateGroupData(e)},n}return Object(u.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){this.setState({groupedData:this.generateGroupData(this.props)})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState({groupedData:this.generateGroupData(e)})}},{key:"getCssClass",value:function(e,t){if(t=t>0?t:0,e.isHoliday)return t?"log-high":"col-holiday";var a=this.props.maxSecsPerDay;return t===a?"log-good":t<a?"log-less":t>a?"log-high":void 0}},{key:"generateGroupData",value:function(e){var t=this,a=e.rawData,n=e.dates,r=e.pageSettings,o=e.groups,i=e.getTicketUrl,s=parseInt(r.timeZone),l=o.map((function(e){var r={name:e.name,total:{},grandTotal:0,users:null};r.users=e.users.map((function(r){var o=null;2===s?o=e.timeZone:3===s&&(o=r.timeZone||e.timeZone),o&&"object"===Object(ne.a)(o)&&(o="string"===typeof o.value?o.value:""),"GRP_TZ"===o&&(o=e.timeZone),o&&"object"===Object(ne.a)(o)&&(o="string"===typeof o.value?o.value:"");var l={name:Object(A.e)(r),displayName:r.displayName,emailAddress:r.emailAddress,timeZone:o,imageUrl:r.avatarUrls["48x48"]||r.avatarUrls["32x32"],profileUrl:r.self,tickets:null,total:{},logClass:{},grandTotal:0},c=a.first((function(e){return e.userName===Object(A.e)(r,!0)}))||{};c.isCurrentUser&&(l.isCurrentUser=!0);var u=c.logData||[];l.tickets=u.groupBy((function(e){return e.ticketNo})).map((function(e){var t=e.values,a=t.first(),n={},r={ticketNo:e.key,parent:a.parent,parentUrl:a.parent?i(a.parent):null,epicDisplay:a.epicDisplay,epicUrl:a.epicUrl,issueType:a.issueType,statusName:a.statusName,summary:a.summary,originalestimate:a.originalestimate,remainingestimate:a.remainingestimate,totalLogged:a.totalLogged,estVariance:a.estVariance,url:a.url,logs:n,totalHours:0},s=0;return t.forEach((function(e){var t=e.logTime;o&&(t=T()(T()(t).tz(o).format("YYYY-MM-DD HH:mm:ss")).toDate());var a=t.format("yyyyMMdd"),r=n[a];r||(r=[],n[a]=r),r.push({logTime:t,totalHours:e.totalHours,comment:e.comment}),s+=e.totalHours})),r.totalHours=s,r}));var d=l.logClass,m=l.total,p=0;return n.forEach((function(e){var a=l.tickets.sum((function(t){var a=t.logs[e.prop];return a?a.sum((function(e){return e.totalHours})):0}));a>0&&(m[e.prop]=a,p+=a),d[e.prop]=t.getCssClass(e,a)})),l.grandTotal=p,l}));var o=r.total,l=0;return n.forEach((function(e){var t=r.users.sum((function(t){return t.total[e.prop]||0}));t>0&&(o[e.prop]=t,l+=t)})),r.grandTotal=l,r})),c=0,u={};return n.forEach((function(e){var t=l.sum((function(t){return t.total[e.prop]||0}));t>0&&(u[e.prop]=t,c+=t)})),l.grandTotal=c,l.total=u,l}},{key:"render",value:function(){var e=this.state.groupedData,t=this.props,a=t.months,n=t.dates,r=t.convertSecs,o=t.formatTime,i=t.breakupMode,s=t.pageSettings,l=t.addWorklog,c="2"===(null===s||void 0===s?void 0:s.logFormat)?"float":void 0;return v.a.createElement(z.c,{exportSheetName:"Grouped - [User daywise]"},v.a.createElement(z.e,null,v.a.createElement("tr",{className:"data-center pad-min auto-wrap"},v.a.createElement("th",{style:{minWidth:380},rowSpan:2},"User Details"),a.map((function(e,t){return v.a.createElement("th",{key:t,style:{minWidth:35},colSpan:e.days},e.monthName)})),v.a.createElement("th",{style:{minWidth:50},rowSpan:2},"Total Hours")),v.a.createElement("tr",{className:"pad-min auto-wrap"},n.map((function(e,t){return v.a.createElement("th",{key:t,style:{minWidth:35}},e.display)})))),v.a.createElement(z.d,null,e.map((function(e,t){return v.a.createElement(oe,{key:t,group:e,dates:n,addWorklog:l,convertSecs:r,timeExportFormat:c,formatTime:o,breakupMode:i,pageSettings:s})})),v.a.createElement("tr",{className:"grouped-row right auto-wrap"},v.a.createElement("td",null,"Grand Total ",v.a.createElement("i",{className:"fa fa-arrow-right"})),n.map((function(t,a){return v.a.createElement("td",{key:a,exportType:c},r(e.total[t.prop]))})),v.a.createElement("td",{exportType:c},r(e.grandTotal)))))}}]),a}(h.PureComponent),oe=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={},e.toggleDisplay=function(){return e.setState({hidden:!e.state.hidden})},e}return Object(u.a)(a,[{key:"render",value:function(){var e=this.props,t=e.group,a=e.dates,n=e.convertSecs,r=e.formatTime,o=e.breakupMode,i=e.pageSettings,s=e.addWorklog,l=e.timeExportFormat,c=this.state.hidden;return v.a.createElement(v.a.Fragment,null,!c&&v.a.createElement("tr",{className:"grouped-row left",title:"Click to hide user details"},v.a.createElement("td",{colSpan:a.length+2,onClick:this.toggleDisplay},v.a.createElement("i",{className:"pull-left drill-down fa fa-chevron-circle-down"}),t.name)),!c&&t.users.map((function(e,t){return v.a.createElement(ie,{key:t,user:e,dates:a,breakupMode:o,addWorklog:s,timeExportFormat:l,convertSecs:n,formatTime:r,pageSettings:i})})),v.a.createElement("tr",{className:"grouped-row right auto-wrap",onClick:c?this.toggleDisplay:null},v.a.createElement("td",null,c&&v.a.createElement("div",null,v.a.createElement("i",{className:"pull-left drill-down fa fa-chevron-circle-right",title:"Click to show user details"}),v.a.createElement("span",{className:"pull-left"},t.name),v.a.createElement("span",{className:"pull-right"},"Total ",v.a.createElement("i",{className:"fa fa-arrow-right"}))),!c&&v.a.createElement("div",null,t.name," ",v.a.createElement("i",{className:"fa fa-arrow-right"})," Total ",v.a.createElement("i",{className:"fa fa-arrow-right"}))),a.map((function(e,a){return v.a.createElement("td",{key:a,exportType:l},n(t.total[e.prop]))})),v.a.createElement("td",{exportType:l},n(t.grandTotal))))}}]),a}(h.PureComponent),ie=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={},e.getComments=function(t){return t&&0!==t.length?t.map((function(t){return"".concat(e.props.formatTime(t.logTime),"(").concat(e.props.convertSecs(t.totalHours),") - ").concat(t.comment)})).join(";\n"):""},e.toggleDisplay=function(){return e.setState({expanded:!e.state.expanded})},e.addWorklog=function(t,a){var n=e.props,r=n.user,o=n.addWorklog,i=a.date,s=a.prop;o(r,t,i,r.total[s])},e}return Object(u.a)(a,[{key:"getTotalTime",value:function(e){return e&&0!==e.length?e.sum((function(e){return e.totalHours})):""}},{key:"getLogEntries",value:function(e){var t=this;if(Array.isArray(e)&&e.length>0){var a=e.length>1?";":"";return e.map((function(e,n){return v.a.createElement("span",{key:n,title:"".concat(t.props.formatTime(e.logTime)," - ").concat(e.comment)},t.props.convertSecs(e.totalHours)+a)}))}}},{key:"render",value:function(){var e=this,t=this.props,a=t.user,n=t.dates,r=t.convertSecs,o=t.breakupMode,i=t.pageSettings.hideEstimate,s=t.timeExportFormat,l=this.state.expanded;return v.a.createElement(v.a.Fragment,null,v.a.createElement("tr",{className:"pointer auto-wrap",onClick:this.toggleDisplay},v.a.createElement("td",{className:"data-left"},v.a.createElement("div",{className:"user-info",style:{paddingLeft:0}},v.a.createElement("i",{className:"pull-left drill-down fa ".concat(l?"fa-chevron-circle-down":"fa-chevron-circle-right"),title:"Click to toggle ticket details"}),v.a.createElement("img",{src:a.imageUrl,height:40,width:40,className:"pull-left",alt:a.displayName}),v.a.createElement("span",{className:"name"},a.displayName),v.a.createElement("span",{className:"email"},"(",a.emailAddress||a.name,a.timeZone&&v.a.createElement("span",null,", time zone: ",a.timeZone),")"))),n.map((function(t,n){return v.a.createElement("td",{key:n,className:"".concat(a.logClass[t.prop]," day-wl-block"),exportType:s},a.isCurrentUser&&v.a.createElement("span",{className:"fa fa-clock-o add-wl",title:"Click to add worklog",onClick:function(){return e.addWorklog(null,t)}}),r(a.total[t.prop]))})),v.a.createElement("td",{exportType:s},r(a.grandTotal))),l&&a.tickets.map((function(t,l){var c=r(t.originalestimate),u=r(t.remainingestimate),d=r(t.totalLogged)||0,m=(t.estVariance>0?"+":"")+(r(t.estVariance)||(t.originalestimate>0?0:"NA")),p="Original Estimate: ".concat(c||0,"\nRemaining: ").concat(u||0,"\nTotal Logged: ").concat(d,"\nEstimate Variance: ").concat(m);return v.a.createElement("tr",{key:l,className:"auto-wrap"},v.a.createElement("td",{className:"data-left"},t.parent&&v.a.createElement("a",{href:t.parentUrl,className:"link",target:"_blank",rel:"noopener noreferrer"},t.parent," - "),v.a.createElement("a",{href:t.url,className:"link",target:"_blank",rel:"noopener noreferrer"},t.ticketNo)," -",v.a.createElement("span",null,t.summary),v.a.createElement("strong",null," (",t.statusName,")"),!i&&!(!c&&!u)&&v.a.createElement("span",{className:"estimate",title:p},"(est: ",c||0," / rem: ",u||0," / log: ",d," / var: ",m,")")),n.map((function(n,i){return v.a.createElement("td",{key:i,className:"day-wl-block",exportType:s},a.isCurrentUser&&v.a.createElement("span",{className:"fa fa-clock-o add-wl",title:"Click to add worklog",onClick:function(){return e.addWorklog(t.ticketNo,n)}}),"2"!==o&&v.a.createElement("span",{title:e.getComments(t.logs[n.prop])},r(e.getTotalTime(t.logs[n.prop]))),"2"===o&&v.a.createElement("div",null," ",e.getLogEntries(t.logs[n.prop])))})),v.a.createElement("td",{exportType:s},r(t.totalHours)))})))}}]),a}(h.PureComponent),se=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return v.a.createElement("div",{className:"pad-15"},v.a.createElement("strong",null,"How to use:"),v.a.createElement("ul",null,v.a.createElement("li",null,"Choose a date for which you would like to view the report or click the refresh ( ",v.a.createElement("i",{className:"fa fa-refresh"})," ) icon to load the report if date is already selected."),v.a.createElement("li",null,"You can choose the list of users by clicking the ( ",v.a.createElement("i",{className:"fa fa-users"})," ) icon."),v.a.createElement("li",null,"Click on Settings ",v.a.createElement("i",{className:"fa fa-arrow-right"})," User groups from left hand menu to add users permenantly to a group and use it in future."),v.a.createElement("li",null,"Click on ( ",v.a.createElement("i",{className:"fa fa-cogs"})," ) icon to change the settings of the report."),v.a.createElement("li",null,"Time zone settings - Configure the time zone of each user & group properly while adding in group and select appropriate option in settings as well."),v.a.createElement("li",null,"You have additional settings affecting this report in Settings ",v.a.createElement("i",{className:"fa fa-arrow-right"}),"General menu in left hand side.")),v.a.createElement("p",null,v.a.createElement("strong",null,"Note:")," Any changes you make to the group or the users under the group in this page will not get saved and is only for this session."),v.a.createElement("div",null,v.a.createElement("strong",null,"Planned enhancements:")," Some of the enhancements in roadmap for this reports are as follows",v.a.createElement("ul",null,v.a.createElement("li",null,"Viewing report based on sprint as an additional option alternate for date selection"),v.a.createElement("li",null,"Add custom columns to the report"))))}}]),a}(h.PureComponent),le=(a(275),function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;Object(c.a)(this,a),n=t.call(this,e);var r=e.groups,o=e.flatData;return n.state=n.getGroupedData(r,o),n}return Object(u.a)(a,[{key:"getGroupedData",value:function(e,t){var a=[],n={},r=t.groupBy((function(e){return e.username})).reduce((function(e,t){return e[t.key]=t.values,e}),{});t.groupBy((function(e){return{key:e.projectKey,name:e.projectName}})).sortBy((function(e){return e.key.key})).forEach((function(e){var t=e.key,r=e.values;a.push(t),n[t.key]=r,t.issueTypes=r.distinct((function(e){return e.issueType}))}));var o=e.map((function(e){var t=e.name,o=e.users,i={grandTotal:0,projects:{}},s={name:t,overallTotal:i};return s.users=o.map((function(e){var t=Object(A.e)(e),o=e.emailAddress,s=e.displayName,l={name:t,emailAddress:o,displayName:s};l.projects=a.reduce((function(e,a){var r=i.projects[a.key]||{total:0};i.projects[a.key]=r;var o=n[a.key];if(o){var s=o.filter((function(e){return e.username===t}));if(s.length){var l=s.groupBy((function(e){return e.issueType})).reduce((function(e,t){var a=t.values.sum((function(e){return e.timeSpent}))||0;return e[t.key]={total:a,logs:t.values},r[t.key]=(r[t.key]||0)+a,e}),{});l.grandTotal={total:s.sum((function(e){return e.timeSpent})),logs:s},r.total+=l.grandTotal.total||0,e[a.key]=l}}return e}),{});var c=r[t]||[];return l.grandTotal={total:c.sum((function(e){return e.timeSpent})),logs:c},i.grandTotal+=l.grandTotal.total,l})),s})),i=o.reduce((function(e,t){var n=t.overallTotal,r=n.grandTotal,o=n.projects;return e.grandTotal=(e.grandTotal||0)+r,a.forEach((function(t){var a=o[t.key]||{},n=e[t.key]||{total:0};e[t.key]=n,n.total+=a.total||0,t.issueTypes.forEach((function(e){var t=a[e]||0;n[e]=(n[e]||0)+t}))})),e}),{grandTotal:0});return{projects:a,projectsData:n,groupedData:o,grandTotal:i}}},{key:"render",value:function(){var e=this.props.convertSecs,t=this.state,a=t.projects,n=t.groupedData,r=t.grandTotal;return v.a.createElement(z.c,{dataset:n,exportSheetName:"Summary - [User project wise]"},v.a.createElement(z.e,null,v.a.createElement(z.f,null,v.a.createElement(z.a,{rowSpan:2},"Group Name"),v.a.createElement(z.a,{rowSpan:2},"User Name"),a.map((function(e){return v.a.createElement(z.a,{key:e.key,colSpan:e.issueTypes.length+1},e.name)})),v.a.createElement(z.a,{rowSpan:2},"Grand Total")),v.a.createElement(z.f,null,a.map((function(e,t){return v.a.createElement(h.Fragment,{key:t},e.issueTypes.map((function(e,t){return v.a.createElement(z.a,{key:t},e)})),v.a.createElement(z.a,null,"Total"))})))),v.a.createElement(z.d,null,(function(t,n){return v.a.createElement(h.Fragment,{key:n},t.users.map((function(n,r){return v.a.createElement("tr",{key:r},0===r&&v.a.createElement("td",{rowSpan:t.users.length+1},t.name),v.a.createElement("td",null,n.displayName),a.map((function(t,a){var r=n.projects[t.key]||{};return v.a.createElement(h.Fragment,{key:a},t.issueTypes.map((function(t,a){var n=r[t];return v.a.createElement("td",{key:a,className:"data-center",exportType:"float"},n?e(n.total):null)})),v.a.createElement("td",{className:"strong data-center",exportType:"float"},r.grandTotal?e(r.grandTotal.total):null))})),v.a.createElement("td",{className:"strong data-center",exportType:"float"},e(n.grandTotal.total)))})),v.a.createElement("tr",{className:"strong data-center"},v.a.createElement("td",{className:"data-right"},"Group Total ",v.a.createElement("span",{className:"fa fa-arrow-right"})),a.map((function(a,n){var r=t.overallTotal.projects[a.key]||{};return v.a.createElement(h.Fragment,{key:n},a.issueTypes.map((function(t,a){return v.a.createElement("td",{key:a,exportType:"float"},e(r[t]))})),v.a.createElement("td",{exportType:"float"},e(r.total)))})),v.a.createElement("td",{exportType:"float"},e(t.overallTotal.grandTotal))))})),v.a.createElement("tfoot",null,v.a.createElement("tr",{className:"strong data-center"},v.a.createElement("td",{colSpan:2,className:"data-right"},"Grand total ",v.a.createElement("span",{className:"fa fa-arrow-right"})),a.map((function(t,a){return v.a.createElement(h.Fragment,{key:a},t.issueTypes.map((function(a,n){return v.a.createElement("td",{key:n,exportType:"float"},e(r[t.key][a]))})),v.a.createElement("td",{exportType:"float"},e(r[t.key].total)))})),v.a.createElement("td",{exportType:"float"},e(r.grandTotal)))),v.a.createElement(z.b,{span:11},"No worklog details available"))}}]),a}(h.PureComponent)),ce=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;Object(c.a)(this,a),(n=t.call(this,e,"Worklog Report","fa-list-alt")).dateSelected=function(e){e&&e.fromDate&&e.toDate&&n.setState({dateRange:e},n.refreshData)},n.refreshData=function(){var e=n.state.groups;if(e&&0!==e.length){n.userList=e.union((function(e){return e.users.forEach((function(t){return t.groupName=e.name})),e.users}));var t={userList:n.userList.map((function(e){return Object(A.e)(e,!0)})),fromDate:n.state.dateRange.fromDate,toDate:n.state.dateRange.toDate};n.setState({isLoading:!0}),n.getDayWiseReportData(t).then((function(e){n.$analytics.trackEvent("Worklog report viewed",$.i.UserActions),n.rawData=e,n.generateFlatData(e),n.setState({isLoading:!1}),n.onResize({target:window})}))}else n.$message.warning("User list need to be added before generating report","Missing input")},n.showGroupsPopup=function(){return n.setState({showGroupsPopup:!0})},n.showSettings=function(){return n.setState({showSettings:!0})},n.groupsChanged=function(e){var t={showGroupsPopup:!1};e&&Array.isArray(e)&&(t.groups=e),n.setState(t)},n.settingsChanged=function(e){e||(e=n.state.pageSettings),n.setState({showSettings:!1,pageSettings:e})},n.groupSettingsChanged=function(e){var t=e.groupBy,a=e.groupFoldable,r=e.displayColumns,o=e.sortField,i=e.isDesc,s=n.state.pageSettings;s=Object(l.a)(Object(l.a)({},s),{},{flatTableSettings:{groupBy:t,groupFoldable:a,displayColumns:r,sortField:o,isDesc:i}}),n.$config.saveSettings("reports_UserDayWise",s),n.settingsChanged(s)},n.addWorklog=function(e,t,a,r){var o=(n.maxSecsPerDay||0)-(r||0);o<60&&(o="01:00"),n.worklogItem={ticketNo:t,dateStarted:a,timeSpent:o},n.setState({showWorklogPopup:!0})},n.worklogAdded=function(e){var t=e.added.sourceObject;console.log("Worklog added: ",t)},n.hideWorklog=function(){n.worklogItem=null,n.setState({showWorklogPopup:!1})},n.convertSecs=function(e){return n.$utils.convertSecs(e,{format:"1"===n.state.pageSettings.logFormat})},n.formatTime=function(e){return n.$userutils.formatTime(e)},n.formatDateTime=function(e){return n.$userutils.formatDateTime(e)},Object(K.b)(Object(d.a)(n),"SessionService","CacheService","UtilsService","UserUtilsService","JiraService","MessageService","ConfigService","UserGroupService","AnalyticsService");var r=n.$session.pageSettings.reports_UserDayWise;r.timeZone||(r.timeZone="1"),n.state.dateRange={},n.state.pageSettings=r;var o=n.$session.CurrentUser,i=o.maxHours,s=o.epicNameField,u=o.name;return n.currentUserName=u.toLowerCase(),n.maxSecsPerDay=60*(i||8)*60,n.epicNameField=(s||{}).id,n}return Object(u.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){var e=this;this.$usergroup.getUserGroups().then((function(t){return e.setState({groups:t})}))}},{key:"getDayWiseReportData",value:function(e){var t=this,a=e.userList.distinct(),n=T()(e.fromDate).startOf("day"),r=T()(e.toDate).endOf("day"),o=n.toDate(),i=r.toDate(),s=this.getDateArray(o,i);this.dates=s.map((function(e){return{prop:e.format("yyyyMMdd"),display:e.format("DDD, dd"),date:e,isHoliday:t.$userutils.isHoliday(e)}})),this.months=s.groupBy((function(e){return e.format("MMM, yyyy")})).map((function(e){return{monthName:e.key,days:e.values.length}}));var l=this.state.pageSettings.hideEstimate,c=(this.state.pageSettings.jql||"").trim();c&&(c=" AND (".concat(c,")"));var u='worklogAuthor in ("'.concat(a.join('","'),"\") and worklogDate >= '").concat(n.clone().add(-1,"days").format("YYYY-MM-DD"),"' and worklogDate < '").concat(r.clone().add(1,"days").format("YYYY-MM-DD"),"'").concat(c),d=["summary","worklog","issuetype","parent","project","status"];l||(d.push("timeoriginalestimate"),d.push("timeestimate"));var m=this.epicNameField;return m&&d.push(m),this.$jira.searchTickets(u,d).then((function(e){for(var n=a.map((function(e){var a={logData:[],userName:e.toLowerCase()};return a.userName===t.currentUserName&&(a.isCurrentUser=!0),a})),r={},s=0;s<n.length;s++){var l=n[s];r[l.userName]=l}for(var c=0;c<e.length;c++)for(var u=e[c],d=u.fields||{},p=(d.worklog||{}).worklogs||[],g=p.sum((function(e){return e.timeSpentSeconds})),f=d.timeoriginalestimate||0,h=d.timeestimate||0,v=f>0?h+g-f:0,k=0;k<p.length;k++){var y=p[k],b=T()(y.started).toDate(),E=T()(y.started).startOf("day").toDate();if(E.getTime()>=o.getTime()&&E.getTime()<=i.getTime()){var w=r[Object(A.e)(y.author,!0)];if(w){var S={ticketNo:u.key,epicDisplay:null,epicUrl:null,url:t.$userutils.getTicketUrl(u.key),issueType:(d.issuetype||"").name,parent:(d.parent||"").key,summary:d.summary,originalestimate:f,remainingestimate:h,totalLogged:g,estVariance:v,logTime:b,comment:y.comment,projectName:d.project.name,statusName:(d.status||{}).name,projectKey:d.project.key,totalHours:y.timeSpentSeconds};if(m){S.epicDisplay=d[m];var C=S.ticketNo.split("-")[0];S.epicDisplay&&0===S.epicDisplay.indexOf("".concat(C,"-"))&&(S.epicUrl=t.$userutils.getTicketUrl(S.epicDisplay))}w.logData.push(S)}}}for(var N=0;N<n.length;N++){var j=n[N];j.totalHours=j.logData.sum((function(e){return e.totalHours}))}return n}))}},{key:"generateFlatData",value:function(e){var t=this;this.flatData=this.state.groups.union((function(a){var n=a.name;return a.users.union((function(a){var r=a.displayName;return e.first((function(e){return e.userName===Object(A.e)(a,!0)})).logData.map((function(e){return{groupName:n,username:Object(A.e)(a),userDisplay:r,parent:e.parent,parentUrl:e.parent?t.$userutils.getTicketUrl(e.parent):null,epicDisplay:e.epicDisplay,epicUrl:e.epicUrl,ticketNo:e.ticketNo,ticketUrl:e.url,issueType:e.issueType,summary:e.summary,projectKey:e.projectKey,projectName:e.projectName,statusName:e.statusName,logTime:e.logTime,timeSpent:e.totalHours,originalestimate:e.originalestimate,remainingestimate:e.remainingestimate,totalLogged:e.totalLogged,estVariance:e.estVariance,comment:e.comment}}))}))}))}},{key:"getDateArray",value:function(e,t){for(var a=[],n=new Date(e);n<=t;)a.push(new Date(n)),n=n.addDays(1);return a}},{key:"renderCustomActions",value:function(){var e=this.state.dateRange;return v.a.createElement(v.a.Fragment,null,v.a.createElement(M.e,{value:e,range:!0,onChange:this.dateSelected,style:{marginRight:"35px"}}),v.a.createElement(M.b,{icon:"fa fa-users",onClick:this.showGroupsPopup,title:"Add users / groups to report"}),v.a.createElement(M.b,{icon:"fa fa-cogs",onClick:this.showSettings,title:"Show settings"}))}},{key:"render",value:function(){var e=this.months,t=this.dates,n=this.convertSecs,r=this.formatTime,o=this.formatDateTime,i=this.rawData,s=this.flatData,l=void 0===s?[]:s,c=this.state,u=c.isLoading,d=c.showGroupsPopup,m=c.showWorklogPopup,p=c.showSettings,h=c.groups,k=c.pageSettings,y=void 0===k?{}:k,b=y.breakupMode,E="".concat(y._uniqueId,"_").concat(l._uniqueId);return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement("div",{className:"worklog-gadget-container"},!i&&!u&&v.a.createElement(se,null),u&&v.a.createElement("div",{className:"pad-15"},"Loading... please wait while the report is being loaded. It may take few seconds / minute based on the range you had selected."),i&&v.a.createElement(X.TabView,{className:"no-padding",renderActiveOnly:!1},v.a.createElement(X.TabPanel,{header:"Grouped - [User daywise]",contentClassName:"no-padding"},i&&v.a.createElement(re,{rawData:i,groups:h,dates:t,months:e,pageSettings:y,convertSecs:n,formatTime:r,breakupMode:b,getTicketUrl:this.$userutils.getTicketUrl,maxSecsPerDay:this.maxSecsPerDay,addWorklog:this.addWorklog})),v.a.createElement(X.TabPanel,{header:"Summary - [User project wise]"},l&&v.a.createElement(le,{key:E,groups:h,flatData:l,formatDateTime:o,convertSecs:n})),v.a.createElement(X.TabPanel,{header:"Flat (Groupable)"},l&&v.a.createElement(ae,{key:E,flatData:l,formatDateTime:o,convertSecs:n,pageSettings:y,onChange:this.groupSettingsChanged}))),d&&v.a.createElement(J.a,{groups:h,onHide:this.groupsChanged}),p&&v.a.createElement(ee,{pageSettings:y,onHide:this.settingsChanged}),m&&v.a.createElement(x.a,{worklog:this.worklogItem,onDone:this.worklogAdded,onHide:this.hideWorklog,uploadImmediately:!0})))}}]),a}(b.b),ue=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e,"Add Bookmark")).addBookmark=function(){var e=n.state.ticketsList;e.length>0?(n.setState({isLoading:!0}),n.$bookmark.addBookmark(e).then((function(t){0===t.length?n.onHide(!0):(n.setState({isLoading:!1,ticketsList:t}),e.length===t.length?n.$message.warning("None of the ticket numbers provided are valid."):e.length>t.length&&n.$message.warning("Some of the ticket numbers provided are not valid."))}))):n.onHide()},n.listChanged=function(e){return n.setState({ticketsList:e})},Object(K.b)(Object(d.a)(n),"BookmarkService","MessageService"),n.style.width="380px",n.state.ticketsList=[],n}return Object(u.a)(a,[{key:"getFooter",value:function(){return v.a.createElement(v.a.Fragment,null,v.a.createElement(M.b,{type:"primary",onClick:this.addBookmark,label:"Save"}),v.a.createElement(M.b,{type:"default",onClick:this.onHide,label:"Cancel"}))}},{key:"render",value:function(){var e=this.state.ticketsList;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement("div",{className:"pad-22"},v.a.createElement(M.g,{value:e,onChange:this.listChanged,placeholder:"Enter one or more ticket numbers"}),v.a.createElement("strong",null,"Note:")," Press enter key to add multiple items"))}}]),a}(I.a),de=a(249),me=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e,"My Bookmarks","fa-bookmark")).refreshData=function(){n.setState({isLoading:!0,showAddPopup:!1}),n.$bookmark.getBookmarks().then((function(e){var t=n.state.selAllChk;e.forEach((function(e){e.ticketUrl=n.$userutils.getTicketUrl(e.ticketNo),e.selected=t,e.rowClass=n.$utils.getRowStatus(e)})),n.setState({isLoading:!1,bookmarksList:e})}))},n.selectAll=function(e){var t=n.state.bookmarksList;(t=Object(r.a)(t)).forEach((function(t){return t.selected=e})),n.setState({selAllChk:e,bookmarksList:t})},n.showAddPopup=function(){return n.setState({showAddPopup:!0})},n.hideAddPopup=function(e){e?n.refreshData():n.setState({showAddPopup:!1})},Object(E.a)(Object(d.a)(n),"JiraService","BookmarkService","UtilsService","UserUtilsService","MessageService"),n.contextMenu=[{label:"Select Bookmark",icon:"fa fa-check-square-o",command:function(){return n.selectTicket(n.selectedTicket)}},{label:"Add worklog",icon:"fa fa-clock-o",command:function(){return n.addWorklogOn(n.selectedTicket.ticketNo)}},{label:"Delete Bookmark",icon:"fa fa-trash-o",command:function(){return n.deleteBookmark(n.selectedTicket.ticketNo)}}],n.state.selAllBks=!1,n.state.bookmarksList=[],n}return Object(u.a)(a,[{key:"selectTicket",value:function(e){e.selected=!e.selected;var t=this.state.bookmarksList;t=Object(r.a)(t),this.setState({bookmarksList:t})}},{key:"UNSAFE_componentWillMount",value:function(){this.refreshData()}},{key:"showContext",value:function(e,t){this.selectedTicket=t,Object(W.showContextMenu)(e,this.contextMenu)}},{key:"deleteBookmark",value:function(e){var t,a=this;0!==(t=e?[e]:this.state.bookmarksList.filter((function(e){return e.selected})).map((function(e){return e.ticketNo}))).length?de.b.confirmDelete("Are you sure to delete the selected bookmark(s)?","Confirm delete bookmark(s)").then((function(){a.setState({isLoading:!0}),a.$bookmark.removeBookmark(t).then((function(e){a.setState({bookmarksList:e,isLoading:!1})}))})):this.$message.info("Select the bookmarks to be deleted!")}},{key:"executeEvent",value:function(e){e.type===n.a.TicketBookmarked?this.refreshData():Object(g.a)(Object(f.a)(a.prototype),"executeEvent",this).call(this,e)}},{key:"renderCustomActions",value:function(){var e=this;return v.a.createElement(v.a.Fragment,null,v.a.createElement(M.b,{icon:"fa fa-plus",onClick:this.showAddPopup,title:"Add ticket to bookmarks"}),v.a.createElement(M.b,{type:"danger",icon:"fa fa-trash-o",onClick:function(){return e.deleteBookmark()},title:"Remove selected ticket(s) from bookmarks"}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.bookmarksList,r=t.selAllChk,o=t.showAddPopup;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement(v.a.Fragment,null,v.a.createElement(z.c,{dataset:n,exportSheetName:"My bookmarks"},v.a.createElement(z.e,null,v.a.createElement("tr",null,v.a.createElement(z.a,{className:"w40",noExport:!0},v.a.createElement(M.c,{checked:r,onChange:this.selectAll})),v.a.createElement(z.a,{sortBy:"ticketNo"},"Ticket No"),v.a.createElement(z.a,{sortBy:"issuetype"},"Type"),v.a.createElement(z.a,{sortBy:"summary"},"Summary"),v.a.createElement(z.a,{sortBy:"assigneeName"},"Assignee"),v.a.createElement(z.a,{sortBy:"reporter"},"Reporter"),v.a.createElement(z.a,{sortBy:"priority"},"Priority"),v.a.createElement(z.a,{sortBy:"status"},"Status"),v.a.createElement(z.a,{sortBy:"resolution"},"Resolution"),v.a.createElement(z.a,{sortBy:"createdSortable"},"Created"),v.a.createElement(z.a,{sortBy:"updatedSortable"},"Updated"))),v.a.createElement(z.d,null,(function(t,a){return v.a.createElement("tr",{key:t.ticketNo,onContextMenu:function(a){return e.showContext(a,t)},className:t.rowClass},v.a.createElement("td",{className:"text-center"},t.selected&&v.a.createElement(M.c,{checked:!0,onChange:function(){return e.selectTicket(t)}}),!t.selected&&v.a.createElement("i",{className:"fa fa-ellipsis-v",onClick:function(a){return e.showContext(a,t)}})),v.a.createElement("td",null,v.a.createElement("a",{href:t.ticketUrl,rel:"noopener noreferrer",className:"link strike",target:"_blank"},t.ticketNo)),v.a.createElement("td",null,t.issuetypeIcon&&v.a.createElement(M.f,{src:t.issuetypeIcon}),t.issuetype),v.a.createElement("td",null,t.summary),v.a.createElement("td",null,t.assigneeName),v.a.createElement("td",null,t.reporterName),v.a.createElement("td",null,t.priorityIcon&&v.a.createElement(M.f,{src:t.priorityIcon}),t.priority),v.a.createElement("td",null,t.statusIcon&&v.a.createElement(M.f,{src:t.statusIcon}),t.status),v.a.createElement("td",null,t.resolutionIcon&&v.a.createElement(M.f,{src:t.resolutionIcon}),t.resolution),v.a.createElement("td",null,t.created),v.a.createElement("td",null,t.updated))})),v.a.createElement(z.b,{span:11},"You have not yet bookmarked any tickets. Bookmark your frequently used tickets")),o&&v.a.createElement(ue,{onHide:this.hideAddPopup})))}}]),a}(b.b),pe=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e,"My open tickets","fa-eye")).refreshData=function(e){n.setState({isLoading:!0}),n.$jira.getOpenTickets(e).then((function(e){var t=e.map((function(e){var t=e.fields;return{ticketNo:e.key,ticketUrl:n.$userutils.getTicketUrl(e.key),issuetypeIcon:(t.issuetype||{}).iconUrl,issuetype:(t.issuetype||{}).name,summary:t.summary,reporter:(t.reporter||{}).displayName,priorityIcon:(t.priority||{}).iconUrl,priority:(t.priority||{}).name,statusIcon:(t.status||{}).iconUrl,status:(t.status||{}).name,resolutionIcon:(t.resolution||{}).iconUrl,resolution:(t.resolution||{}).name,createdSortable:t.created,updatedSortable:t.updated,created:n.$userutils.formatDateTime(t.created),updated:n.$userutils.formatDateTime(t.updated)}}));n.setState({ticketList:t,isLoading:!1})}))},n.bookmarkAdded=function(){return n.performAction(b.a.TicketBookmarked)},Object(E.a)(Object(d.a)(n),"JiraService","BookmarkService","UserUtilsService"),n.state.isLoading=!0,n.state.ticketList=[],n}return Object(u.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){this.refreshData()}},{key:"render",value:function(){var e=this,t=this.state.ticketList;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement(z.c,{dataset:t,exportSheetName:"My open tickets"},v.a.createElement(z.e,null,v.a.createElement("tr",null,v.a.createElement(z.a,{sortBy:"ticketNo"},"Ticket No"),v.a.createElement(z.a,{sortBy:"issuetype"},"Type"),v.a.createElement(z.a,{sortBy:"summary"},"Summary"),v.a.createElement(z.a,{sortBy:"reporter"},"Reporter"),v.a.createElement(z.a,{sortBy:"priority"},"Priority"),v.a.createElement(z.a,{sortBy:"status"},"Status"),v.a.createElement(z.a,{sortBy:"resolution"},"Resolution"),v.a.createElement(z.a,{sortBy:"createdSortable"},"Created"),v.a.createElement(z.a,{sortBy:"updatedSortable"},"Updated"))),v.a.createElement(z.d,null,(function(t,a){return v.a.createElement(ge,{key:a,ticket:t,onAddWorklog:e.addWorklogOn,onBookmark:e.bookmarkAdded})})),v.a.createElement(z.b,{span:9},"No open tickets were assigned to you. Enjoy your day!")))}},{key:"showContext",value:function(e,t){this.selectedTicket=t,Object(W.showContextMenu)(e,this.contextMenu)}}]),a}(b.b),ge=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).setRef=function(t){return e.keyCtr=t},e}return Object(u.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.ticket,n=t.onAddWorklog,r=t.onBookmark;return v.a.createElement("tr",{onContextMenu:function(t){return e.keyCtr.showContext(t)}},v.a.createElement(G.i,{ref:this.setRef,value:a.ticketNo,onAddWorklog:n,onBookmark:r}),v.a.createElement("td",null,v.a.createElement(M.f,{src:a.issuetypeIcon}),a.issuetype),v.a.createElement("td",null,a.summary),v.a.createElement("td",null,a.reporter),v.a.createElement("td",null,v.a.createElement(M.f,{src:a.priorityIcon}),a.priority),v.a.createElement("td",null,v.a.createElement(M.f,{src:a.statusIcon}),a.status),v.a.createElement("td",null,a.resolutionIcon&&v.a.createElement(M.f,{src:a.resolutionIcon}),a.resolution),v.a.createElement("td",null,a.created),v.a.createElement("td",null,a.updated))}}]),a}(h.PureComponent),fe=pe,he=a(75),ve=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e,"My Reports","fa-filter")).refreshData=function(){n.setState({isLoading:!0}),n.$report.getReportsList().then((function(e){var t=n.state.selAllChk;e.forEach((function(e){e.selected=t,e.displayDate=n.$userutils.formatDateTime(e.dateCreated),e.sortDate=e.dateCreated.getTime()})),n.setState({reportsList:e,isLoading:!1})}))},n.deleteSelectedReports=function(){var e=n.state.reportsList.filter((function(e){return e.selected})).map((function(e){return e.id}));0!==e.length?de.b.confirmDelete("Are you sure to delete the selected report(s)?","Confirm delete report(s)").then((function(){n.setState({isLoading:!0}),n.$report.deleteSavedQuery(e).then((function(){return n.refreshData()}))})):n.$message.info("Select the reports to be deleted!")},n.selectAll=function(){var e=n.state,t=e.reportsList,a=e.selAllChk;a=!a,t.forEach((function(e){return e.selected=a})),t=Object(r.a)(t),n.setState({reportsList:t,selAllChk:a,selReportsCount:a?t.length:null})},n.downloadReports=function(){var e=n.state.reportsList.filter((function(e){return e.selected})).map((function(e){return e.id}));0!==e.length?n.$report.exportQueries(e):n.$message.info("Select the reports to be exported!")},n.fileSelected=function(){var e=n.fileSelector,t=e.files[0];if(t){if(!t.name.endsWith(".jrd"))return n.$message.warning("Unknown file selected to import. Select a valid Jira Assist Report definition (*.jrd) file"),void(e.value="");var a=new FileReader;a.readAsText(t,"UTF-8"),a.onload=function(e){var t=e.target.result;try{var a=JSON.parse(t).reports;if(!a||!Array.isArray(a))return void n.$message.error("Selected file is invalid or is corrupted");a.forEach((function(e){e.oldName=e.queryName,e.selected=!0,e.status="Will import"})),n.setState({reportsToImport:a})}catch(r){n.$message.error("Selected file is invalid or is corrupted")}},a.onerror=function(e){n.$message.error("Selected file is invalid or is corrupted. Unable to load the file!")}}e.value=""},n.editReport=function(e){n.context.navigate("/reports/".concat(e.advanced?"advanced":e.isNew?"custom":"customgrouped","/").concat(e.id),!0)},n.hideImportPopup=function(e){e&&n.refreshData(),n.setState({reportsToImport:null})},n.setFileSelector=function(e){return n.fileSelector=e},n.chooseFileForImport=function(){return n.fileSelector.click()},Object(E.a)(Object(d.a)(n),"ReportService","MessageService","UserUtils"),n.state.isLoading=!0,n}return Object(u.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){this.refreshData()}},{key:"selectRowItem",value:function(e){e.selected=!e.selected;var t=this.state.reportsList,a=(t=Object(r.a)(t)).count((function(e){return e.selected}));this.setState({reportsList:t,selReportsCount:a})}},{key:"renderCustomActions",value:function(){return v.a.createElement(v.a.Fragment,null,v.a.createElement("input",{ref:this.setFileSelector,type:"file",className:"hide",accept:".jrd",onChange:this.fileSelected}),v.a.createElement(M.b,{icon:"fa fa-upload",onClick:this.chooseFileForImport,title:"Import reports shared by others"}),v.a.createElement(M.b,{icon:"fa fa-download",disabled:!this.state.selReportsCount,onClick:this.downloadReports,title:"Export reports to share with others"}),v.a.createElement(M.b,{type:"danger",icon:"fa fa-trash-o",onClick:this.deleteSelectedReports,title:"Delete selected report(s)"}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.reportsList,r=t.selAllChk,o=t.reportsToImport;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement(v.a.Fragment,null,v.a.createElement(z.c,{dataset:n,exportSheetName:"My reports"},v.a.createElement(z.e,null,v.a.createElement("tr",null,v.a.createElement(z.a,{className:"w40"},v.a.createElement(M.c,{checked:r,onChange:this.selectAll})),v.a.createElement(z.a,{sortBy:"queryName"},"Report name"),v.a.createElement(z.a,{sortBy:"sortDate"},"Created On"),v.a.createElement(z.a,{sortBy:"advanced"},"Report type"),v.a.createElement(z.a,{sortBy:"outputCount"},"Output fields"),v.a.createElement(z.a,null,"Options"))),v.a.createElement(z.d,null,(function(t){return v.a.createElement("tr",{key:t.id},v.a.createElement("td",{className:"text-center"},v.a.createElement(M.c,{checked:t.selected,onChange:function(){return e.selectRowItem(t)}})),v.a.createElement("td",null,t.queryName),v.a.createElement("td",null,t.displayDate),v.a.createElement("td",null,t.advanced?"Advanced report":"Custom Report".concat(t.isNew?"":" (old)")),v.a.createElement("td",null,t.outputCount),v.a.createElement("td",{className:"text-center"},v.a.createElement(M.b,{icon:"fa fa-edit",onClick:function(){return e.editReport(t)},title:"Click to edit this report"})))})),v.a.createElement(z.b,{span:7},"You have not yet created or imported any reports.")),o&&v.a.createElement(ye,{reportsToImport:o,onHide:this.hideImportPopup})))}}]),a}(b.b);ve.contextType=he.a;var ke=ve,ye=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e,"Select reports to import")).selectAllReports=function(){var e=n.state,t=e.selectAll,a=e.reportsToImport;t=!t,(a=Object(r.a)(a)).forEach((function(e){e.selected=!e.disabled&&t,n.updateReportStatus(e)})),n.setState({selectAll:t,reportsToImport:a,selReportsCount:n.getReportsCount(a)})},n.getReportsCount=function(e){return(e||n.state.reportsToImport).filter((function(e){return e.selected})).length},n.importReports=function(){var e=n.state.reportsToImport.filter((function(e){return e.selected})),t=e.map((function(e){var t=Object(l.a)({},e);return delete t.selected,delete t.id,delete t.oldName,delete t.status,n.$report.saveQuery(t).then((function(t){return e.selected=!1,e.disabled=!0,e.status="Imported",!0}),(function(){return e.status="Duplicate name",!1}))}));Promise.all(t).then((function(t){if(t.all((function(e){return e})))n.$message.success("".concat(e.length," selected reports were imported"),"Reports imported"),n.onHide(!0);else{n.$message.error("Some of the reports were not import!","Import failed");var a=n.state.reportsToImport;a=Object(r.a)(a),n.setState({selReportsCount:n.getReportsCount(a),reportsToImport:a})}}))},Object(E.a)(Object(d.a)(n),"UserUtilsService","MessageService","ReportService"),n.style={width:"850px"},n.state.selectAll=!0,n.state.reportsToImport=n.props.reportsToImport,n.state.selReportsCount=n.getReportsCount(),n}return Object(u.a)(a,[{key:"reportSelected",value:function(e){e.selected=!e.selected,this.updateReportStatus(e),this.setState({selReportsCount:this.getReportsCount()})}},{key:"updateReportStatus",value:function(e){e.selected?(e.queryName||(e.queryName=e.oldName),e.status="Will import"):e.status="Excluded"}},{key:"reportNameChanged",value:function(e,t){e.queryName=t,e.queryName?e.status="Will import":e.status="Name required",this.forceUpdate()}},{key:"getFooter",value:function(){var e=this.state.selReportsCount;return v.a.createElement(v.a.Fragment,null,v.a.createElement(M.b,{icon:"fa fa-times",onClick:this.onHide,label:"Cancel",type:"default"}),v.a.createElement(M.b,{icon:"fa fa-check",disabled:!e,onClick:this.importReports,label:"Import",type:"primary"}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.reportsToImport,r=t.selectAll;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement("div",null,v.a.createElement(z.c,{dataset:n},v.a.createElement("caption",null,"Select all the reports which you would like to import and provide a name for the report to import."),v.a.createElement(z.e,null,v.a.createElement("tr",null,v.a.createElement("th",{className:"no-min-width no-pad"},v.a.createElement(M.c,{checked:r,onChange:this.selectAllReports})),v.a.createElement("th",null,"Report name"),v.a.createElement("th",null,"Report name (new)"),v.a.createElement("th",null,"Created date"),v.a.createElement("th",null,"Last modified date"),v.a.createElement("th",null,"Status"))),v.a.createElement(z.d,null,(function(t,a){return v.a.createElement("tr",{key:"".concat(a,"_").concat(t.status)},v.a.createElement("td",{className:"data-center"},v.a.createElement(M.c,{checked:t.selected,disabled:t.disabled,onChange:function(a){return e.reportSelected(t,a)}})),v.a.createElement("td",null,t.oldName),v.a.createElement("td",null,v.a.createElement(M.j,{value:t.queryName,disabled:t.disabled||!t.selected,onChange:function(a){return e.reportNameChanged(t,a)}})),v.a.createElement("td",null,e.$userutils.formatDateTime(t.dateCreated)),v.a.createElement("td",null,e.$userutils.formatDateTime(t.dateUpdated)),v.a.createElement("td",null,t.status))})))))}}]),a}(I.a),be=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e,"Worklog - [Pending upload]","fa-clock-o")).refreshData=function(){return n.setState({isLoading:!0}),n.$worklog.getPendingWorklogs().then((function(e){var t=n.state.selAllChk;e.forEach((function(e){e.ticketUrl=n.$userutils.getTicketUrl(e.ticketNo),e.rowClass=n.$utils.getRowStatus(e),e.displayDate=n.$userutils.formatDateTime(e.dateStarted),e.selected=t,e.timeSpent=n.$utils.formatTs(e.timeSpent),e.overrideTimeSpent=n.$utils.formatTs(e.overrideTimeSpent)})),n.setState({isLoading:!1,worklogs:e})}))},n.selectAll=function(e){var t=n.state.worklogs;t.forEach((function(t){return t.selected=e})),n.setState({worklogs:Object(r.a)(t),selAllChk:e})},Object(E.a)(Object(d.a)(n),"WorklogService","UtilsService","UserUtilsService","MessageService"),n.contextMenu=[{label:"Select worklog",icon:"fa fa-check-square-o",command:function(){return n.selectRowItem(n.selectedItem)}},{label:"Edit worklog",icon:"fa fa-edit",command:function(){return n.editWorklogObj()}},{label:"Copy worklog",icon:"fa fa-copy",command:function(){return n.editWorklogObj(!0)}},{label:"Upload worklog",icon:"fa fa-upload",command:function(){return n.uploadWorklog([n.selectedItem])}},{label:"Delete worklog",icon:"fa fa-trash-o",command:function(){return n.deleteWorklog([n.selectedItem])}}],n.state.selAllChk=!0,n.state.isLoading=!0,n}return Object(u.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){this.refreshData()}},{key:"editWorklogObj",value:function(e){var t=Object.create(this.selectedItem);t.copy=e,this.addWorklog(t)}},{key:"showContext",value:function(e,t){this.selectedItem=t,Object(W.showContextMenu)(e,this.contextMenu)}},{key:"uploadWorklog",value:function(e){var t=this;e||(e=this.state.worklogs.filter((function(e){return e.selected})));var n=e.map((function(e){return e.id}));0!==n.length?(this.setState({isLoading:!0}),this.$worklog.uploadWorklogs(n).then((function(e){t.setState({isLoading:!1,worklogs:e}),Object(g.a)(Object(f.a)(a.prototype),"performAction",t).call(t,b.a.WorklogModified)}),(function(e){e&&e.$message&&t.$message.warning(e.message),t.refreshData()}))):this.$message.info("Select the worklogs to be uploaded!")}},{key:"deleteWorklog",value:function(e){var t=this;e||(e=this.state.worklogs.filter((function(e){return e.selected})));var a=e.map((function(e){return e.id}));0!==a.length?de.b.confirmDelete("Are you sure to delete the selected worklog(s)?","Confirm delete worklog(s)").then((function(){t.setState({isLoading:!0}),t.$worklog.deleteWorklogs(a).then((function(e){t.refreshData(),t.performAction(b.a.DeletedWorklog)}))})):this.$message.info("Select the worklogs to be deleted!")}},{key:"executeEvent",value:function(e){e.type===b.a.AddWorklog||e.type===b.a.DeletedWorklog||e.type===b.a.WorklogModified?this.refreshData():Object(g.a)(Object(f.a)(a.prototype),"executeEvent",this).call(this,e)}},{key:"selectRowItem",value:function(e){e.selected=!e.selected;var t=this.state.worklogs;this.setState({worklogs:Object(r.a)(t)})}},{key:"renderCustomActions",value:function(){var e=this;return v.a.createElement(v.a.Fragment,null,v.a.createElement(M.b,{icon:"fa fa-upload",onClick:function(){return e.uploadWorklog()},title:"Upload selected worklogs"}),v.a.createElement(M.b,{type:"danger",icon:"fa fa-trash-o",onClick:function(){return e.deleteWorklog()},title:"Delete selected worklogs"}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.worklogs,r=t.selAllChk;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement(z.c,{dataset:n,exportSheetName:"Pending worklogs"},v.a.createElement(z.e,null,v.a.createElement("tr",null,v.a.createElement(z.a,{className:"w40",noExport:!0},v.a.createElement(M.c,{checked:r,onChange:this.selectAll})),v.a.createElement(z.a,{sortBy:"ticketNo"},"Ticket No"),v.a.createElement(z.a,{sortBy:"summary"},"Summary"),v.a.createElement(z.a,{sortBy:"dateStarted"},"Log Time"),v.a.createElement(z.a,{sortBy:"timeSpent"},"Time Spent"),v.a.createElement(z.a,{sortBy:"overrideTimeSpent"},"Override Time"),v.a.createElement(z.a,null,"Description"))),v.a.createElement(z.d,null,(function(t){return v.a.createElement("tr",{key:t.id,onContextMenu:function(a){return e.showContext(a,t)},className:t.rowClass},v.a.createElement("td",{className:"text-center"},t.selected&&v.a.createElement(M.c,{checked:!0,onChange:function(){return e.selectRowItem(t)}}),!t.selected&&v.a.createElement("i",{className:"fa fa-ellipsis-v",onClick:function(a){return e.showContext(a,t)}})),v.a.createElement("td",null,v.a.createElement("a",{href:t.ticketUrl,rel:"noopener noreferrer",className:"link strike",target:"_blank"},t.ticketNo)),v.a.createElement("td",null,t.summary),v.a.createElement("td",null,t.displayDate),v.a.createElement("td",null,t.timeSpent),v.a.createElement("td",null,t.overrideTimeSpent),v.a.createElement("td",null,t.description))})),v.a.createElement(z.b,{span:7},"No worklog pending to be uploaded!")))}}]),a}(b.b),Ee=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e,"Ticketwise worklog","fa-list-alt")).refreshData=function(){var e=n.settings.dateRange;e&&e.fromDate&&(n.setState({isLoading:!0}),e.dateWise=!1,n.$worklog.getWorklogs(e).then((function(e){e.forEach((function(e){e.rowClass=n.$utils.getRowStatus(e),e.ticketUrl=n.$userutils.getTicketUrl(e.ticketNo),e.totalHours=n.$utils.formatTs(e.totalHours),e.uploaded=n.$utils.formatTs(e.uploaded),e.pendingUpload=n.$utils.formatTs(e.pendingUpload)})),n.setState({isLoading:!1,worklogs:e})})))},n.dateSelected=function(e){n.settings.dateRange=e,e.toDate&&(n.refreshData(),e.auto||n.saveSettings())},Object(K.b)(Object(d.a)(n),"WorklogService","UserUtilsService","UtilsService"),n.contextMenu=[{label:"Upload worklog",icon:"fa fa-clock-o",command:function(){return n.uploadWorklog()}},{label:"Add worklog",icon:"fa fa-bookmark",command:function(){return n.addWorklog()}}],n}return Object(u.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){this.refreshData()}},{key:"showContext",value:function(e,t){this.selectedTicket=t,Object(W.showContextMenu)(e,this.contextMenu)}},{key:"renderCustomActions",value:function(){return v.a.createElement(M.e,{range:!0,value:this.settings.dateRange,onChange:this.dateSelected,style:{marginRight:"35px"}})}},{key:"getWorklogUrl",value:function(e,t){return this.$userutils.getWorklogUrl(e,t)}},{key:"getTicketUrl",value:function(e){return this.$userutils.getTicketUrl(e)}},{key:"uploadWorklog",value:function(){var e=this,t=this.selectedTicket.logData.filter((function(e){return!e.worklogId})).map((function(e){return e.id}));t.length&&(this.setState({isLoading:!0}),this.$worklog.uploadWorklogs(t).then((function(){e.refreshData(),Object(g.a)(Object(f.a)(a.prototype),"performAction",e).call(e,n.a.WorklogModified)}),(function(t){e.setState({isLoading:!1})})))}},{key:"addWorklog",value:function(){var e=this.selectedTicket.ticketNo,t=j().subtract(1,"hours").toDate();Object(g.a)(Object(f.a)(a.prototype),"addWorklog",this).call(this,{ticketNo:e,startTime:t,timeSpent:"01:00",allowOverride:!0})}},{key:"render",value:function(){var e=this,t=this.state.worklogs;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement(z.c,{dataset:t,exportSheetName:"Ticketwise worklog"},v.a.createElement(z.e,null,v.a.createElement("tr",null,v.a.createElement(z.a,{sortBy:"ticketNo",style:{width:"100px"}},"Ticket No"),v.a.createElement(z.a,{sortBy:"summary"},"Summary"),v.a.createElement(z.a,{sortBy:"totalHours"},"Total Hours"),v.a.createElement(z.a,{sortBy:"uploaded"},"Uploaded"),v.a.createElement(z.a,{sortBy:"pendingUpload"},"Pending Upload"),v.a.createElement(z.a,{sortBy:"parentKey"},"Parent Ticket"),v.a.createElement(z.a,null,"Dates Logged"),v.a.createElement(z.a,{style:{width:"400px"}},"Description"))),v.a.createElement(z.d,null,(function(t){return v.a.createElement("tr",{key:t.ticketNo,onContextMenu:function(a){return e.showContext(a,t)},className:t.rowClass},v.a.createElement("td",null,v.a.createElement("a",{href:t.ticketUrl,rel:"noopener noreferrer",className:"link strike",target:"_blank"},t.ticketNo)),v.a.createElement("td",null,t.summary),v.a.createElement("td",null,t.totalHours),v.a.createElement("td",null,t.uploaded),v.a.createElement("td",null,t.pendingUpload),v.a.createElement("td",null,t.parentKey?"".concat(t.parentKey," - ").concat(t.parentSumm):""),v.a.createElement("td",null,v.a.createElement("ul",{className:"tags"},t.logData.map((function(a,n){return v.a.createElement("li",{key:n},a.worklogId&&v.a.createElement("a",{className:"link badge badge-pill skin-bg-font",href:e.getWorklogUrl(t.ticketNo,a.worklogId),target:"_blank",rel:"noopener noreferrer",title:a.comments},v.a.createElement("span",{className:"fa fa-clock-o"}),"  ",v.a.createElement(G.b,{tag:"span",value:a.dateLogged}),": ",a.uploaded),!a.worklogId&&v.a.createElement("span",{className:"link badge badge-pill skin-bg-font",onClick:function(){return e.editWorklog(a.id)},title:a.comments},v.a.createElement("span",{className:"fa fa-clock-o"})," ",v.a.createElement(G.b,{tag:"span",value:a.dateLogged}),": ",a.uploaded))})))),v.a.createElement("td",null,t.description))})),v.a.createElement(z.b,{span:8},"No records exists")))}}]),a}(b.b),we=[{id:"myOpenTickets",icon:"fa-eye",name:"My Open Tickets",details:"Contains the list of open tickets assigned to you"},{id:"myBookmarks",icon:"fa-bookmark",name:"Bookmarks",details:"List of bookmarked tickets"},{id:"dateWiseWorklog",icon:"fa-list-alt",name:"Logged Work - [Daywise]",details:"List of worklog's grouped by date"},{id:"pendingWorklog",icon:"fa-clock-o",name:"Worklog - [Pending Upload]",details:"Worklog's still pending for upload"},{id:"ticketWiseWorklog",icon:"fa-list-alt",name:"Logged Work - [Ticketwise]",details:"List of worklog's grouped by ticket"},{id:"myFilters",icon:"fa-filter",name:"My Reports",details:"List of custom & advanced report built / imported by you"},{id:"agendaDay",icon:"fa-calendar",name:"Current day calendar",details:"Display calendar for current date for worklog and meetings"},{id:"agendaWeek",icon:"fa-calendar",name:"Current week calendar",details:"Display calendar for current week for worklog and meetings"},{id:"sWiseTSpent",icon:"fa-list-alt",name:"Status Wise Time Spent",details:"Provides summary of time spent on each ticket on individual status"}]},272:function(e,t,a){},273:function(e,t,a){},275:function(e,t,a){},331:function(e,t,a){},332:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(54);function r(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=Object(n.a)(e))){var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw o}}}}},356:function(e,t,a){"use strict";var n=a(5),r=a(6),o=a(46),i=a(243),s=a(37),l=a(15),c=a(16),u=a(2),d=a.n(u),m=a(244),p=a(9),g=a(245),f=(a(331),a(1)),h=a(10),v=a(253),k=a(255),y=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var r;Object(n.a)(this,a);var i=e.definition;return i=i||{},(r=t.call(this,e,i.queryName||"Custom report viewer (deprecated)","fa-clock-o")).refreshData=function(){r.props.reportId>0?r.$report.getReportDefinition(r.props.reportId).then((function(e){r.setState({reportDefinition:e},r.fillReport)})):r.state.reportDefinition&&r.fillReport()},r.fillReport=function(){var e=r.state.reportDefinition||{};e&&(r.title="".concat(e.queryName," (deprecated)")),e.jql&&e.outputFields&&e.outputFields.length&&(r.setState({isLoading:!0}),r.dataFields=e.outputFields.map((function(e){return e.id})),r.$jira.searchTickets(e.jql,r.dataFields).then((function(t){r.headerFields=e.outputFields.map((function(e){var t=e.name;return e.functions&&e.functions.header&&(t=e.functions.header.replace("{0}",t)),{text:t,rowspan:2}})),r.processIssues(t);var a=r.headerFields,n=[];r.headerFields.filter((function(e){return e.subCols&&e.subCols.length>0})).forEach((function(e){n.addRange(e.subCols),n.push({text:"Total"}),e.colspan=e.subCols.length+1,e.rowspan=1}));var o=e.outputFields.filter((function(e){return e.groupBy})),i=o.length>0?r.groupData(t,Array.from(o)):t;r.dataFields=e.outputFields.filter((function(e){return!e.groupBy})),r.reportHtml=r.genHtmlRow(i);var s=i.length>0;r.setState({subFields:n,hasReportData:s,displayFields:a,isLoading:!1}),r.$analytics.trackEvent("Custom report viewed",f.i.UserActions)})))},r.addWorklog=function(e){var t={ticketNo:e};r.setState({showWorklogPopup:!0,worklogItem:t})},r.hideWorklog=function(){r.setState({showWorklogPopup:!1})},Object(p.a)(Object(o.a)(r),"AnalyticsService","ReportService","JiraService","UtilsService","UserUtilsService"),r.state.reportDefinition=i,r}return Object(r.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){this.refreshData()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){(e.definition&&e.definition!==this.state.reportDefinition||e.reportId)&&this.setState({reportDefinition:e.definition},this.refreshData)}},{key:"genHtmlRow",value:function(e,t){for(var a=this,n=function(e,n,r,o){var i=[];t&&0===e&&0===n&&i.addRange(t),0===n&&r.issues&&i.push(a.getGroupedTD(r.name,o.length));for(var s=o[n],l=s.fields,c=function(e){var t=a.dataFields[e];if(t.functions&&t.functions.useArray)0===n&&("issuekey"===t.id?i.push(a.getAggregateTD(o.map((function(e){return e.key})),t.functions)):i.push(a.getAggregateTD(o.map((function(e){return e.fields[t.id]})),t.functions)));else if("worklog"===t.id){for(var r=a.fieldOpts.worklogUsers,c=l.worklogs_proc,u=0,d=0;d<r.length;d++)if(c){var m=c[r[d].id];m?(u+=m.timespent,i.push(a.getTD(m.timespent,t.functions))):i.push(a.getTD())}else i.push(a.getTD("#Error"));u?i.push(a.getTD(u,t.functions)):i.push(a.getTD())}else"issuekey"===t.id?i.push(a.getIssueKeyTD(s.key,t.functions)):i.push(a.getTD(l[t.id],t.functions))},u=0;u<a.dataFields.length;u++)c(u);return i},r=[],o=0;o<e.length;o++){var i=e[o];if(i.subGroups){var s=this.getGroupedTD(i.name,i.issueCount);r.addRange(this.genHtmlRow(i.subGroups,0===o?[t,s]:[s]))}else for(var l=i.issues||[i],c=0;c<l.length;c++)r.push(d.a.createElement("tr",null,n(o,c,i,l)))}return r}},{key:"getTD",value:function(e,t){return e?d.a.createElement("td",null,this.execute(e,t)):d.a.createElement("td",null,"\xa0")}},{key:"getIssueKeyTD",value:function(e,t){return"string"===typeof e?d.a.createElement(v.i,{value:e,onAddWorklog:this.addWorklog}):this.getTD(e,t)}},{key:"getAggregateTD",value:function(e,t){return d.a.createElement("td",{className:"bold",rowSpan:e.length},this.execute(e,t))}},{key:"getGroupedTD",value:function(e,t){e||(e="<No Value>"),e+=" (".concat(t,")");var a=t>4||e.length/t<2.5;return d.a.createElement("td",{className:a?"rotateM90":"bold",rowSpan:t},"\xa0",d.a.createElement("div",null,e))}},{key:"groupData",value:function(e,t){var a=this;if(!t||!t.length)return e;var n=t[0],r=n.id,o=n.functions;t.removeAt(0);var i=o.useArray,s=function(e){var n={name:e.key},r=e.values;return t.length>0?(n.subGroups=a.groupData(r,Array.from(t)),n.issueCount=n.subGroups.sum((function(e){return e.issueCount}))):(n.issues=r,n.issueCount=n.issues.length),n};if(i){var l=e.map("issuekey"===r?function(e){return e.key}:function(e){return e.fields[r]},!0);return[s({key:this.execute(l,o),values:e})]}return e.groupBy((function(e){var t=e.fields[r];return t?a.execute(t,o):t})).map((function(e){return s(e)}))}},{key:"execute",value:function(e,t){if(!e||!t||!t.name)return e;var a="#Error";try{var n=this.$utils,r=this.$utils[t.name];if(r&&r.apply||(r=this.$userutils[t.name],n=this.$userutils),r&&r.apply||(r=b[t.name],n=e),!r||!r.apply)return"#Error: Func not found";var o=[e].addRange(t.params);a=r.apply(n,o)}catch(i){console.error(i)}return null!==a?a:""}},{key:"processIssues",value:function(e){var t=this.dataFields.indexOf("worklog");if(-1!==t){var a=[],n=[];this.fieldOpts={};for(var r=0;r<e.length;r++){var o=e[r].fields;if(o.worklog&&o.worklog.worklogs.length>0){for(var i=o.worklog.worklogs.groupBy((function(e){return{id:Object(h.e)(e.author),text:e.author.displayName}})),s={},l=0;l<i.length;l++){var c=i[l],u=c.key.id;-1===n.indexOf(u)&&(a.push(c.key),n.push(u)),s[u]={timespent:c.values.sum((function(e){return e.timeSpentSeconds}))}}o.worklogs_proc=s}else o.worklog&&o.worklog.worklogs&&0===o.worklog.worklogs.length&&(o.worklogs_proc={})}var d=this.headerFields[t];d.subCols=a.orderBy((function(e){return e.text})),this.fieldOpts.worklogUsers=d.subCols}}},{key:"render",value:function(){var e=this.reportHtml,t=this.state,n=t.isLoading,r=t.hasReportData,o=t.displayFields,l=t.subFields,c=t.showWorklogPopup,u=t.worklogItem;return Object(i.a)(Object(s.a)(a.prototype),"renderBase",this).call(this,d.a.createElement("div",{className:"cust-report-viewer"},r&&d.a.createElement(g.c,null,d.a.createElement(g.e,null,d.a.createElement("tr",{className:"data-center"},o.map((function(e,t){return d.a.createElement("th",{key:t,rowSpan:e.rowspan,colSpan:e.colspan},e.text)}))),!!l&&l.length>0&&d.a.createElement("tr",{className:"data-center"},l.map((function(e,t){return d.a.createElement("th",{key:t},e.text)})))),!r&&!n&&d.a.createElement("tbody",null,d.a.createElement("tr",null,d.a.createElement("td",{colSpan:o&&o.length},"No records exists"))),r&&d.a.createElement("tbody",null,e)),c&&d.a.createElement(k.a,{worklog:u,onDone:this.hideWorklog,onHide:this.hideWorklog})))}}]),a}(m.b);t.a=y;var b={last:function(e){return null!==e&&void 0!==e&&e.length?e[e.length-1]:null},first:function(e){return null!==e&&void 0!==e&&e.length?e[0]:null}}},357:function(e,t,a){"use strict";var n=a(5),r=a(6),o=a(46),i=a(243),s=a(37),l=a(15),c=a(16),u=a(2),d=a.n(u),m=a(244),p=a(35),g=a(242),f=a(32),h=a(274),v=(a(358),a(255)),k=a(1),y=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var r;Object(n.a)(this,a),(r=t.call(this,e,"Advanced report viewer","fa-clock-o")).usersSelected=function(e){r.parameterEvent.onChange(r.parameterEvent.definition,e),r.parameterEvent=null,r.setState({showGroupsPopup:!1,groups:e})},r.refreshData=function(){r.props.reportId>0?r.$report.getReportDefinition(r.props.reportId).then((function(e){r.setReportDefinition(e),r.$analytics.trackEvent("Advanced report viewed",k.i.UserActions)})):r.state.definition&&(r.title=r.state.definition.queryName,r.$analytics.trackEvent("Advanced report viewed",k.i.UserActions))},r.getApi=function(e){return r.viewer=e},r.worklogAdded=function(e){r.hideWorklog()},r.hideWorklog=function(){r.setState({showWorklogPopup:!1})},Object(p.b)(Object(o.a)(r),"ReportConfigService","AnalyticsService","ReportService"),r.viewer={},r.$reportConfig.configureViewer(),r.$reportConfig.parameters.removeAllListeners(),r.$reportConfig.parameters.on("click",r.parameterClicked.bind(Object(o.a)(r))),r.$reportConfig.eventPipe.on("addWorklog",r.addWorklog.bind(Object(o.a)(r)));var i=e.definition;return r.state.definition=i,r}return Object(r.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){this.refreshData()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.definition?this.setReportDefinition(e.definition):e.reportId?this.refreshData():this.setReportDefinition({})}},{key:"addWorklog",value:function(e){this.isGadget?Object(i.a)(Object(s.a)(a.prototype),"addWorklog",this).call(this,e):(this.worklogItem=e,this.setState({showWorklogPopup:!0}))}},{key:"parameterClicked",value:function(e){this.parameterEvent=e,this.setState({showGroupsPopup:!0})}},{key:"setReportDefinition",value:function(e){e&&e.queryName&&(this.title=e.queryName),this.setState({definition:e})}},{key:"renderCustomActions",value:function(){return d.a.createElement(d.a.Fragment,null,!this.isGadget&&d.a.createElement(g.b,{icon:this.isFullScreen?"fa fa-compress":"fa fa-expand",onClick:this.toggleFullScreen,title:"Toggle full screen"}),this.viewer.canShowParams&&d.a.createElement(g.b,{icon:"fa fa-plus-circle",onClick:this.viewer.showParameters,title:"Change report params"}),!this.isGadget&&d.a.createElement(g.b,{icon:"fa fa-edit",onClick:this.props.onCancelView,title:"Edit report"}))}},{key:"render",value:function(){var e=this.state,t=e.definition,n=e.showGroupsPopup,r=e.groups,o=e.showWorklogPopup;return Object(i.a)(Object(s.a)(a.prototype),"renderBase",this).call(this,d.a.createElement(d.a.Fragment,null,t&&d.a.createElement(f.ReportViewer,{api:this.getApi,definition:t}),n&&d.a.createElement(h.a,{groups:r,onHide:this.usersSelected}),o&&d.a.createElement(v.a,{worklog:this.worklogItem,onDone:this.worklogAdded,onHide:this.hideWorklog})))}}]),a}(m.b);t.a=y},358:function(e,t,a){},400:function(e,t,a){"use strict";var n=a(8),r=a(0),o=a.n(r),i=a(4),s=a(5),l=a(6),c=a(46),u=a(243),d=a(37),m=a(15),p=a(16),g=a(2),f=a.n(g),h=a(264),v=a(242),k=a(244),y=a(9),b=a(31),E=a(332),w=a(253),S=a(49);function C(e){return N.apply(this,arguments)}function N(){return(N=Object(i.a)(o.a.mark((function e(t){var a,n,r,i,s,l,c,u,d,m;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",{});case 2:return a=Object(y.c)("JiraService"),n=t.fields.map((function(e){return e.field})),e.next=6,a.searchTickets(t.jql,n);case 6:return r=e.sent,i={},s=t.fields.map(j.bind(i)),i.fieldWithExpr=s.filter((function(e){return!!e.ast})),l=r.map(T.bind(i)),i.hasWorklogs&&(c=i.usersObj,(u=Object.keys(c).map((function(e){return{field:e,displayText:c[e].displayName,type:"seconds",groupText:"Log Work",allowGrouping:!1,viewComponent:w.j,props:{}}}))).push({field:"totalWorklog",displayText:"Total Log Work",type:"seconds",groupText:"Log Work",allowGrouping:!1,viewComponent:w.j,props:{}}),d=s.findIndex((function(e){return"worklog"===e.field})),s.splice.apply(s,[d,1].concat(Object(b.a)(u)))),m={isLoading:!1,reportData:l,columnList:s,settings:t.settings},e.abrupt("return",m);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){var t=e.id,a=e.field,n=e.name,r=e.header,o=void 0===r?n:r,i=e.type,s=e.isArray,l=e.expr,c={id:t,field:a,displayText:o,type:i,props:{},allowSorting:!s,allowGrouping:"summary"!==a&&"description"!==a};return l?(c.ast=Object(S.c)(l),c.exprField=a,c.field=t,c.viewComponent=w.l):c.viewComponent=function(e,t,a){var n=t.props;switch(e){case"issuekey":return w.i;case"epicLink":return n.hideContext=!0,w.i;case"project":return t.fieldKey="".concat(t.field,".name"),w.g;case"user":return t.fieldKey="".concat(t.field,".displayName"),w.m;case"comment":return t.allowSorting=!1,w.a;case"issuelinks":return w.d;case"seconds":return w.j;case"workratio":return n.converter=function(e){return-1===e?null:e},w.j;case"timetracking":return w.k;case"parent":return t.fieldKey="".concat(t.field,".key"),w.c;case"progress":case"aggregateprogress":return t.fieldKey="".concat(t.field,".percent"),w.f;case"sprint":return w.h;case"attachment":return n.hrefProp="content",n.iconClass="fa-paperclip",n.tagProp="filename",w.h;case"component":return n.titleProp="description",w.h;case"version":return n.titleProp="releaseDate",w.h;case"option":return t.fieldKey="".concat(t.field,".value"),n.tagProp="value",w.h;case"votes":return t.fieldKey="".concat(t.field,".votes"),n.tagProp="votes",n.hideZero=!0,w.h;case"watches":return t.fieldKey="".concat(t.field,".watchCount"),n.tagProp="watchCount",n.hideZero=!0,w.h;case"date":case"datetime":return w.b;case"issuetype":case"status":case"priority":case"resolution":return t.fieldKey="".concat(t.field,".name"),w.e;case"epicStatus":return n.textField="value",n.iconField="",t.fieldKey="".concat(t.field,".value"),w.e;case"string":return a?(n.tagProp="",w.h):null;case"number":return w.l;default:return t.allowSorting=!1,t.allowGrouping=!1,w.l}}("issuekey"===a?"issuekey":i,c,s),c.allowSorting||(c.allowGrouping=!1),c.allowGrouping&&function(e){var t=[{type:"check",label:"Issue count",prop:"showGroupCount",value:!0},{separator:!0}];switch(e.type){default:return;case"issuetype":case"status":case"priority":case"resolution":t.splice(1,1);break;case"string":t.push({type:"radio",label:"Show value",prop:"valueType",value:"value",default:!0}),t.push({type:"radio",label:"Show count",prop:"valueType",value:"count"}),t.push({type:"radio",label:"Distinct count",prop:"valueType",value:"distinct"});break;case"user":t[1]={type:"check",label:"Show Image",prop:"showImage"},t.push({separator:!0}),t.push({type:"radio",label:"Show name",prop:"valueType",value:"name",default:!0}),t.push({type:"radio",label:"Show email id",prop:"valueType",value:"email"}),t.push({type:"radio",label:"Show both",prop:"valueType",value:"both"});break;case"project":t.push({type:"radio",label:"Show name",prop:"valueType",value:"name"}),t.push({type:"radio",label:"Show key",prop:"valueType",value:"key",default:!0}),t.push({type:"radio",label:"Show both",prop:"valueType",value:"both"});break;case"parent":t[1]={type:"check",label:"Show status",prop:"showStatus",default:!0},t.push({separator:!0}),t.push({type:"radio",label:"Show key",prop:"valueType",value:"key",default:!0}),t.push({type:"radio",label:"Show summary",prop:"valueType",value:"summary"}),t.push({type:"radio",label:"Show both",prop:"valueType",value:"both"});break;case"date":case"datetime":t.push({type:"radio",label:"Friendly date",prop:"funcType",value:"friendly"}),t.push({type:"radio",label:"Group by year",prop:"funcType",value:"yyyy"}),t.push({type:"radio",label:"Group by month",prop:"funcType",value:"MMMM"}),t.push({type:"radio",label:"Group by both",prop:"funcType",value:"yyyy-MM (MMMM)",default:!0}),t.push({type:"radio",label:"Group by date",prop:"funcType",value:"yyyy-MM-dd"});break;case"number":case"seconds":t.push({type:"radio",label:"Group by field",prop:"funcType",value:"",default:!0}),t.push({type:"radio",label:"Sum of field",prop:"funcType",value:"sum"}),t.push({type:"radio",label:"Avg of field",prop:"funcType",value:"avg"}),t.push({type:"radio",label:"Count having value",prop:"funcType",value:"count"})}e.groupOptions=t}(c),c}function T(e){var t=e.fields;return t.issuekey=e.key,t.id=e.id,O.call(this,t),function(e){if(!e.comment)return;e.comment=e.comment.comments}(t),D.call(this,t),t}function O(e){if(e.worklog)if(e.worklog=e.worklog.worklogs,e.worklog.length){this.hasWorklogs=!0;var t=this.usersObj||{};this.usersObj=t;var a,n=Object(E.a)(e.worklog);try{for(n.s();!(a=n.n()).done;){var r=a.value,o=r.author,i=r.timeSpentSeconds,s=o.accountId,l=o.emailAddress||s;t[l]||(t[l]=o),e[l]=(e[l]||0)+i,e.totalWorklog=(e.totalWorklog||0)+i}}catch(c){n.e(c)}finally{n.f()}}else delete e.worklog}function D(e){if(this.fieldWithExpr.length){var t,a=Object(E.a)(this.fieldWithExpr);try{for(a.s();!(t=a.n()).done;){var n=t.value;if("string"!==typeof n.ast)try{var r=Object(S.b)(n.ast,{this:e[n.exprField],Fields:e,parseInt:parseInt,parseFloat:parseFloat,Math:Math,Number:Number});e[n.id]=r}catch(o){e[n.id]="Error: ".concat((null===o||void 0===o?void 0:o.message)||o)}else e[n.id]=n.ast}}catch(o){a.e(o)}finally{a.f()}}}var W=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var r;Object(s.a)(this,a);var l=e.query;return(r=t.call(this,e,(null===l||void 0===l?void 0:l.queryName)||"Custom report viewer","fa-clock-o")).toggleGroupOptions=function(){return r.setState({hideGroups:!r.state.hideGroups})},r.refreshData=function(){return r.loadData(r.props.query||r.state.query)},r.loadData=function(){var e=Object(i.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.setState({isLoading:!0,hasError:!1}),e.prev=1,e.t0=r,e.next=5,C(t);case 5:e.t1=e.sent,e.t0.setState.call(e.t0,e.t1),e.next=12;break;case 9:e.prev=9,e.t2=e.catch(1),r.setState({isLoading:!1,hasError:!0});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),r.tableSettingsChanged=function(e){r.settings=Object(n.a)(Object(n.a)({},r.settings),e),r.isGadget?(r.saveSettings(),r.setState({settings:e})):r.props.settingsChanged(e)},Object(y.a)(Object(c.a)(r),"AnalyticsService","ReportService","JiraService","UtilsService","UserUtilsService"),r.state.isLoading=!0,r.state.hideGroups=r.isGadget,r}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.initWithProps(this.props)}},{key:"renderCustomActions",value:function(e){return e?f.a.createElement(v.b,{type:"success",title:"Click to toggle group options",icon:this.state.hideGroups?"fa fa-toggle-off":"fa fa-toggle-on",onClick:this.toggleGroupOptions}):f.a.createElement(v.b,{type:"success",label:"Edit",title:"Click to edit the report",icon:"fa fa-edit",onClick:this.props.onEditClicked})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){Object(u.a)(Object(d.a)(a.prototype),"UNSAFE_componentWillReceiveProps",this).call(this,e),this.initWithProps(e)}},{key:"initWithProps",value:function(e){var t=e.query,a=e.reportId;a?this.reportId!==a&&(this.reportId=a,this.loadReportDefinition(a)):t&&this.query!==t&&(this.query=t,this.loadReportData(t))}},{key:"loadReportDefinition",value:function(){var e=Object(i.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$report.getReportDefinition(t);case 2:a=e.sent,this.title=(null===a||void 0===a?void 0:a.queryName)||"Custom report viewer",this.setState({query:a}),this.loadReportData(a);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadReportData",value:function(e){this.settings=Object(n.a)(Object(n.a)({},e.settings),this.settings),this.jql===e.jql&&this.fields===e.fields||(this.jql=e.jql,this.fields=e.fields,this.loadData(e))}},{key:"render",value:function(){var e=this.props.query,t=this.state.query,n=void 0===t?e:t,r=this.state,o=r.loading,i=r.reportData,s=r.columnList,l=r.settings,c=r.hasError,m=r.hideGroups,p=this.settings||l||{},g=p.displayColumns,v=p.groupBy,k=p.groupFoldable,y=p.sortField,b=p.isDesc;return c?Object(u.a)(Object(d.a)(a.prototype),"renderBase",this).call(this,f.a.createElement("div",{className:"error-block"},"Unable to load this report due to an error.")):o||!i?Object(u.a)(Object(d.a)(a.prototype),"renderBase",this).call(this):Object(u.a)(Object(d.a)(a.prototype),"renderBase",this).call(this,f.a.createElement(h.a,{dataset:i,hideGroups:m,exportSheetName:n.queryName,columns:s,allowSorting:!0,onChange:this.tableSettingsChanged,displayColumns:g,groupBy:v,groupFoldable:k,sortField:y,isDesc:b,noRowsMessage:"No ticket details available"}))}}]),a}(k.b);t.a=W},526:function(e,t,a){},527:function(e,t,a){},528:function(e,t,a){},863:function(e,t,a){"use strict";a.r(t);var n=a(79),r=a(31),o=a(8),i=a(5),s=a(6),l=a(46),c=a(15),u=a(16),d=a(2),m=a.n(d),p=(a(526),a(9)),g=a(262),f=a(259),h=a(292),v=a(295),k=a(1),y=(a(527),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).saveName=function(){n.setState({isEditMode:!1});var e=n.state,t=e.value,a=e.icon;n.props.onChange(t,a)},n.onChange=function(e){return n.setState({value:e})},n.onIconChange=function(e){return n.setState({icon:e})},n.cancelEdit=function(){return n.setState({isEditMode:!1,value:n.props.value})},n.showIcons=function(e){return n.op.show(e)},n.setRef=function(e){return n.op=e},n.state=n.getState(e),n}return Object(s.a)(a,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState(this.getState(e))}},{key:"getState",value:function(e){var t=e.value,a=e.icon;return a||(a="fa-tachometer"),t||(t="Default"),{value:t,icon:a}}},{key:"render",value:function(){var e=this,t=this.state,a=t.value,n=t.icon;return t.isEditMode?m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:"p-inputgroup dashboard-name-edit"},m.a.createElement(f.a,{icon:"fa ".concat(n),onClick:this.showIcons}),m.a.createElement(h.a,{value:a,maxLength:18,onChange:this.onChange}),m.a.createElement(f.a,{icon:"fa fa-check",type:"success",onClick:this.saveName,disabled:!a||a.length<=2}),m.a.createElement(f.a,{icon:"fa fa-undo",onClick:this.cancelEdit})),m.a.createElement(v.OverlayPanel,{ref:this.setRef},m.a.createElement("div",{className:"dashboard-icons"},k.f.map((function(t,a){return m.a.createElement("div",{key:a,className:"d-icon",onClick:function(){return e.onIconChange(t)}},m.a.createElement("span",{className:t}))})),m.a.createElement("div",{className:"clear-fix"})))):m.a.createElement("div",{className:"dashboard-name",title:"Click to edit the name or change the icon",onClick:function(){return e.setState({isEditMode:!0})}},m.a.createElement("span",{className:"board-icon fa ".concat(n)}),m.a.createElement("span",{className:"lev-1"},"Dashboards"),m.a.createElement("i",{className:"fa fa-arrow-right"}),m.a.createElement("span",{className:"lev-2"},a),m.a.createElement("i",{className:"fa fa-edit"}))}}]),a}(d.PureComponent)),b=a(32),E=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),(n=t.call(this,e)).nameChanged=function(e,t){var a=n.state,r=a.index,o=a.config;o.name=e,o.icon=t,n.$dashboard.saveDashboardInfo(r,o,!0)},Object(p.a)(Object(l.a)(n),"DashboardService"),n.state=n.getStateDetails(e),n}return Object(s.a)(a,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState(this.getStateDetails(e))}},{key:"getStateDetails",value:function(e){var t=this,a=e.config,n=e.index,r=[{label:"Create dashboard",icon:"fa fa-plus",command:function(){return t.$dashboard.createDashboard(t.state.config)}},{label:"Delete dashboard",icon:"fa fa-trash-o",command:function(){return t.deleteDashboard()},disabled:0===n}];if(!this.props.isQuickView){var o={label:"Show in tabs",icon:a.isTabView?"fa fa-check-square":"fa fa-square",command:function(){return t.setAsTabView(o)}},i={label:"Set as quick view",icon:a.isQuickView?"fa fa-check-square":"fa fa-square",disabled:a.isQuickView,command:function(){return t.setAsQuickView(i)}};r.push(o),r.push(i)}return this.contextMenu=r,{config:a,index:n}}},{key:"deleteDashboard",value:function(){var e=this;this.$dashboard.deleteDashboard(this.state.index).then((function(t){e.props.history.push("/".concat(e.props.userId,"/dashboard/0"))}))}},{key:"setAsQuickView",value:function(e){e.disabled=!0,e.icon="fa fa-check-square",this.$dashboard.setAsQuickView(this.state.config,this.state.index)}},{key:"setAsTabView",value:function(e){var t=this.state,a=t.config,n=t.index;this.$dashboard.setAsTabView(a,n),e.icon=a.isQuickView?"fa fa-check-square":"fa fa-square",this.props.tabViewChanged(a.isTabView)}},{key:"render",value:function(){var e=this,t=this.state.config,a=t.icon,n=t.name;return m.a.createElement(m.a.Fragment,null,m.a.createElement("div",{className:"page-header"},m.a.createElement("div",{className:"pull-left"},m.a.createElement(y,{icon:a,value:n,onChange:this.nameChanged})),m.a.createElement("div",{className:"pull-right"},m.a.createElement(f.a,{type:"success",icon:"fa fa-cubes",label:"Add gadgets",onClick:this.props.onShowGadgets}),m.a.createElement(f.a,{icon:"fa fa-wrench",onClick:function(t){return Object(b.showContextMenu)(t,e.contextMenu)}}))))}}]),a}(d.PureComponent),w=a(243),S=a(37),C=a(247),N=(a(528),a(35)),j=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(i.a)(this,a),n=t.call(this,e,"Manage gadgets"),Object(N.b)(Object(l.a)(n),"ReportService"),n.style={width:"700px"},n.state.widgets=e.widgetsList,n.state.gadgetList=g.d,n}return Object(s.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){var e=this;this.$report.getReportsList().then((function(t){if(t&&t.length){var a=t.map((function(e){return{id:(e.advanced?"AR:":e.isNew?"CR:":"SQ:")+e.id,icon:"fa fa-filter",name:e.queryName,isOld:!(e.isNew||e.advanced),details:e.advanced?"<no details available>":"".concat(e.outputCount," columns displayed in table format").concat(e.isNew?" with interactive option to sort and group based on columns.":" (deprecated, not allowed to add to dashboard)")}})),n=[].concat(Object(r.a)(g.d),Object(r.a)(a));e.setState({gadgetList:n})}}))}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.state.widgets!==e.widgetsList&&this.setState({widgets:e.widgetsList})}},{key:"getFooter",value:function(){return m.a.createElement(f.a,{icon:"fa fa-check",label:"Done",onClick:this.onHide})}},{key:"render",value:function(){var e=this.props,t=e.addGadget,n=e.removeGadget,r=this.state,o=r.widgets,i=r.gadgetList;return Object(w.a)(Object(S.a)(a.prototype),"renderBase",this).call(this,m.a.createElement(m.a.Fragment,null,i.map((function(e){var a=o.some((function(t){return t.name===e.id}));return m.a.createElement("div",{key:e.id,className:"gadget-info"},m.a.createElement("div",{className:"icon"},m.a.createElement("i",{className:"fa ".concat(e.icon)})),m.a.createElement("div",{className:"details"},m.a.createElement("span",{className:"name"},e.name),m.a.createElement("span",{className:"desc"},e.details),m.a.createElement("div",{className:"params"})),m.a.createElement("div",{className:"controls"},!a&&m.a.createElement(f.a,{type:"success",icon:"fa fa-plus",label:"Add gadget",disabled:e.isOld,onClick:function(){return t(e.id)}}),a&&m.a.createElement(f.a,{type:"danger",icon:"fa fa-times",label:"Remove gadget",onClick:function(){return n(e.id)}})))})),m.a.createElement("div",{className:"clearfix"})))}}]),a}(C.a),T=a(255),O=a(244),D=a(112),W=a(356),x=a(400),U=a(357),A=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var s;Object(i.a)(this,a),(s=t.call(this,e)).tabViewChanged=function(e){return s.setState({isTabView:e})},s.addGadget=function(e,t){var a=s.state.currentBoard;(a=Object(o.a)({},a)).widgets=a.widgets.concat({name:e,settings:t||{}}),s.setState({currentBoard:a})},s.removeGadget=function(e){var t=s.state.currentBoard;t=Object(o.a)({},t);var a=Object(r.a)(t.widgets);a.removeAll((function(t){return t.name===e})),t.widgets=a,s.setState({currentBoard:t})},s.saveDashboardInfo=function(){var e=s.state,t=e.dashboardIndex,a=e.currentBoard;s.$dashboard.saveDashboardInfo(t,a)},s.widgetAction=function(e,t,a){switch(e.type){case g.c.AddWorklog:s.worklogItem=e.data,s.setState({showWorklogPopup:!0});break;case g.c.RemoveGadget:var n=s.state.currentBoard;n=Object(o.a)({},n);var i=Object(r.a)(n.widgets);n.widgets=i,i.splice(a,1),s.setState({currentBoard:n},s.saveDashboardInfo),s.emitToChildren(e,a);break;case g.c.SettingsChanged:t.settings=e.data,s.saveDashboardInfo();break;default:s.emitToChildren(e,a)}},s.gadgetReordered=function(e){var t=s.state.currentBoard;t=Object(o.a)(Object(o.a)({},t),{},{widgets:e}),s.setState({currentBoard:t},s.saveDashboardInfo)},s.getControls=function(e,t,a){var r=e.name,i=e.settings,l=s.state.isTabView,c=r.split(":");c.length>1&&(r=c[0],c.splice(0,1));var u=s.gadgetsList[r];u||(u={title:"Gadget Unavailable",control:O.b});var d=null;u.getProps&&(d=u.getProps(i,c));var p=Object(o.a)({key:"".concat(r,"_").concat(c[0]),tabLayout:l,index:t,model:e,settings:i,isGadget:!0,layout:s.state.currentBoard.layout,onAction:s.widgetAction},d),g=u.control;if(l){var f=u.title;return f||(f="function"===typeof g.getTitle?g.getTitle(p):"Unknown Gadget"),m.a.createElement(D.TabPanel,{key:r,header:f},m.a.createElement(g,p))}return function(e){return m.a.createElement(g,Object(n.a)({},p,{draggableHandle:e,dropProps:a}))}},s.onShowGadgets=function(){return s.setState({showGadgetDialog:!0})},s.hideGadgetDialog=function(){s.setState({showGadgetDialog:!1}),s.saveDashboardInfo()},s.worklogAdded=function(e){s.emitToChildren(e),s.hideWorklog()},s.hideWorklog=function(){return s.setState({showWorklogPopup:!1})},Object(p.a)(Object(l.a)(s),"DashboardService","SessionService","ReportService","CacheService"),s.rapidViews=s.$session.CurrentUser.rapidViews||[];var c=e.match.params;return s.isQuickView=s.$session.isQuickView,s.state=s.loadDashboard(parseInt(c.index||0)),s.setGadgetsList(),s}return Object(s.a)(a,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.match.params.index;t!==this.state.dashboardIndex&&this.setState(this.loadDashboard(t))}},{key:"loadDashboard",value:function(e){var t=this.$session.CurrentUser.dashboards;e>=t.length&&(e=0);var a=t[e];return{dashboardIndex:e,currentBoard:a,isTabView:this.isQuickView||a.isTabView}}},{key:"emitToChildren",value:function(e,t){O.c.emit("change",e,t)}},{key:"setGadgetsList",value:function(){var e={myOpenTickets:{title:"My open tickets",control:g.f},bookmarksList:{title:"My Bookmarks",control:g.e},dateWiseWorklog:{title:"Daywise worklog",control:g.b},pendingWorklog:{title:"Worklog - [Pending upload]",control:g.h},ticketWiseWorklog:{title:"Ticketwise worklog",control:g.j},sWiseTSpent:{title:"Status Wise Time Spent",control:g.i},myFilters:{title:"My reports",control:g.g},agendaDay:{title:"Calendar",control:g.a,getProps:function(){return{viewMode:"timeGridDay"}}},agendaWeek:{title:"Calendar",control:g.a,getProps:function(){return{viewMode:"timeGridWeek"}}},SQ:{title:"Custom report (Old)",control:W.a,getProps:function(e,t){return{reportId:parseInt(t[0])}}},CR:{title:"Custom report",control:x.a,getProps:function(e,t){return{reportId:parseInt(t[0])}}},AR:{title:"Advanced report",control:U.a,getProps:function(e,t){return{reportId:parseInt(t[0])}}}};e.myBookmarks=e.bookmarksList,e.dtWiseWL=e.dateWiseWorklog,e.pendingWL=e.pendingWorklog,this.gadgetsList=e}},{key:"getGadgets",value:function(e){return e&&e.length?this.state.isTabView?m.a.createElement(D.TabView,{className:"no-padding tab-gadgets"},e.map(this.getControls)):m.a.createElement(b.Sortable,{items:e,itemType:"gadget",onChange:this.gadgetReordered},this.getControls):null}},{key:"render",value:function(){var e=this.state,t=e.currentBoard.widgets,a=e.dashboardIndex,r=e.currentBoard,o=e.showGadgetDialog,i=e.showWorklogPopup;return m.a.createElement("div",null,m.a.createElement(E,Object(n.a)({},this.props,{config:r,index:a,userId:this.$session.userId,onShowGadgets:this.onShowGadgets,tabViewChanged:this.tabViewChanged,isQuickView:this.isQuickView})),this.getGadgets(t),(!t||0===t.length)&&m.a.createElement("div",{className:"no-widget-div"},'You haven\'t added any gadgets to this dashboard. Click on "Add gadgets" button above to start adding a cool one and personalize your experience.'),o&&m.a.createElement(j,{onHide:this.hideGadgetDialog,widgetsList:t,addGadget:this.addGadget,removeGadget:this.removeGadget}),i&&m.a.createElement(T.a,{worklog:this.worklogItem,onDone:this.worklogAdded,onHide:this.hideWorklog}))}}]),a}(d.PureComponent);t.default=A}}]);
//# sourceMappingURL=18.a4ab50b4.chunk.js.map