(this["webpackJsonpjira-assistant"]=this["webpackJsonpjira-assistant"]||[]).push([[36],{238:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(4),i=a(5),o=a(6),c=a(46),l=a(15),u=a(16),m=a(2),d=a.n(m),h=a(35),p=a(242),f=a(1),g=a(10),v=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var r;return Object(i.a)(this,a),(r=t.call(this,e)).integrate=function(){var e=r.state.jiraUrl.trim().clearEnd("/").clearEnd("\\");r.setState({jiraUrl:e}),r.$session.rootUrl=e,r.setState({isLoading:!0}),r.$ajax.get(f.c.mySelf).then((function(t){var a=Object(g.e)(t),n=t.emailAddress;r.getUserFromDB(e,a,n).then((function(t){t?(t.jiraUrl=e,t.userId=a,t.email=n,t.lastLogin=new Date,r.$db.users.put(t).then((function(e){return t.id}),r.handleDBError).then(r.openDashboard)):(t={jiraUrl:e,userId:a,email:n,lastLogin:new Date,dateFormat:"dd-MMM-yyyy",timeFormat:" hh:mm:ss tt",maxHours:8,dateCreated:new Date},r.$db.users.add(t).then((function(e){return e}),r.handleDBError).then(r.openDashboard))}))}),(function(e){401===(e=e||{}).status?r.$message.warning("You are not authenticated with Jira to integrate.","Unauthorized"):r.$message.error("This is not a valid Jira server url or the server does not respond.","Unknown server")})).then((function(){r.setState({isLoading:!1})}))},r.handleDBError=function(e){return r.$message.error("Unable to save the changes. Verify if you have sufficient free space in your C:","Allocation failed"),-1},r.openDashboard=function(e){e<=0||(r.$cache.set("CurrentJiraUrl",r.state.jiraUrl),r.$cache.set("CurrentUserId",e),r.$jaBrowserExtn.openTab("/index.html"),window.close())},Object(h.b)(Object(c.a)(r),"AjaxService","DatabaseService","MessageService","CacheService","AppBrowserService","SessionService"),r.year=(new Date).getFullYear(),r.browser=navigator.userAgent,r.state={},r}return Object(o.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){var e=this;this.$jaBrowserExtn.getAppVersion().then((function(t){return e.setState({version:t})})),this.$jaBrowserExtn.getCurrentUrl().then((function(t){var a=e.getJiraRootUrl(t);a&&a.length>20&&a.startsWith("http")&&e.setState({jiraUrl:a})}))}},{key:"getJiraRootUrl",value:function(e){return e.replace(/^(.*\/\/[^/?#]*).*$/,"$1")}},{key:"getUserFromDB",value:function(){var e=Object(s.a)(n.a.mark((function e(t,a,r){var s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$db.users.where("userId").equalsIgnoreCase(a).and((function(e){return e.jiraUrl.toLowerCase()===t.toLowerCase()})).first();case 2:if((s=e.sent)||!r){e.next=8;break}return r=r.toLowerCase(),e.next=7,this.$db.users.filter((function(e){return(e.email||"").toLowerCase()===r&&e.jiraUrl.toLowerCase()===t.toLowerCase()})).first();case 7:s=e.sent;case 8:return e.abrupt("return",s);case 9:case"end":return e.stop()}}),e,this)})));return function(t,a,r){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.integrate,a=this.version,r=this.browser,n=this.state,s=n.jiraUrl,i=n.isLoading;return d.a.createElement("div",{className:"app flex-row align-items-center"},d.a.createElement("div",{className:"container"},d.a.createElement("div",{className:"row justify-content-center"},d.a.createElement("div",{className:"col-md-6 no-padding no-margin",style:{maxWidth:480,minWidth:460}},d.a.createElement("div",{className:"card mx-4 no-padding no-margin"},d.a.createElement("div",{className:"card-body p-4"},d.a.createElement("h1",null,"Jira Assistant"),d.a.createElement("p",{className:"text-muted"},d.a.createElement("strong",null,"Integrate")," with your Jira account"),d.a.createElement("div",{className:"input-group mb-3"},d.a.createElement("div",{className:"input-group-prepend"},d.a.createElement("span",{className:"input-group-text"},d.a.createElement("i",{className:"fa fa-external-link"}))),d.a.createElement(p.j,{className:"form-control",value:s,onChange:function(t){return e.setState({jiraUrl:t})},placeholder:"Jira url (eg: https://jira.example.com)"})),d.a.createElement("p",{className:"text-muted"},"Login to your Jira in current tab or provide the Url of your Jira server to integrate. Ensure you have already been authenticated in Jira before you click on Integrate button."),d.a.createElement(p.b,{type:"success",className:"btn-block",icon:i?"fa fa-spinner fa-spin":"fa fa-unlock-alt",disabled:!s||i,onClick:t,label:"Integrate"})),d.a.createElement("div",{className:"card-footer p-4"},d.a.createElement("div",{className:"row"},d.a.createElement("div",{className:"col-6"},d.a.createElement("span",null,"\xa9 ",this.year," Jira Assistant")),d.a.createElement("div",{className:"col-6",style:{textAlign:"right"}},d.a.createElement("span",null,d.a.createElement("i",{className:"fa fa-youtube"}),d.a.createElement("a",{href:"https://www.youtube.com/embed/HsWq7cT3Qq0?rel=0&autoplay=1&showinfo=0&cc_load_policy=1",target:"_blank",rel:"noopener noreferrer",title:"Click to open youtube video guiding you to setup Jira Assistant"}," Help setup"))," |",d.a.createElement("span",null,d.a.createElement("i",{className:"fa fa-phone"}),d.a.createElement("a",{href:"https://docs.google.com/forms/d/e/1FAIpQLScJvQtHZI_yZr1xd4Z8TwWgvtFss33hW5nJp4gePCgI2ScNvg/viewform?entry.1426640786=".concat(a,"&entry.972533768=").concat(r),target:"_blank",rel:"noopener noreferrer",title:"Click to report about any issues or ask a question"}," Contact us"))))))))))}}]),a}(m.PureComponent);t.default=v}}]);
//# sourceMappingURL=36.79d0c197.chunk.js.map