(this["webpackJsonpjira-assistant"]=this["webpackJsonpjira-assistant"]||[]).push([[9],{1:function(e,t,r){"use strict";r.d(t,"c",(function(){return a})),r.d(t,"w",(function(){return i})),r.d(t,"b",(function(){return s})),r.d(t,"s",(function(){return o})),r.d(t,"x",(function(){return u})),r.d(t,"e",(function(){return c})),r.d(t,"j",(function(){return l})),r.d(t,"h",(function(){return d})),r.d(t,"n",(function(){return h})),r.d(t,"m",(function(){return f})),r.d(t,"f",(function(){return p})),r.d(t,"v",(function(){return g})),r.d(t,"g",(function(){return v})),r.d(t,"r",(function(){return m})),r.d(t,"p",(function(){return y})),r.d(t,"l",(function(){return k})),r.d(t,"q",(function(){return b})),r.d(t,"o",(function(){return w})),r.d(t,"k",(function(){return j})),r.d(t,"t",(function(){return S})),r.d(t,"d",(function(){return $})),r.d(t,"a",(function(){return O})),r.d(t,"u",(function(){return x})),r.d(t,"i",(function(){return U}));var n=r(3),a={getAllProjects:"~/rest/api/2/project",search:"~/rest/api/2/search",getIssue:"~/rest/api/2/issue/",bulkImportIssue:"~/rest/api/2/issue/bulk",getProjectImportMetadata:"~/rest/api/2/issue/createmeta?expand=projects.issuetypes.fields&projectKeys=",getProjectStatuses:"~/rest/api/3/project/{0}/statuses",getIssueMetadata:"~/rest/api/2/issue/{0}/editmeta",individualIssue:"~/rest/api/2/issue/{0}",getAllIssueTypes:"~/rest/api/2/issuetype",addIssueWorklog:"~/rest/api/2/issue/{0}/worklog?adjustEstimate=AUTO",issueWorklog:"~/rest/api/2/issue/{0}/worklog",updateIndividualWorklog:"~/rest/api/2/issue/{0}/worklog/{1}?adjustEstimate=AUTO",individualWorklog:"~/rest/api/2/issue/{0}/worklog/{1}",searchUser:"~/rest/api/2/user/search?maxResults={1}&startAt={2}&query={0}",searchUser_Alt:"~/rest/api/2/user/search?maxResults={1}&startAt={2}&username={0}",getCustomFields:"~/rest/api/2/field",getJQLAutocomplete:"~/rest/api/2/jql/autocompletedata",getJQLSuggestions:"~/rest/api/2/jql/autocompletedata/suggestions",getUserDetails:"~/rest/api/2/user?username={0}",mySelf:"~/rest/api/2/myself",rapidSprintList:"~/rest/greenhopper/1.0/sprintquery/{0}",rapidSprintDetails:"~/rest/greenhopper/1.0/rapid/charts/sprintreport?rapidViewId={0}&sprintId={1}",sprintListAll:"~/rest/greenhopper/1.0/integration/teamcalendars/sprint/list?jql=project+in+({0})",sprintListOpen:"~/rest/greenhopper/1.0/integration/teamcalendars/sprint/list?jql=project+in+({0})+and+Sprint+not+in+closedSprints()",getSprintIssues:"~/rest/agile/1.0/sprint/{0}/issue",rapidViews:"~/rest/greenhopper/1.0/rapidview",burndownChart:"~/rest/greenhopper/1.0/rapid/charts/scopechangeburndownchart.json?rapidViewId={0}&sprintId={1}",googleLogoutUrl:"https://accounts.google.com/o/oauth2/revoke?token={0}",outlookLogoutUrl:"https://login.microsoftonline.com/common/oauth2/v2.0/logout"},i="https://jiraassistant.com/messages.json",s="https://www.google-analytics.com/collect",o=["dd-MMM-yyyy","dd/MMM/yyyy","dd-MM-yyyy","dd/MM/yyyy","MM-dd-yyyy","MM/dd/yyyy","yyyy-MM-dd","yyyy/MM/dd","MMM dd, yyyy","ddd, MMM dd, yyyy"],u=[" HH:mm:ss"," hh:mm:ss tt"," HH.mm.ss"," hh.mm.ss tt"],c="https://chrome.google.com/webstore/detail/jira-assistant/momjbjbjpbcbnepbgkkiaofkgimihbii",l="https://addons.mozilla.org/en-US/firefox/addon/jira-assistant/",d="https://microsoftedge.microsoft.com/addons/detail/aoenpdbabcjnjbjpegeenodfknllmaoi",h="https://addons.opera.com/en/extensions/details/jira-assistant/",f="https://github.com/shridhar-tl/jira-assistant",p=["fa fa-tachometer","fa fa-info-circle","fa fa-language","fa fa-asterisk","fa fa-gift","fa fa-fire","fa fa-eye","fa fa-low-vision","fa fa-cube","fa fa-cubes","fa fa-plane","fa fa-calendar","fa fa-tree","fa fa-random","fa fa-deviantart","fa fa-database","fa fa-folder","fa fa-folder-open","fa fa-bar-chart","fa fa-life-ring","fa fa-key","fa fa-bookmark-o","fa fa-futbol-o","fa fa-certificate","fa fa-calculator","fa fa-tasks","fa fa-globe","fa fa-area-chart","fa fa-pie-chart","fa fa-line-chart","fa fa-columns","fa fa-sitemap","fa fa-dashboard","fa fa-desktop","fa fa-laptop","fa fa-flag","fa fa-home","fa fa-hashtag","fa fa-info","fa fa-tag","fa fa-trophy","fa fa-list-alt","fa fa-th","fa fa-th-list","fa fa-th-large"];function g(e){var t=[[n().startOf("month").toDate(),n().endOf("month").toDate()],[n().subtract(1,"months").toDate(),n().toDate()],[n().subtract(1,"months").startOf("month").toDate(),n().subtract(1,"months").endOf("month").toDate()],[n().startOf("week").toDate(),n().endOf("week").toDate()],[n().subtract(6,"days").toDate(),n().toDate()],[n().subtract(1,"weeks").startOf("week").toDate(),n().subtract(1,"weeks").endOf("week").toDate()]];return e?t[e-1]:t}var v=9999999,m=function(){for(var e={},t=[],r=0;r<256;r++)t[r]=(r<16?"0":"")+r.toString(16);return e.generate=function(){var e=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0,a=4294967295*Math.random()|0;return"".concat(t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255],"-").concat(t[255&r]).concat(t[r>>8&255],"-").concat(t[r>>16&15|64]).concat(t[r>>24&255],"-").concat(t[63&n|128]).concat(t[n>>8&255],"-").concat(t[n>>16&255]).concat(t[n>>24&255]).concat(t[255&a]).concat(t[a>>8&255]).concat(t[a>>16&255]).concat(t[a>>24&255])},e}(),y=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],k=["January","Febraury","March","April","May","June","July","August","September","October","November","December"],b=["Su","Mo","Tu","We","Th","Fr","Sa"],w=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],j=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],S=["issuetype","summary","reporter","priority","status","resolution","created","updated"],$=2.31,O="UA-108841109-1";var x={openTicketsJQL:"assignee=currentUser() AND resolution=Unresolved and status != Closed",jiraUpdatesJQL:"(comment ~ currentUser() or summary ~ currentUser() or description ~ currentUser() or assignee = currentUser() or reporter = currentUser()) and updatedDate >= $date$ and (lastViewed is null or lastViewed <= $date$) order by lastViewed"},U={Temporary:"Temporary actions",Instance:"Instance actions",DbOperations:"Db operations",GadgetActions:"Gadget actions",UserActions:"User actions",HeaderActions:"Header actions",ClickEvents:"Click events",DialogEvents:"Popup events",DataFetch:"Data fetch operations"}},10:function(e,t,r){"use strict";r.d(t,"k",(function(){return c})),r.d(t,"a",(function(){return l})),r.d(t,"i",(function(){return f})),r.d(t,"j",(function(){return p})),r.d(t,"h",(function(){return g})),r.d(t,"b",(function(){return v})),r.d(t,"c",(function(){return m})),r.d(t,"l",(function(){return y})),r.d(t,"e",(function(){return k})),r.d(t,"f",(function(){return b})),r.d(t,"d",(function(){return w})),r.d(t,"g",(function(){return j}));var n=r(12),a=r(65),i=r(3),s=r.n(i),o=r(22),u=r.n(o);function c(e,t,r){var n=btoa(e),a="data:".concat(t,";base64,").concat(n),i=document.createElement("a");"download"in i?(i.href=a,i.setAttribute("download",r),document.body.appendChild(i),setTimeout((function(){i.click(),document.body.removeChild(i)}),66)):document.location.href=a}function l(e,t,r){var n=document.createElement("a");r=r||"application/octet-stream";var a=t.toLowerCase().lastIndexOf(".csv");if(-1!==a&&a!==t.length-4||(t+=".csv"),navigator.msSaveBlob)return navigator.msSaveBlob(new Blob([e],{type:r}),t);if("download"in n)return n.href="data:".concat(r,",").concat(encodeURIComponent(e)),n.setAttribute("download",t),document.body.appendChild(n),setTimeout((function(){n.click(),document.body.removeChild(n)}),66),!0;var i=document.createElement("iframe");return document.body.appendChild(i),i.src="data:".concat(r,",").concat(encodeURIComponent(e)),setTimeout((function(){document.body.removeChild(i)}),333),!0}var d=/^(\d*?):(\d*)$/,h=Object(a.a)(/^( *([0-9]+)w)?( *([0-9]+)d)?( *([0-9]+)h)?( *([0-9]+)m)?$/,{w:2,d:4,h:6,m:8});function f(e){if(!e)return 0;var t=0,r=0,n=0,a=0;if("string"!==typeof e&&"number"!==typeof e)return null;e=(e=e.toString()).trim();if(isNaN(e)){if(d.test(e)){var i=e.split(":");n=parseInt(i[0])||0,a=parseInt(i[1])||0}else if(h.test(e)){var s=h.exec(e).groups,o=s.w,u=s.d,c=s.h,l=s.m;t=parseInt(o)||0,r=parseInt(u)||0,n=parseInt(c)||0,a=parseInt(l)||0}}else if(e.indexOf(".")){var f,p=e.split(".");n=parseInt(p[0])||0,1===(null===(f=p[1])||void 0===f?void 0:f.length)&&(p[1]+="0"),a=60*(a=parseInt(p[1])||0)/100}else a=parseInt(e)||0;return 60*(60*(8*(5*t+r)+n)+a)}function p(e,t){return t=function(e){return Object.keys(e).map((function(t){return"".concat(t,"=").concat(encodeURIComponent(e[t]))})).join("&")}(t),"".concat((e||"").clearEnd("?")).concat(t?"?":"").concat(t)}function g(e){try{var t=e.split(".")[0].replace("-","+").replace("_","/"),r=JSON.parse(window.atob(t)),n=e.split(".")[1].replace("-","+").replace("_","/"),a=JSON.parse(window.atob(n));return a.header=r,a}catch(i){return!1}}function v(e){return e&&"string"!==typeof e&&(e=e.toString()),e&&new URL(e).host}function m(e){e&&"string"!==typeof e&&(e=e.toString());var t=new URL(e).origin;return t.endsWith("/")||(t+="/"),t}function y(e){(!e||e<1)&&(e=1),s.a.locale(s.a.locale(),{week:{dow:e-1}})}function k(e,t){var r=null;return"object"===Object(n.a)(e)&&(r=e.name||e.emailAddress||e.accountId),t&&r&&(r=r.toLowerCase()),r}function b(e){return u()("<div>".concat(e,"</div>")).text()}function w(e,t){if(!t||!e)return e;var r=e[t];if(!r){var n=t.split(".");n.length>1&&(r=n.reduce((function(e,t){return e?e[t]:void 0}),e))}return r}function j(e){var t=(e=e.replace(/(^.*\[|\].*$)/g,"")).split(",");e={};for(var r=0;r<t.length;r++){var n=t[r].split("="),a=n[1];"<null>"!==a&&(e[n[0]]=a)}return e}},130:function(e,t,r){e.exports=r(237)},135:function(e,t){Number.prototype.pad=function(e){for(var t=String(this);t.length<(e||2);)t="0".concat(t);return t};var r=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=["January","Febraury","March","April","May","June","July","August","September","October","November","December"],a=["Su","Mo","Tu","We","Th","Fr","Sa"],i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];Date.prototype.isBetween=function(e,t){"number"!==typeof e&&(e=new Date(e).getTime()),"number"!==typeof t&&(t=new Date(t).getTime());var r=this.getTime();return e<=r&&r<=t},Date.prototype.format=function(e){var t=this.getFullYear(),o=this.getMonth()<9?"0".concat(this.getMonth()+1):this.getMonth()+1,u=this.getDate()<10?"0".concat(this.getDate()):this.getDate(),c=this.getHours()<10?"0".concat(this.getHours()):this.getHours(),l=this.getMinutes()<10?"0".concat(this.getMinutes()):this.getMinutes(),d=this.getSeconds()<10?"0".concat(this.getSeconds()):this.getSeconds();return e?e.replace("yyyy",t).replace("yy",t).replace("MMMM",n[o-1]).replace("MMM",r[o-1]).replace("MM",o).replace("DDDD",s[this.getDay()]).replace("DDD",i[this.getDay()]).replace("dddd",s[this.getDay()]).replace("ddd",i[this.getDay()]).replace("DD",a[this.getDay()]).replace("dd",u).replace("HH",c).replace("H",c-0).replace("hh",c>12?(c-12).pad(2):c).replace("mm",l).replace("ss",d).replace("tt",c>=12?"PM":"AM"):"".concat(t).concat(o).concat(u).concat(c).concat(l).concat(d)},Date.prototype.toUTCDate=function(){var e=new Date(this.getTime());return e.setMinutes(e.getMinutes()+this.getTimezoneOffset()),e},Date.prototype.addDays=function(e){var t=new Date(this);return t.setDate(t.getDate()+e),t},String.prototype.format=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];t&&1===t.length&&Array.isArray(t[0])&&(t=t[0]),t&&!Array.isArray(t)&&(t=[t]);for(var n=this,a=0;a<t.length;a++)n=n.replace(new RegExp("\\{".concat(a,"\\}"),"g"),t[a]);return n.toString()},String.prototype.startsWith||(String.prototype.startsWith=function(e){return 0===this.toLowerCase().indexOf(e.toLowerCase())}),String.prototype.endsWith||(String.prototype.endsWith=function(e){return this.toLowerCase().lastIndexOf(e.toLowerCase())===this.length-e.length}),String.prototype.clearEnd||(String.prototype.clearEnd=function(e){for(var t=this;t.endsWith(e);)t=t.substring(0,t.length-e.length);return t.toString()}),String.prototype.clearStart||(String.prototype.clearStart=function(e){for(var t=this;t.startsWith(e);)t=t.substring(e.length);return t.toString()})},137:function(e,t,r){},230:function(e,t,r){},231:function(e,t,r){},237:function(e,t,r){"use strict";r.r(t);var n=r(2),a=r.n(n),i=r(19),s=r.n(i),o=(r(135),r(57)),u=r(8),c=r(0),l=r.n(c),d=r(4),h=r(12),f=r(31),p=r(10);function g(e){return e&&e instanceof Date?e.getTime():e}function v(e){if("string"===typeof e){var t=e;e=t.indexOf(".")>-1?function(e){return Object(p.d)(e,t)}:function(e){return e[t]}}return e}function m(e,t,r,n){n=n||"";for(var a=function(e){var t=Object.keys(e);if(t.filter((function(e){return e.startsWith("~~")})).length>1)throw Error("#Error: Multiple array recurssion not allowed");return t=t.orderBy((function(e){return e.startsWith("~~")?2:1}))}(t),i=a.length,s=!1,c=function(i){var c=a[i],l=t[c],d=c.startsWith("~~");if(d&&(c=c.substring(2)),!0===l&&(l=c),"object"!==Object(h.a)(l)||Array.isArray(l)){var f=y(e,l);r[n+c]=f}else{var p=l;(l=l.field)&&!0!==l||(l=c);var g=!0===p.spread||!c,v=y(e,l),k=p.props,b=null;v&&(d?Array.isArray(v)&&(b=k?v.flattern(k,null,g?r:null,g?c:""):v,g||(r=b.map((function(e){var t=Object(u.a)(Object(u.a)({},r),{},Object(o.a)({},n+c,e));return Object.keys(e).forEach((function(r){r.startsWith("...")&&(t[r.substring(3)]=e[r],delete e[r])})),t})),s=!0)):(b=k?m(v,k,g?r:{},g?c:""):v,g||(r[n+c]=b)))}},l=0;l<i;l++)c(l);return s?r:[r]}function y(e,t){if("string"===typeof t){for(var r=t.split("."),n=e[r[0]],a=1;n&&a<r.length;a++)n=n[r[a]];return n}if("function"===typeof t)return t(e)}Array.prototype.init=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(void 0!==t&&null!==t||(t=this.length),"function"===typeof e)for(;r<t;)this[r]=e(this[r],r),r++;else for(;r<t;)this[r++]=e;return this},Array.prototype.where=function(e,t){for(var r=[],n=0;n<this.length&&(!t||t>r.length);n++)e(this[n],n)&&(r[r.length]=this[n]);return r},Array.prototype.select=function(e,t){for(var r=[],n=0;n<this.length;n++){var a=e?e(this[n],n):this[n];(null!==a||t)&&(r[r.length]=a)}return r},Array.prototype.orderBy=function(e){for(var t=[],r=0;r<this.length;r++)t[t.length]=this[r];return t.sort((function(t,r){var n=e?e(t):t,a=e?e(r):r;return!n&&a?-1:n&&!a?1:n<a?-1:n>a?1:0}))},Array.prototype.orderByDescending=function(e){for(var t=[],r=0;r<this.length;r++)t[t.length]=this[r];return t.sort((function(t,r){var n=e?e(r):r,a=e?e(t):t;return!n&&a?-1:n&&!a?1:n<a?-1:n>a?1:0}))},Array.prototype.sortBy=function(e,t){if(e&&"string"===typeof e){var r=e;e=r.indexOf(".")>-1?function(e){return Object(p.d)(e,r)}:function(e){return e[r]}}return t?this.orderByDescending(e):this.orderBy(e)},Array.prototype.selectMany=function(e){for(var t=[],r=0;r<this.length;r++)t=t.concat(e(this[r]));return t},Array.prototype.count=function(e){return e?this.where(e).length:this.length},Array.prototype.distinct=function(e,t){var r,n={},a=[];e=v(e);for(var i=0;i<this.length;i++)r=e?e(this[i]):this[i],(!t||null!==r&&void 0!==r)&&(n[r]||(n[r]=!0,a.push(r)));return a},Array.prototype.distinctObj=function(e){for(var t,r=this,n=[],a=function(a){t=e?e(r[a]):r[a];var i=Object.keys(t);n.any((function(e){for(var r=!0,n=0;n<i.length;n++)r=r&&e[i[n]]===t[i[n]];return r}))||(n[n.length]=t)},i=0;i<this.length;i++)a(i);return n},Array.prototype.sum=function(e){var t,r=0;if(e=v(e))for(t=0;t<this.length;t++)r+=e(this[t])||0;else for(t=0;t<this.length;t++)r+=parseFloat(this[t])||0;return r},Array.prototype.avg=function(e){var t,r,n=0,a=0;if(e=v(e))for(r=0;r<this.length;r++)((t=parseFloat(e(this[r])))||0===t)&&(n+=t,a++);else for(r=0;r<this.length;r++)((t=parseFloat(this[r]))||0===t)&&(n+=t,a++);return a?n/a:0},Array.prototype.max=function(e){var t,r,n=0;if(e)for(t=0;t<this.length;t++)g(r=e(this[t])||0)>g(n)&&(n=r);else for(t=0;t<this.length;t++)g(r=this[t]||0)>g(n)&&(n=r);return n},Array.prototype.min=function(e){var t,r,n=0;if(e)for(t=0;t<this.length;t++)g(r=e(this[t])||0)<g(n)&&(n=r);else for(t=0;t<this.length;t++)g(r=this[t]||0)<g(n)&&(n=r);return n},Array.prototype.any=function(e){if("function"===typeof e){for(var t=0;t<this.length;t++)if(e(this[t],t))return!0;return!1}return e?this.indexOf(e)>=0:this.length>0},Array.prototype.all=function(e){for(var t=0;t<this.length;t++)if(!e(this[t],t))return!1;return!0},Array.prototype.reverse=function(){for(var e=[],t=this.length-1;t>-1;t--)e[e.length]=this[t];return e},Array.prototype.first=function(e){return e?this.where(e,1).first():this.length>0?this[0]:null},Array.prototype.last=function(e){return e?this.where(e).last():this.length>0?this[this.length-1]:null},Array.prototype.elementAt=function(e){return this[e]},Array.prototype.firstIndexOf=function(e){for(var t=0;t<this.length;t++)if(e(this[t],t))return t;return-1},Array.prototype.intersect=function(e,t){for(var r=t||function(e,t,r,n){return e===r},n=e.items||e,a=[],i=0;i<this.length;i++)for(var s=0;s<n.length;s++)r(this[i],i,n[s],s)&&(a[a.length]=this[i]);return a},Array.prototype.defaultIfEmpty=function(e){return 0===this.length?e:this},Array.prototype.elementAtOrDefault=function(e,t){return e>=0&&e<this.length?this[e]:t},Array.prototype.firstOrDefault=function(e,t){return this.first(t)||e},Array.prototype.lastOrDefault=function(e,t){return this.last(t)||e},Array.prototype.ToString=function(e){e=e||",";for(var t="",r=0;r<this.length;r++){var n=this[r];n&&"".concat(n).length>0&&(t+=e+n)}return t.length?t.substring(e.length):""},Array.prototype.remove=function(e){var t=this.indexOf(e);return!(t<0)&&this.splice(t,1)},Array.prototype.removeAt=function(e,t){return!(e<0)&&this.splice(e,t||1)},Array.prototype.removeAll=function(e){var t=this;return"function"===typeof e?this.removeAll(this.where(e)):Array.isArray(e)&&e.forEach((function(e){t.remove(e)})),t},Array.prototype.add=function(e){return this.push(e),e},Array.prototype.insertAt=function(e,t){return this.splice(e,0,t),t},Array.prototype.insertRangeAt=function(e,t){return this.splice.apply(this,[e,0].concat(Object(f.a)(t))),this},Array.prototype.addDistinct=function(e){return!this.any(e)&&(this[this.length]=e,!0)},Array.prototype.addRange=function(e){if(e)for(var t=0;t<e.length;t++)this.push(e[t]);return this},Array.prototype.addDistinctRange=function(e){if(e)for(var t=0;t<e.length;t++)this.addDistinct(e[t]);return this},Array.prototype.groupBy=function(e,t,r){var n=[],a={};e=v(e),r=v(r);for(var i=0;i<this.length;i++){var s=this[i],o=e(s),u=null;"object"===Object(h.a)(o)&&(u=JSON.stringify(o));var c=a[u||o];c||(c={key:o,values:[]},r&&(c.keyObj=r(s,o)),n.push(a[u||o]=c)),t&&!t(s)||c.values.push(s)}return n},Array.prototype.replace=function(e,t){var r=this.indexOf(e);return-1!==r&&(this[r]=t),this},Array.prototype.clone=function(e){for(var t=[],r=0;r<this.length;r++)t[r]=this[r];if(e&&e.length>0)for(var n=0;n<e.length;n++)t[t.length]=e[n];return t},Array.prototype.notIn=function(e,t){if(!e||Array.isArray(e)&&0===e.length)return this;var r=!0===t;return r&&(e=e.select((function(e){return"string"===typeof e?e.toLowerCase():e}))),t&&"function"!==typeof t&&(t=null),Array.isArray(e)?t?this.where((function(r){return!e.any((function(e){return t(r,e)}))})):this.where((function(t){return r&&"string"===typeof t&&(t=t.toLowerCase()),-1===e.indexOf(t)})):void 0},Array.prototype.in=function(e,t){if(!e||Array.isArray(e)&&0===e.length)return this;var r=!0===t;return r&&(e=e.select((function(e){return"string"===typeof e?e.toLowerCase():e}))),t&&"function"!==typeof t&&(t=null),Array.isArray(e)?t?this.where((function(r){return e.any((function(e){return t(r,e)}))})):this.where((function(t){return r&&"string"===typeof t&&(t=t.toLowerCase()),e.indexOf(t)>-1})):void 0},Array.prototype.skip=function(e){e<0&&(e=0);for(var t=[],r=e;r<this.length;r++)t.push(this[r]);return t},Array.prototype.take=function(e){for(var t=[],r=0;r<this.length&&r<e;r++)t.push(this[r]);return t},Array.prototype.union=function(e){var t=[];if(e?Array.isArray(e)&&(t=this):e=this,Array.isArray(e))for(var r=0;r<e.length;r++)t.addRange(e[r]);else this.forEach((function(r,n){var a=e(r,n);a&&t.addRange(a)}));return t},Array.prototype.remove=function(e){if("function"===typeof e){for(var t=0;t<this.length;t++)if(e(this[t]))return this.splice(t,1),!0}else{var r=this.indexOf(e);if(r>-1)return this.splice(r,1),!0}},Array.prototype.contains=function(e){return this.indexOf(e)>-1},Array.prototype.asyncForEach=function(){var e=Object(d.a)(l.a.mark((function e(t){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0;case 1:if(!(r<this.length)){e.next=7;break}return e.next=4,t(this[r],r);case 4:r++,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),Array.prototype.containsAny=function(e){var t=this;return!(!e||!Array.isArray(e))&&e.any((function(e){return t.indexOf(e)>=0}))},Array.prototype.innerJoin=function(e,t){for(var r=this,n=[],a=function(a){var i=r[a],s=e.where((function(e){return t(i,e)}));s.length>0&&s.forEach((function(e){n.push({left:i,right:e})}))},i=0;i<this.length;i++)a(i);return n},Array.prototype.leftJoin=function(e,t){for(var r=this,n=[],a=function(a){var i=r[a],s=e.where((function(e){return t(i,e)}));0===s.length?n.push({left:i,right:null}):s.forEach((function(e){n.push({left:i,right:e})}))},i=0;i<this.length;i++)a(i);return n},Array.prototype.rightJoin=function(e,t){for(var r=this,n=[],a=function(a){var i=e[a],s=r.where((function(e){return t(e,i)}));0===s.length?n.push({left:null,right:i}):s.forEach((function(e){n.push({left:e,right:i})}))},i=0;i<e.length;i++)a(i);return n},Array.prototype.toKeyValuePair=function(e,t){for(var r=this.groupBy(e,t),n={},a=0;a<r.length;a++){var i=r[a];n["".concat(i.key)]=i.values}return n},Array.prototype.findAllIndex=function(e,t){for(var r=[],n=0;n<this.length&&(!t||t>r.length);n++)e(this[n],n)&&(r[r.length]=n);return r},Array.prototype.flattern=function(e,t,r,n){for(var a=this.length,i=[],s=0;s<a;s++){m(this[s],e,r?Object(u.a)({},r):{},n).forEach((function(e){t&&!t(e)||i.push(e)}))}return i};r(137);var k=r(75),b=r(68);window.ga=window.ga||function(){(window.ga.q=window.ga.q||[]).push(arguments)};var w=window.ga;if(w.l=+new Date,w("create","UA-108841109-1","auto"),w("set","checkProtocolTask",null),"oAuthHandler"===window.name){var j=window.opener;if(j)(0,j.oAuthHandler)(window.location.hash),window.close()}s.a.render(a.a.createElement(b.HashRouter,null,a.a.createElement(k.b,null)),document.getElementById("root"))},35:function(e,t,r){"use strict";r.d(t,"b",(function(){return n.a})),r.d(t,"a",(function(){return be}));var n=r(9),a=r(0),i=r.n(a),s=r(8),o=r(56),u=r(4),c=r(12),l=r(5),d=r(6),h=r(22),f=r.n(h),p=r(10),g=!!window.opr&&!!window.opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0,v="undefined"!==typeof InstallTrigger,m=!!!document.documentMode&&!!window.StyleMedia,y=!!window.chrome&&(!!window.chrome.webstore||!!window.chrome.runtime)&&!v,k={isChrome:y,isFirefox:v,isEdge:m,isOpera:g},b=function(){if(y)return"chrome";if(v)return"firefox";if(m)return"edge";if(g)return"opera"}();var w=function(){function e(t,r,n){Object(l.a)(this,e),this.$session=t,this.$message=r,this.$browser=n;var a={"Content-Type":"application/json"};(k.isFirefox||k.isEdge)&&(a["User-Agent"]="Chrome"),this.httpOptions={headers:a}}return Object(d.a)(e,[{key:"prepareUrl",value:function(e,t){this._basePath=this.$session.rootUrl,this._basePath.endsWith("/")||(this._basePath+="/");var r=e.toString();return t&&Array.isArray(t)&&1===t.length&&"object"===Object(c.a)(t[0])&&(t=t[0]),t&&Array.isArray(t)&&t.length>0?r=r.format(t):t&&"object"===Object(c.a)(t)&&(r=Object(p.j)(r,t)),r.startsWith("~/")?this._basePath+r.substring(2):r}},{key:"handler",value:function(e,t){var r=this;return e.then(null,(function(e){t||0!==e.status||r.$message.error("Unable to connect to server. Please check your network connectivity.","Network error");var n=e.responseJSON,a=e.responseText,i=e.status;return Promise.reject({error:n,response:a,status:i,ref:e})}))}},{key:"request",value:function(e,t,r,n,a){return this.handler(this.execute(e,this.prepareUrl(t,r),r,n),a)}},{key:"execute",value:function(){var e=Object(u.a)(i.a.mark((function e(t,r,n,a){var u,c,l,d,h,p,g=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=n,"GET"===(t||"GET").toUpperCase()?u=void 0:n=void 0,l=(c=a||{}).withCredentials,d=c.needsPermission,h=c.json,p=Object(o.a)(c,["withCredentials","needsPermission","json"]),e.t0=!1!==d,!e.t0){e.next=8;break}return e.next=7,this.$browser.requestPermission(null,r);case 7:e.t0=!e.sent;case 8:if(!e.t0){e.next=10;break}console.warn("Permission not granted for ".concat(r,"."));case 10:return e.abrupt("return",new Promise((function(e,n){f.a.ajax({type:t,url:r,data:JSON.stringify(u),success:e,error:n,dataType:!1!==h?"json":void 0,xhrFields:{withCredentials:!1!==l},beforeSend:function(e){var t=g.httpOptions.headers,r=Object(s.a)(Object(s.a)({},t),p);Object.keys(r).forEach((function(t){return e.setRequestHeader(t,r[t])}))}})})));case 11:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"get",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return this.handler(this.execute("GET",this.prepareUrl(e,r)))}},{key:"post",value:function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];return this.handler(this.execute("POST",this.prepareUrl(e,n),t))}},{key:"put",value:function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),a=2;a<r;a++)n[a-2]=arguments[a];return this.handler(this.execute("PUT",this.prepareUrl(e,n),t))}},{key:"delete",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return this.handler(this.execute("DELETE",this.prepareUrl(e,r)))}}]),e}();w.dependencies=["SessionService","MessageService","AppBrowserService"];var j=r(1),S=function(){function e(t,r){var n=this;Object(l.a)(this,e),t.getAppVersion().then((function(e){n.versionNumber=e||j.d}),(function(){return n.versionNumber=j.d})),this.$ajax=r}return Object(d.a)(e,[{key:"send",value:function(e){var t,r,n=document.location.origin,a=window.screen,i=a.availHeight,o=a.availWidth,u=a.height,c=a.width,l=a.pixelDepth,d=Object(s.a)(Object(s.a)({v:1,tid:j.a,uid:this.JAInstId,ul:null===(t=navigator)||void 0===t||null===(r=t.language)||void 0===r?void 0:r.toLowerCase(),de:document.charset,sd:"".concat(l,"-bit"),td:document.title,dh:n,dl:n,sr:"".concat(o,"x").concat(i),vp:"".concat(c,"x").concat(u)},this.getPageView(this.currentPage)),e),h=this.$ajax.prepareUrl(j.b,d),f=document.createElement("img");f.onload=$,f.onerror=$,f.width=1,f.height=1,f.src=h,document.body.append(f)}},{key:"getPageView",value:function(e){return{t:"pageview",dp:e}}},{key:"getEventObject",value:function(e,t,r,n){var a={t:"event",ec:e,ea:t};return r&&(a.el=r),n&&(a.ev=n),a}},{key:"setIfEnabled",value:function(e,t){this.enableLogging=e,this.enableExceptionLogging=t}},{key:"setUserId",value:function(e){e&&(this.JAInstId=e,window.ga("set","userId",e))}},{key:"trackEvent",value:function(e,t,r,n){if(!this.enableLogging)return!1;r=r||this.getCurrentRouteUrl(),window.ga("send","event",t,e,r,n),this.send(this.getEventObject(t,e,r,n))}},{key:"trackError",value:function(e,t){if(!this.enableExceptionLogging)return!1;var r=this.getExceptionDetails(e);window.ga("send","exception",{exDescription:r,exFatal:t||!1}),this.send({t:"exception",exd:r,exf:t?1:0})}},{key:"getExceptionDetails",value:function(e){if(!e)return"Error occured:- ".concat(Object(c.a)(e));if("object"!==Object(c.a)(e))return this.searilizeObj(e);if(e.promise&&e.reason){var t=e.reason;e={status:t.status,response:t.response}}try{return JSON.stringify(e)}catch(r){return this.searilizeObj(e)}}},{key:"searilizeObj",value:function(e,t){var r=this;t=t||0;try{var n=Object.keys(e).reduce((function(n,a){var i=e[a];if("object"===Object(c.a)(i)){if(a.startsWith("_")||t>0)return n;i=r.searilizeObj(i,t+1)}return n[a]=i,n}),{});return t?n:JSON.stringify(n)}catch(a){return"Unknown error: Unable to searilize"}}},{key:"getCurrentRouteUrl",value:function(){var e=document.location.hash.substring(1);return"/"===e&&(e="/dashboard"),e}},{key:"trackPageView",value:function(e){if(!this.enableLogging)return!1;e||(e=this.getCurrentRouteUrl());try{var t=e.split("/");isNaN(t[1])||(e=e.substring(t[1].length+1))}catch(r){console.error("Error tracking",r)}e="v".concat(this.versionNumber,"/index.html").concat(e),this.currentPage=e,window.ga("set","page",e),window.ga("send","pageview",e),this.send(this.getPageView(e))}}]),e}();function $(){this.remove()}S.dependencies=["AppBrowserService","AjaxService"];var O=r(15),x=r(16),U=function(){function e(){Object(l.a)(this,e)}return Object(d.a)(e,[{key:"requestPermission",value:function(){var e=Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"hasPermission",value:function(){var e=Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),A=function(e){Object(O.a)(r,e);var t=Object(x.a)(r);function r(){var e;return Object(l.a)(this,r),(e=t.call(this)).notSetting={init:function(){e.notSetting.curShowing||(e.chrome.notifications.onButtonClicked.addListener(e.notSetting.buttonClicked),e.chrome.notifications.onClicked.addListener(e.notSetting.onClicked),e.chrome.notifications.onClosed.addListener(e.notSetting.onClosed),e.notSetting.curShowing={})},buttonClicked:function(t,r){var n=e.notSetting.curShowing[t];if(n){var a=n.buttons[r];a&&a.onClick?a.onClick():alert("This functionality is not yet implemented!"),e.chrome.notifications.clear(t)}},onClicked:function(t,r){var n=e.notSetting.curShowing[t];n&&n.onClicked&&n.onClicked(r)},onClosed:function(t,r){var n=e.notSetting.curShowing[t];n&&(delete e.notSetting.curShowing[t],n.onClosed&&n.onClosed(r))},show:function(t,r,n,a,i){var s={type:"basic",iconUrl:"/img/icon_48.png",title:r,message:n,contextMessage:a,isClickable:!0,requireInteraction:!0,buttons:[]};i.buttons&&(s.buttons=i.buttons.map((function(e){return{title:e.title}}))),e.chrome.notifications.create(t,s,(function(r){e.notSetting.curShowing[t]=i}))}},e.$window=window,e.chrome=e.$window.chrome,e}return Object(d.a)(r,[{key:"getCurrentUrl",value:function(){var e=Object(u.a)(i.a.mark((function e(){var t=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.hasPermission({permissions:["activeTab"]});case 2:if(e.sent){e.next=6;break}return console.log("Jira Assistant do not have access to retrive the current url"),e.abrupt("return","");case 6:return e.abrupt("return",new Promise((function(e,r){t.chrome.tabs.query({active:!0,lastFocusedWindow:!0},(function(t){t&&t[0]&&t[0].url?e(t[0].url):r("Unable to fetch the url")}))})));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCurrentTab",value:function(){var e=Object(u.a)(i.a.mark((function e(){var t=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.hasPermission({permissions:["activeTab"]});case 2:if(e.sent){e.next=6;break}return console.log("Jira Assistant do not have access to retrive current tab"),e.abrupt("return",null);case 6:return e.abrupt("return",new Promise((function(e,r){t.chrome.tabs.query({active:!0,lastFocusedWindow:!0},(function(t){t&&t[0]?e(t[0]):r("Unable to fetch the tab")}))})));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"hasPermission",value:function(e){var t=this;return new Promise((function(r){t.chrome.permissions.contains(e,r)}))}},{key:"requestPermission",value:function(){var e=Object(u.a)(i.a.mark((function e(t,r){var n,a=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=this.getPermissionObj(t,r),e.next=4,this.hasPermission(n);case 4:if(!e.sent){e.next=9;break}return e.abrupt("return",!0);case 9:return console.log("Requesting permission for: ",n),e.abrupt("return",new Promise((function(e){a.chrome.permissions.request(n,e)})));case 11:e.next=16;break;case 13:return e.prev=13,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 16:case"end":return e.stop()}}),e,this,[[0,13]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getPermissionObj",value:function(e,t){e||(e=["tabs"]);var r={permissions:e};return t&&(r.origins=[Object(p.c)(t)]),r}},{key:"replaceTabUrl",value:function(e){var t=this;return this.getCurrentTab().then((function(r){t.chrome.tabs.update(r.id,{url:e})}))}},{key:"openTab",value:function(e){window.open(e)}},{key:"getStorage",value:function(){return this.chrome.storage?this.chrome.storage.local:localStorage}},{key:"getStorageInfo",value:function(){return navigator.storage.estimate().then((function(e){var t=e.usage,r=e.quota;return{totalSpace:r,usedSpace:t,freeSpace:r-t,usedSpacePerc:Math.round(100*t/r)}}))}},{key:"getAppInfo",value:function(){var e=this;return new Promise((function(t,r){var n=e.chrome.management;n&&n.getSelf((function(n){n?(n.isDevelopment=n.installType===e.chrome.management.ExtensionInstallType.DEVELOPMENT,t(n)):r(n)}))}))}},{key:"getAppVersion",value:function(){return this.getAppInfo().then((function(e){return e.version}),(function(){return j.d.toString()}))}},{key:"getAppLongName",value:function(){return this.chrome.app.getDetails().name}},{key:"notify",value:function(e,t,r,n,a){this.notSetting.init(),this.notSetting.show(e,t,r,n,a)}},{key:"addCmdListener",value:function(e){this.chrome.commands.onCommand.addListener(e)}},{key:"getAuthToken",value:function(e){var t=this;return new Promise((function(r,n){t.chrome.identity.getAuthToken(e,(function(e){t.chrome.runtime.lastError||!e?(console.error("GCalendar intergation failed",e,t.chrome.runtime.lastError.message),n({error:t.chrome.runtime.lastError,tokken:e})):r(e)}))}))}},{key:"getRedirectUrl",value:function(e){return this.chrome.identity.getRedirectURL(e)}},{key:"launchWebAuthFlow",value:function(e){var t=this;return new Promise((function(r){t.chrome.identity.launchWebAuthFlow(e,r)}))}},{key:"removeAuthTokken",value:function(e){this.chrome.identity.removeCachedAuthToken({token:e},(function(){}))}},{key:"getStoreUrl",value:function(e){return j.e+(e?"/reviews":"")}},{key:"extractAccessToken",value:function(e){var t=e.match(/[#?](.*)/);return!t||t.length<1?null:new URLSearchParams(t[1].split("#")[0]).get("access_token")}}]),r}(U),C=function(e){Object(O.a)(r,e);var t=Object(x.a)(r);function r(){var e;return Object(l.a)(this,r),(e=t.call(this)).notSetting={init:function(){e.notSetting.curShowing||(e.chrome.notifications.onButtonClicked.addListener(e.notSetting.buttonClicked),e.chrome.notifications.onClicked.addListener(e.notSetting.onClicked),e.chrome.notifications.onClosed.addListener(e.notSetting.onClosed),e.notSetting.curShowing={})},buttonClicked:function(t,r){var n=e.notSetting.curShowing[t];if(n){var a=n.buttons[r];a&&a.onClick?a.onClick():alert("This functionality is not yet implemented!"),e.chrome.notifications.clear(t)}},onClicked:function(t,r){var n=e.notSetting.curShowing[t];n&&n.onClicked&&n.onClicked(r)},onClosed:function(t,r){var n=e.notSetting.curShowing[t];n&&(delete e.notSetting.curShowing[t],n.onClosed&&n.onClosed(r))},show:function(t,r,n,a,i){var s={type:"basic",iconUrl:"/img/icon_48.png",title:r,message:n,contextMessage:a,isClickable:!0,requireInteraction:!0,buttons:[]};i.buttons&&(s.buttons=i.buttons.map((function(e){return{title:e.title}}))),e.chrome.notifications.create(t,s,(function(r){e.notSetting.curShowing[t]=i}))}},e.$window=window,e.chrome=e.$window.chrome,e}return Object(d.a)(r,[{key:"getCurrentUrl",value:function(){var e=this;return new Promise((function(t,r){e.chrome.tabs.query({active:!0,lastFocusedWindow:!0},(function(e){e&&e[0]&&e[0].url?t(e[0].url):r("Unable to fetch the url")}))}))}},{key:"getCurrentTab",value:function(){var e=this;return new Promise((function(t,r){e.chrome.tabs.query({active:!0,lastFocusedWindow:!0},(function(e){e&&e[0]?t(e[0]):r("Unable to fetch the tab")}))}))}},{key:"replaceTabUrl",value:function(e){var t=this;return this.getCurrentTab().then((function(r){t.chrome.tabs.update(r.id,{url:e})}))}},{key:"openTab",value:function(e){window.browser.tabs.create({url:e})}},{key:"getStorage",value:function(){return this.chrome.storage?this.chrome.storage.local:localStorage}},{key:"getStorageInfo",value:function(){return navigator.storage.estimate().then((function(e){var t=e.usage,r=e.quota;return{totalSpace:r,usedSpace:t,freeSpace:r-t,usedSpacePerc:Math.round(100*t/r)}}))}},{key:"getAppInfo",value:function(){var e=window.browser;return e?e.management.getSelf().then((function(e){return e.isDevelopment=e.installType===window.browser.management.ExtensionInstallType.DEVELOPMENT,e})):Promise.reject(null)}},{key:"getAppVersion",value:function(){return this.getAppInfo().then((function(e){return e.version}),(function(){return j.d.toString()}))}},{key:"getAppLongName",value:function(){return"Jira Assistant"}},{key:"notify",value:function(e,t,r,n,a){this.notSetting.init(),this.notSetting.show(e,t,r,n,a)}},{key:"addCmdListener",value:function(e){this.chrome.commands.onCommand.addListener(e)}},{key:"getAuthToken",value:function(e){var t=this,r=window.browser.identity.getRedirectURL(),n="https://accounts.google.com/o/oauth2/auth?client_id=".concat("692513716183-jm587gc534dvsere4qhnk5bj68pql3p9.apps.googleusercontent.com","&response_type=token&redirect_uri=").concat(encodeURIComponent(r),"&scope=").concat(encodeURIComponent(["https://www.googleapis.com/auth/calendar.readonly"].join(" ")));return window.browser.identity.launchWebAuthFlow({interactive:e.interactive,url:n}).then((function(e){return t.extractAccessToken(e)}))}},{key:"getRedirectUrl",value:function(e){return this.chrome.identity.getRedirectURL(e)}},{key:"launchWebAuthFlow",value:function(e){var t=this;return new Promise((function(r){t.chrome.identity.launchWebAuthFlow(e,r)}))}},{key:"removeAuthTokken",value:function(e){window.browser.identity.removeCachedAuthToken({token:e},(function(){}))}},{key:"getStoreUrl",value:function(e){return j.j}},{key:"extractAccessToken",value:function(e){var t=e.match(/[#?](.*)/);return!t||t.length<1?null:new URLSearchParams(t[1].split("#")[0]).get("access_token")}}]),r}(U),D=function(e){Object(O.a)(r,e);var t=Object(x.a)(r);function r(){var e;return Object(l.a)(this,r),(e=t.call(this)).notSetting={init:function(){e.notSetting.curShowing||(e.browser.notifications.onButtonClicked.addListener(e.notSetting.buttonClicked),e.browser.notifications.onClicked.addListener(e.notSetting.onClicked),e.browser.notifications.onClosed.addListener(e.notSetting.onClosed),e.notSetting.curShowing={})},buttonClicked:function(t,r){var n=e.notSetting.curShowing[t];if(n){var a=n.buttons[r];a&&a.onClick?a.onClick():alert("This functionality is not yet implemented!"),e.browser.notifications.clear(t)}},onClicked:function(t,r){var n=e.notSetting.curShowing[t];n&&n.onClicked&&n.onClicked(r)},onClosed:function(t,r){var n=e.notSetting.curShowing[t];n&&(delete e.notSetting.curShowing[t],n.onClosed&&n.onClosed(r))},show:function(t,r,n,a,i){var s={type:"basic",iconUrl:"/img/icon_48.png",title:r,message:n,contextMessage:a,isClickable:!0,requireInteraction:!0,buttons:[]};i.buttons&&(s.buttons=i.buttons.map((function(e){return{title:e.title}}))),e.browser.notifications.create(t,s,(function(r){e.notSetting.curShowing[t]=i}))}},e.$window=window,e.browser=e.$window.browser,e}return Object(d.a)(r,[{key:"getCurrentUrl",value:function(){return this.getCurrentTab().then((function(e){return e&&e.url?e.url:Promise.reject("Unable to fetch the url")}))}},{key:"getCurrentTab",value:function(){var e=this;return new Promise((function(t,r){e.browser.tabs.query({active:!0,lastFocusedWindow:!0},(function(e){e&&e[0]?t(e[0]):r("Unable to fetch the tab")}))}))}},{key:"replaceTabUrl",value:function(e){var t=this;return this.getCurrentTab().then((function(r){t.browser.tabs.update(r.id,{url:e})}))}},{key:"openTab",value:function(e){this.browser.tabs.create({url:e,active:!0})}},{key:"getStorage",value:function(){return this.browser.storage?this.browser.storage.local:localStorage}},{key:"getStorageInfo",value:function(){return navigator.storage.estimate().then((function(e){var t=e.usage,r=e.quota;return{totalSpace:r,usedSpace:t,freeSpace:r-t,usedSpacePerc:Math.round(100*t/r)}}))}},{key:"getAppInfo",value:function(){var e=this;return new Promise((function(t,r){var n=e.browser.management;n?n.getSelf((function(n){n?(n.isDevelopment=n.installType===e.browser.management.ExtensionInstallType.DEVELOPMENT,t(n)):r(n)})):r("Extension do not have access to management api")}))}},{key:"getAppVersion",value:function(){var e=Object(u.a)(i.a.mark((function e(){var t,r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",(null===(t=this.browser)||void 0===t||null===(r=t.runtime)||void 0===r||null===(n=r.getManifest())||void 0===n?void 0:n.version)||"1.5");case 4:return e.prev=4,e.t0=e.catch(0),e.abrupt("return",this.getAppInfo().then((function(e){return null===e||void 0===e?void 0:e.version}),(function(){return"1.5"})));case 7:case"end":return e.stop()}}),e,this,[[0,4]])})));return function(){return e.apply(this,arguments)}}()},{key:"getAppLongName",value:function(){return this.browser.app.getDetails().name}},{key:"notify",value:function(e,t,r,n,a){this.notSetting.init(),this.notSetting.show(e,t,r,n,a)}},{key:"addCmdListener",value:function(e){this.browser.commands.onCommand.addListener(e)}},{key:"getAuthToken",value:function(e){var t=this;return new Promise((function(r,n){t.browser.identity.getAuthToken(e,(function(e){t.browser.runtime.lastError||!e?(console.error("GCalendar intergation failed",e,t.browser.runtime.lastError.message),n({error:t.browser.runtime.lastError,tokken:e})):r(e)}))}))}},{key:"getRedirectUrl",value:function(e){return""}},{key:"launchWebAuthFlow",value:function(e){var t=this;return new Promise((function(r){t.browser.identity.launchWebAuthFlow(e,r)}))}},{key:"removeAuthTokken",value:function(e){this.browser.identity.removeCachedAuthToken({token:e},(function(){}))}},{key:"getStoreUrl",value:function(e){return j.h+(e?"/reviews":"")}},{key:"extractAccessToken",value:function(e){var t=e.match(/[#?](.*)/);return!t||t.length<1?null:new URLSearchParams(t[1].split("#")[0]).get("access_token")}}]),r}(U),I=r(3),T=r.n(I),E=function(){function e(t,r,n,a){Object(l.a)(this,e),this.$user=t,this.$cache=r,this.$session=n,this.$jira=a}return Object(d.a)(e,[{key:"getCurrentUser",value:function(){var e=Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$user.getUser(this.$session.getCurrentUserId());case 2:return t=e.sent,this.rootUrl=t.jiraUrl,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getUserDetails",value:function(){var e=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t||(t=this.$session.getCurrentUserId()),e.next=7;break;case 4:return e.prev=4,e.t0=e.catch(0),e.abrupt("return",Promise.reject({needIntegration:!0}));case 7:return e.next=9,this.$user.getUserDetails(t);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e,this,[[0,4]])})));return function(t){return e.apply(this,arguments)}}()},{key:"authenticate",value:function(){var e=Object(u.a)(i.a.mark((function e(t){var r=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getUserDetails(t).then(function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.$session.CurrentUser=t,r.$session.userId=t.userId,r.$session.rootUrl=(t.jiraUrl||"").toString(),e.next=5,r.$jira.getCurrentUser();case 5:return n=e.sent,t.jiraUser=n,t.displayName=n.displayName||"(not available)",t.name=Object(p.e)(n)||"(not available)",t.emailAddress=n.emailAddress||"(not available)",r.$session.authenticated=!0,e.abrupt("return",t);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){var t=e.settings;r.$session.pageSettings={dashboard:r.parseIfJson(t.page_dashboard,{viewMode:0,gridList:["myTickets","bookmarksList","dtWiseWL","pendingWL"]}),calendar:r.parseIfJson(t.page_calendar,{viewMode:"timeGridWeek",showWorklogs:!0,showMeetings:!0,showInfo:!0,eventColor:"#51b749",worklogColor:"#9a9cff",infoColor_valid:"#3a87ad",infoColor_less:"#f0d44f",infoColor_high:"#f06262"}),reports_UserDayWise:r.parseIfJson(t.page_reports_UserDayWise,{logFormat:"1",breakupMode:"1",groupMode:"1"})};var n=r.$cache.get("LV");return n&&(n=I(n),I().startOf("day").isAfter(n)&&r.$cache.set("LastVisited",n.toDate())),r.$cache.set("LV",new Date),!0})).then(null,(function(e){return r.$session.authenticated=!1,401===e.status||(r.$session.needIntegration=e.needIntegration),!1}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"parseIfJson",value:function(e,t){return e?"string"===typeof e?JSON.parse(e):e:t}}]),e}();E.dependencies=["UserService","CacheService","SessionService","JiraService"];var L=function(){function e(t,r,n,a,i,s){Object(l.a)(this,e),this.$user=t,this.$session=r,this.$message=n,this.$ticket=a,this.$userutils=i,this.$analytics=s}return Object(d.a)(e,[{key:"addBookmark",value:function(e,t){var r=this;return e&&0!==e.length?(this.$analytics.trackEvent("Bookmark ticket",j.i.UserActions),this.$user.getUser(this.$session.userId).then((function(n){var a=n.favTicketList;a||(a=[]);var i=e.filter((function(e){return!a.some((function(t){return t.toUpperCase()===e.toUpperCase()}))}));return 0===i.length?(r.$message.warning(1===e.length?"".concat(e[0]," is already bookmarked"):"The specified ticket is already bookmarked"),[]):r.$ticket.getTicketDetails(i,!0).then((function(i){return i&&0!==i.length?(i.forEach((function(e){return a.push(e.key)})),n.favTicketList=a,r.$user.saveUser(n).then((function(){return t&&r.$message.success("Ticket(s) bookmarked successfully!"),e.filter((function(e){return!a.some((function(t){return t.toUpperCase()===e.toUpperCase()}))}))}))):e}))}))):(this.$message.warning("No ticket number specified to bookmark"),Promise.reject("No ticket number specified to bookmark"))}},{key:"removeBookmark",value:function(e){var t=this;return"string"===typeof e&&(e=[e]),this.$analytics.trackEvent("Remove bookmark",j.i.UserActions),this.$user.getUser(this.$session.userId).then((function(r){var n=r.favTicketList;return n||(n=[]),n.removeAll(e),r.favTicketList=n,t.$user.saveUser(r).then((function(){return t.getBookmarks()}))}))}},{key:"getBookmarks",value:function(){var e=this;return this.$user.getUser(this.$session.userId).then((function(t){var r=t.favTicketList;return r&&r.length>0?e.$ticket.getTicketDetails(r,!0).then((function(t){return t.map((function(t){var r=t.fields||{};return{ticketNo:t.key,summary:r.summary||"(unavailable)",assigneeName:(r.assignee||"").displayName,reporterName:(r.reporter||"").displayName,issuetype:(r.issuetype||{}).name,issuetypeIcon:(r.issuetype||{}).iconUrl,priority:(r.priority||{}).name,priorityIcon:(r.priority||{}).iconUrl,statusIcon:(r.status||{}).iconUrl,status:(r.status||{}).name,resolutionIcon:(r.resolution||{}).iconUrl,resolution:(r.resolution||{}).name,createdSortable:r.created,updatedSortable:r.updated,created:e.$userutils.formatDateTime(r.created),updated:e.$userutils.formatDateTime(r.updated)}}))}),(function(t){var n=((t.error||{}).errorMessages||[])[0];if(n&&n.indexOf("does not exist")){var a=r.filter((function(e){return n.indexOf(e)>-1}));if(a.length>0)return e.removeBookmark(a)}return[]})):[]}))}}]),e}();L.dependencies=["UserService","SessionService","MessageService","TicketService","UserUtilsService","AnalyticsService"];var M=function(){function e(t,r){var n=this;Object(l.a)(this,e),this.$jaBrowserExtn=t,this.$utils=r,this.varStorage={},this.reISO=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/,this.session={set:function(e,t){if(e)return t?n.varStorage[e]=t:delete n.varStorage[e],t},get:function(e){return n.varStorage[e]},getPromise:function(e){return new Promise((function(t,r){return t(n.session.get(e))}))},clear:function(){n.varStorage={}}},this.lob={set:function(e,t,r){if(e){if(t)if(t={value:t},r&&("number"===typeof r&&r>0?t.expires=I().add(r,"days").toDate():r instanceof Date?t.expires=r:I.isMoment(r)&&(t.expires=r.toDate())),n.storage.set){var a={};a[e]=t,n.storage.set(a)}else n.storage[e]=t;else n.storage.remove(e);return t}},get:function(e){return new Promise((function(t,r){var a=function(r){if(r&&(r=r[e])){if(r.expires)I(r.expires).diff(I())>0&&(r.value=null);r=r.value}t(r)};n.storage.get?n.storage.get(e,a):a(n.storage[e])}))},remove:function(e){n.lob.set(e,null)},clear:function(){n.storage.clear()}},this.storage=t.getStorage()}return Object(d.a)(e,[{key:"set",value:function(e,t,r,n){if(e)return t?(n||(t={value:t},r&&("number"===typeof r&&r>0?t.expires=I().add(r,"days").toDate():r instanceof Date?t.expires=r:I.isMoment(r)&&(t.expires=r.toDate())),t=this.stringify(t)),"object"===Object(c.a)(t)&&(t=this.stringify(t)),localStorage.setItem(e,t)):localStorage.removeItem(e),t}},{key:"get",value:function(e,t){var r=localStorage.getItem(e);if(t)return r;if(r){if((r=this.parse(r)).expires)I(r.expires).isBefore(new Date)&&(r.value=null);r=r.value}return r}},{key:"remove",value:function(e){this.set(e,null,null)}},{key:"clear",value:function(){localStorage.clear()}},{key:"parse",value:function(e){var t=this;return JSON.parse(e,(function(e,r){return r&&"string"===typeof r&&r.startsWith("/Date(")?t.$utils.convertDate(r):r}))}},{key:"stringify",value:function(e){var t=this;return JSON.stringify(e,(function(e,r){return r&&r instanceof Date?"/Date(".concat(r.getTime(),")/"):r&&"string"===typeof r&&t.reISO.test(r)?"/Date(".concat(new Date(r).getTime(),")/"):r}))}}]),e}();M.dependencies=["AppBrowserService","UtilsService"];var P=function(){function e(t,r,n,a){Object(l.a)(this,e),this.$jaBrowserExtn=t,this.$analytics=r,this.$config=n,this.$message=a,this.CALENDAR_EVENTS_API_URL="https://www.googleapis.com/calendar/v3/calendars/{calendarId}/events?"}return Object(d.a)(e,[{key:"authenticate",value:function(){var e=Object(u.a)(i.a.mark((function e(t){var r=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$jaBrowserExtn.requestPermission(["identity"]);case 2:if(e.sent){e.next=4;break}return e.abrupt("return",!1);case 4:return e.abrupt("return",this.$jaBrowserExtn.getAuthToken({interactive:!0===t}).then((function(e){return r.$config.updateAuthCode({access_token:e}).then((function(){return e}))})));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getEvents",value:function(e,t,r){var n=this;r=r||{};var a=this.CALENDAR_EVENTS_API_URL.replace("{calendarId}",encodeURIComponent(r.calendar||"primary"))+["showDeleted=false","singleEvents=true","timeMin=".concat(encodeURIComponent(e.toDate().toISOString())),"timeMax=".concat(encodeURIComponent(t.toDate().toISOString())),"maxResults=".concat(r.maxResults||1e3),"orderBy=startTime","singleEvents=true"].join("&"),i=function(e){return new Promise((function(t,r){h.ajax(a,{headers:{Authorization:"Bearer ".concat(e)},success:function(e){t(e.items.map((function(e){return{id:e.id,start:e.start.dateTime||I(e.start.date,"yyyy-MM-dd").toDate(),end:e.end.dateTime||I(e.end.date,"yyyy-MM-dd").toDate(),title:e.summary,url:e.hangoutLink,entryType:2,sourceObject:e,source:"google",editable:!1,allDay:!e.start.dateTime}}))),n.$analytics.trackEvent("Fetch calendar data")},error:function(t){n.$analytics.trackEvent("Authentication error :-".concat((t||"").status||"")),t&&401===t.status?(n.$message.warning("Authenticated session with the Google Calendar has expired. You will have to reauthenticate."),n.$jaBrowserExtn.removeAuthTokken(e)):n.$message.error("Unknown error occured while trying to fetch the calendar data."),r(t)}})}))};return this.authenticate().then(i,(function(e){if(e.error&&e.error.message&&e.error.message.toLowerCase().indexOf("invalid credentials"))return n.$message.warning("Authentication with google calendar has expired. You will have to reauthenticate to proceed!"),n.$analytics.trackEvent("Calendar auto reauthenticate"),n.authenticate(!0).then(i)}))}}]),e}();P.dependencies=["AppBrowserService","AnalyticsService","ConfigService","MessageService"];var F=function(){function e(t,r,n,a,i,s,o){Object(l.a)(this,e),this.$session=t,this.$auth=r,this.$db=n,this.$ajax=a,this.$utils=i,this.$jaBrowserExtn=s,this.$message=o}return Object(d.a)(e,[{key:"saveSettings",value:function(e,t){var r=this;return this.$auth.getCurrentUser().then((function(n){return n.settings||(n.settings={}),void 0===t&&(t=r.$session.pageSettings[e]),n.settings["page_".concat(e)]=t,r.$db.users.put(n).then((function(e){return e}))}))}},{key:"updateAuthCode",value:function(e){var t=this;return this.$db.users.get(this.$session.userId).then((function(r){return r.dataStore=e,t.$db.users.put(r).then((function(){return!0}))}))}},{key:"getUserSettings",value:function(){var e=this;return this.$auth.getCurrentUser().then((function(t){var r={teamMembers:t.team||[],autoUpload:t.autoUpload,dateFormat:t.dateFormat,maxHours:t.maxHours,workingDays:t.workingDays||[1,2,3,4,5],taskLogEnabled:t.taskLogEnabled,timeFormat:t.timeFormat,uploadLogBy:t.uploadLogBy,meetingTicket:t.meetingTicket,googleIntegration:t.googleIntegration,outlookIntegration:t.outlookIntegration,autoLaunch:t.autoLaunch,notifyBefore:t.notifyBefore,allowClosedTickets:t.allowClosedTickets,checkUpdates:t.checkUpdates,hasGoogleCredentials:!!t.dataStore,hasOutlookCredentials:!!t.outlookStore,pruneInterval:(t.pruneInterval||4).toString(),trackBrowser:t.trackBrowser,startOfDay:t.startOfDay||"10:00",endOfDay:t.endOfDay||"19:00",launchAction:t.launchAction,rapidViews:t.rapidViews,projects:t.projects,storyPointField:t.storyPointField,epicNameField:t.epicNameField,commentLength:t.commentLength,startOfWeek:t.startOfWeek,hideDonateMenu:t.hideDonateMenu,highlightVariance:t.highlightVariance,notifyWL:t.notifyWL||!1!==t.notifyWL};if(r.launchAction&&t.dashboards){var n=t.dashboards.indexOf(t.dashboards.first((function(e){return e.isQuickView})));r.launchAction.quickIndex="D-".concat(n)}var a=new Date;return{settings:r,dateFormats:j.s.map((function(t){return{value:t,text:e.$utils.formatDate(a,t)}})),timeFormats:j.x.map((function(t){return{value:t,text:e.$utils.formatDate(a,t)}}))}}))}},{key:"assignCommonSettingsToUser",value:function(e,t){e.team=t.teamMembers,e.autoUpload=t.autoUpload,e.dateFormat=t.dateFormat,e.maxHours=t.maxHours,e.taskLogEnabled=t.taskLogEnabled,e.timeFormat=t.timeFormat,e.workingDays=t.workingDays,e.uploadLogBy=t.uploadLogBy,e.googleIntegration=t.googleIntegration,e.outlookIntegration=t.outlookIntegration,t.outlookStore&&(e.outlookStore=t.outlookStore),e.notifyWL=t.notifyWL,e.meetingTicket=t.meetingTicket,e.pruneInterval=parseInt(t.pruneInterval||4),e.trackBrowser=t.trackBrowser,e.startOfDay=t.startOfDay,e.endOfDay=t.endOfDay,e.highlightVariance=t.highlightVariance,e.launchAction=t.launchAction,e.allowClosedTickets=t.allowClosedTickets,e.storyPointField=t.storyPointField,e.epicNameField=t.epicNameField,e.commentLength=parseInt(t.commentLength||0),e.startOfWeek=parseInt(t.startOfWeek||0)}},{key:"assignCalendarSettingsToUser",value:function(e,t){var r=this;if(!t.hasGoogleCredentials&&e.dataStore){var n=e.dataStore.access_token;n&&this.$ajax.get(j.c.googleLogoutUrl,n).then((function(){r.$jaBrowserExtn.removeAuthTokken(n)})),delete e.dataStore}!t.hasOutlookCredentials&&e.outlookStore&&(e.outlookStore.access_token&&this.$ajax.get(j.c.outlookLogoutUrl).then((function(){console.log("Signedout from outlook")})),delete e.outlookStore)}},{key:"saveUserSettings",value:function(){var e=Object(u.a)(i.a.mark((function e(t){var r,n,a,s,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$db.users.get(this.$session.userId);case 2:return r=e.sent,this.assignCommonSettingsToUser(r,t),t.hideDonateMenu?r.hideDonateMenu=!0:delete r.hideDonateMenu,r.launchAction&&3===r.launchAction.action&&(n=parseInt((r.launchAction.quickIndex||"0").replace("D-",""))||0,delete r.launchAction.quickIndex,r.dashboards.forEach((function(e,t){return e.isQuickView=t===n}))),this.assignCalendarSettingsToUser(r,t),t.rapidViews&&t.rapidViews.length>0?r.rapidViews=t.rapidViews:delete r.rapidViews,t.projects&&t.projects.length>0?r.projects=t.projects:delete r.projects,(a=parseInt(t.autoLaunch))>0?r.autoLaunch=a:delete r.autoLaunch,(s=parseInt(t.notifyBefore))>0?r.notifyBefore=s:delete r.notifyBefore,(o=parseInt(t.checkUpdates))>0?r.checkUpdates=o:delete r.checkUpdates,r.timeFormat=t.timeFormat,e.next=18,this.$db.users.put(r);case 18:return this.$message.success("Settings saved successfully!"),e.abrupt("return",this.getUserSettings());case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();F.dependencies=["SessionService","AuthService","DatabaseService","AjaxService","UtilsService","AppBrowserService","MessageService"];var W=r(33),N=function(){function e(t,r,n){var a=this;Object(l.a)(this,e),this.saveDashboardInfo=function(){var e=Object(u.a)(i.a.mark((function e(t,r,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.$user.getUser(a.$session.userId).then((function(e){return r?(e.dashboards?e.dashboards[t]=r:e.dashboards=[r],a.saveUserDashboards(e,!0!==n)):(console.error("Unable to save dashboard: ",t,r,n),null)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),this.$session=t,this.$user=r,this.$cache=n,this.updated=function(){}}return Object(d.a)(e,[{key:"onChange",value:function(e){this.updated=e}},{key:"getDashboards",value:function(){return this.$session.CurrentUser.dashboards}},{key:"saveUserDashboards",value:function(){var e=Object(u.a)(i.a.mark((function e(t,r){var n=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$user.saveUser(t).then((function(e){return n.$session.CurrentUser.dashboards=t.dashboards,r||n.updated(t.dashboards),e}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"createDashboard",value:function(){var e=Object(u.a)(i.a.mark((function e(t){var r=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$user.getUser(this.$session.userId).then((function(e){e.dashboards=r.$session.CurrentUser.dashboards,e.dashboards||(e.dashboards=[t]);var n=r.rand(0,j.f.length-1);return e.dashboards.push({icon:j.f[n],layout:1,name:"New Dashboard ".concat(e.dashboards.length+1),widgets:[],isQuickView:!1}),r.saveUserDashboards(e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rand",value:function(e,t){return Math.floor(Math.random()*(t-e+1)+e)}},{key:"deleteDashboard",value:function(e){var t=this;return this.$user.getUser(this.$session.userId).then((function(r){var n=r.dashboards.splice(e,1);return Object(W.a)(n,1)[0].isQuickView&&(r.dashboards[0].isQuickView=!0),t.saveUserDashboards(r)}))}},{key:"setAsQuickView",value:function(e,t){var r=this;e.isQuickView=!0,this.$user.getUser(this.$session.userId).then((function(n){n.dashboards?n.dashboards.forEach((function(e,r){return e.isQuickView=r===t})):n.dashboards=[e];var a=r.$cache.get("menuAction",!0);return a&&(3===(a=JSON.parse(a)).action&&(0===t?delete a.index:a.index=t),r.$cache.set("menuAction",a,!1,!0)),r.saveUserDashboards(n,!0)}))}},{key:"setAsTabView",value:function(e,t){var r=this;e.isTabView=!e.isTabView,this.$user.getUser(this.$session.userId).then((function(n){return n.dashboards?n.dashboards[t].isTabView=e.isTabView:n.dashboards=[e],r.saveUserDashboards(n,!0)}))}}]),e}();N.dependencies=["SessionService","UserService","CacheService"];var B=function(e){Object(O.a)(r,e);var t=Object(x.a)(r);function r(e,n){var a;return Object(l.a)(this,r),(a=t.call(this,"JiraAssist")).$message=n,a.$analytics=e,a.version(1).stores({users:"++id,jiraUrl,userId",savedFilters:"++id,queryName,createdBy",settings:"[name+userId],name,userId",worklogs:"++id,createdBy,isUploaded,dateStarted,worklogId,ticketNo",events:"++id,createdBy,name,ticketNo,startTime,isEnabled,source,sourceId"}),a.open().catch((function(e){a.$analytics.trackError(e,!0),console.error(e)})),a.users.get(1).then((function(e){if(e){var t=e.instId;t||(t=j.r.generate(),e.instId=t,a.users.put(e).then((function(){a.$analytics.trackEvent("User Inst ID added",j.i.Temporary)}))),a.$analytics.setUserId(t),a.$analytics.setIfEnabled(!1!==e.enableAnalyticsLogging,!1!==e.enableExceptionLogging)}else{var r=j.r.generate();a.transaction("rw",a.users,(function(){a.users.add({jiraUrl:"SystemUser",userId:"SystemUser",dateCreated:new Date,instId:r}).then((function(){a.$analytics.setUserId(r),a.$analytics.trackEvent("New installation",j.i.Instance)}))})).catch((function(e){a.reportError(e.message,"database-service.js",32,0,e.stack),console.error("Unable to initialize the database:-",e)}))}})),window.addEventListener("unhandledrejection",(function(e){return a.handleError(e)})),window.addEventListener("rejectionhandled",(function(e){return a.handleError(e)})),window.addEventListener?window.addEventListener("error",(function(e){var t=e||{},r=t.error,n=t.filename,i=t.lineno,s=t.colno,o=t.message,u=(r||{}).stack;a.reportError(o,n,i,s,u),a.$message.error("An unknown error occured while processing your request","Unhandled error",!0),console.error("Global handler:-",e)})):window.onerror=function(e,t,r,n,i){var s=(i||{}).stack;a.reportError(e,t,r,n,s),a.$message.error("An unknown error occured while processing your request","Unhandled error",!0),console.error(e,t,r,n,i)},a}return Object(d.a)(r,[{key:"reportError",value:function(e,t,r,n,a){this.$analytics.trackError({msg:e,url:t,line:r,col:n,stack:a},!0)}},{key:"handleError",value:function(e){var t=e.detail||e;this.$analytics.trackError(t,!1),this.$message.error("One or more of the actions failed","Action error",!0),console.error("Unhandled rejection (promise: ",t.promise||e.promise,", reason: ",t.reason||e.reason,").")}}]),r}(r(59).a);B.dependencies=["AnalyticsService","MessageService"];var V=B,R=function(){function e(t,r,n){Object(l.a)(this,e),this.$jira=t,this.$userutils=r,this.$session=n}return Object(d.a)(e,[{key:"getRescentUpdates",value:function(){var e=Object(u.a)(i.a.mark((function e(){var t,r,n,a,s,o,u,c,l,d,h,f,p,g,v=this,m=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=m.length>0&&void 0!==m[0]?m[0]:7)||(o="-3d"),o instanceof Date?o='"'.concat(T()(o).format("YYYY-MM-DD HH:mm"),'"'):"number"===typeof o&&(o="-".concat(o,"d")),u=((null===(t=this.$session)||void 0===t||null===(r=t.CurrentUser)||void 0===r?void 0:r.jiraUpdatesJQL)||j.u.jiraUpdatesJQL).replace(new RegExp("\\$date\\$","g"),o),c=15,e.next=7,this.$jira.searchTickets(u,["key","lastViewed","updated","changeLog","summary","assignee","reporter","comments"],0,{expand:["changelog"],maxResults:c});case 7:return l=e.sent,d=l.filter((function(e){var t,r,n,a;return(null===(t=e.changelog)||void 0===t?void 0:t.histories)&&(!(null!==(r=e.fields)&&void 0!==r&&r.lastViewed)||T()(null===(n=e.fields)||void 0===n?void 0:n.updated).isAfter(null===(a=e.fields)||void 0===a?void 0:a.lastViewed))})).map((function(e){var t=e.changelog,r=(t=void 0===t?{}:t).histories,n=e.key,a=e.fields;return{key:n,summary:a.summary,assignee:a.assignee,reporter:a.reporter,lastViewed:a.lastViewed,histories:r}})),e.next=11,this.$jira.getCustomFields();case 11:return h=e.sent,f=h.reduce((function(e,t){var r=t.id,n=t.name;return e[r]=n,e}),{}),p=this.extractUpdates(d,null===(n=this.$session.CurrentUser)||void 0===n||null===(a=n.jiraUser)||void 0===a||null===(s=a.emailAddress)||void 0===s?void 0:s.toLowerCase(),f),g=p.groupBy("key").map((function(e){var t=e.key,r=e.values.sortBy("sortBy",!0),n=r[0],a=n.date,i=n.sortBy,s=n.summary,o=n.reason;return{key:t,href:v.$userutils.getTicketUrl(t),date:a,sortBy:i,summary:s,reason:o,updates:r}})),e.abrupt("return",{list:g,total:p.length,ticketCount:g.length});case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"extractUpdates",value:function(e,t,r){var n=[];return e.forEach((function(e){var a,i,s=e.key,o=e.summary,u=e.assignee,c=e.reporter,l=e.lastViewed,d=e.histories,h=e.comments,f="";(null===u||void 0===u||null===(a=u.emailAddress)||void 0===a?void 0:a.toLowerCase())===t?f="assigned to you":(null===c||void 0===c||null===(i=c.emailAddress)||void 0===i?void 0:i.toLowerCase())===t&&(f="reported by you"),null!==d&&void 0!==d&&d.length&&d.forEach((function(e){var a,i=e.author,u=e.created,c=e.items;if(u=u&&T()(u),(null===i||void 0===i||null===(a=i.emailAddress)||void 0===a?void 0:a.toLowerCase())!==t&&(!u||!l||u.isAfter(l))){var d=u.toDate(),h=d.getTime();c.forEach((function(e){var t=e.field,a=e.fromString,u=e.toString;a||(a="NONE"),n.push({date:d,sortBy:h,author:i,field:r[t],fromString:a,toString:u,key:s,summary:o,reason:f})}))}})),null!==h&&void 0!==h&&h.length})),n}}]),e}();R.dependencies=["JiraService","UserUtilsService","SessionService"];var J=function(){function e(t,r,n,a){var i=this;Object(l.a)(this,e),this.jiraErrorHandler=function(e){return 401===e.status?i.$message.warning("You must be authenticated in Jira to access this tool. Please authenticate in Jira and then retry.","Unauthorized"):e.error&&e.error.errorMessages?i.$message.warning(e.error.errorMessages,"Server error"):(e=e.ref||e,i.$message.warning("".concat(e.status,":- ").concat(e.statusText),"Unknown error")),Promise.reject(e)},this.$ajax=t,this.$jaCache=r,this.$message=n,this.$session=a,this.runningRequests={}}return Object(d.a)(e,[{key:"searchTickets",value:function(e,t,r,n){var a=this;return r=r||0,new Promise((function(i,s){var o,u={jql:e,fields:t,maxResults:(null===n||void 0===n?void 0:n.maxResults)||1e3};null!==n&&void 0!==n&&null!==(o=n.expand)&&void 0!==o&&o.length&&(u.expand=n.expand),r>0&&(u.startAt=r),a.$ajax.get(Object(p.j)(j.c.search,u)).then((function(e){var n=e.issues;if(t.indexOf("worklog")>-1){var o=n.length,u=3;!function t(c,l){0===c?i({total:e.total,issues:n,startAt:r}):o>c||--u>=0?(o=c,a.fillWorklogs(l,t)):s(null)}(!1,n),u=3}else i({total:e.total,issues:n,startAt:r})}),(function(e){var t=(e.error||{}).errorMessages;t&&t.length>0&&a.$message.error(t.join("<br/>"),"Error fetching ticket details"),s(e)}))})).then((function(r){var n=r.issues;return n.length+r.startAt<r.total&&n.length>0?a.searchTickets(e,t,r.startAt+n.length).then((function(e){return n.addRange(e)})):n}))}},{key:"getWorklogs",value:function(e){return this.$ajax.get(j.c.issueWorklog,e)}},{key:"getCustomFields",value:function(){var e=Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$jaCache.session.getPromise("customFields");case 2:if(!(t=e.sent)){e.next=5;break}return e.abrupt("return",t);case 5:return e.next=7,this.$ajax.get(j.c.getCustomFields);case 7:return t=e.sent,this.$jaCache.session.set("customFields",t,10),e.abrupt("return",t);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getRapidViews",value:function(){var e=Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$jaCache.session.getPromise("rapidViews");case 2:if(!(t=e.sent)){e.next=5;break}return e.abrupt("return",t);case 5:return e.next=7,this.$ajax.get(j.c.rapidViews);case 7:return t=(t=e.sent).views,this.$jaCache.session.set("rapidViews",t,10),e.abrupt("return",t);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getProjects",value:function(){var e=this,t=this.$jaCache.session.get("projects");return t?new Promise((function(e){return e(t)})):this.$ajax.get(j.c.getAllProjects).then((function(t){return e.$jaCache.session.set("projects",t,10),t}))}},{key:"getIssueTypes",value:function(){var e=this,t=this.$jaCache.session.get("issuetypes");return t?new Promise((function(e,r){return e(t)})):this.$ajax.get(j.c.getAllIssueTypes).then((function(t){return e.$jaCache.session.set("issuetypes",t,10),t}))}},{key:"getProjectImportMetadata",value:function(e){var t=this,r=!1;return"string"===typeof e&&(e=[e],r=!0),e=e.map((function(e){return e.toUpperCase()})),new Promise((function(n,a){var i={},s=[];if(e.forEach((function(e){var r=t.$jaCache.session.get("projectMetadata_".concat(e));r?i[e]=r:s.push(e)})),0!==s.length)return t.$ajax.get(j.c.getProjectImportMetadata+s.join(",")).then((function(t){i=t.projects.reduce((function(e,t){return e[t.key]=t,e}),{}),n(r?i[e[0]]:i)}),a);n(r?i[e[0]]:i)}))}},{key:"getProjectStatuses",value:function(){var e=Object(u.a)(i.a.mark((function e(t){var r,n,a=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!1,"string"===typeof t&&(t=[t],r=!0),t=t.map((function(e){return e.toUpperCase()})),e.next=5,Promise.all(t.map(function(){var e=Object(u.a)(i.a.mark((function e(t){var r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r="projectStatuses_".concat(t),n=a.$jaCache.session.get()){e.next=7;break}return e.next=5,a.$ajax.get(j.c.getProjectStatuses,t);case 5:n=e.sent,a.$jaCache.session.set(r,n);case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:return n=e.sent,e.abrupt("return",r?n[0]:n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getIssueMetadata",value:function(e){return this.$ajax.get(j.c.getIssueMetadata,e)}},{key:"createIssue",value:function(e){return this.$ajax.post(j.c.getIssue,{fields:e})}},{key:"bulkImportIssues",value:function(e){return this.$ajax.post(j.c.bulkImportIssue,{issueUpdates:e})}},{key:"updateIssue",value:function(e,t){return this.$ajax.put(j.c.individualIssue,t,e)}},{key:"getRapidSprintList",value:function(e){var t=this,r=e.map((function(e){return t.$jaCache.session.getPromise("rapidSprintList".concat(e)).then((function(r){return r||t.$ajax.get(j.c.rapidSprintList,e).then((function(r){var n=r.sprints;return n.forEach((function(t){t.rapidId=e})),t.$jaCache.session.set("rapidSprintList".concat(e),n,10),n}))}))}));return Promise.all(r).then((function(e){return e.union()}))}},{key:"getSprintList",value:function(e){var t=this;return Array.isArray(e)&&(e=e.join()),this.$jaCache.session.getPromise("sprintListAll".concat(e)).then((function(r){return r||t.$ajax.get(j.c.sprintListAll,e).then((function(r){return t.$jaCache.session.set("sprintListAll".concat(e),r.sprints,10),r.sprints}))}))}},{key:"getRapidSprintDetails",value:function(e,t){return this.$ajax.get(j.c.rapidSprintDetails,e,t)}},{key:"getSprintIssues",value:function(e){return this.$ajax.get(j.c.getSprintIssues,e)}},{key:"getOpenTickets",value:function(e){var t=this;if(!e){var r=this.$jaCache.session.get("myOpenTickets");if(r)return new Promise((function(e){return e(r)}))}var n=this.$session.CurrentUser.openTicketsJQL||j.u.openTicketsJQL;return this.searchTickets(n,j.t).then((function(e){return t.$jaCache.session.set("myOpenTickets",e),e}))}},{key:"getTicketSuggestion",value:function(e){var t=this,r=this.$session.CurrentUser.suggestionJQL;if(r){if(!e){var n=this.$jaCache.session.get("mySuggestionTickets");if(n)return new Promise((function(e){return e(n)}))}return this.searchTickets(r,j.t).then((function(e){return t.$jaCache.session.set("mySuggestionTickets",e),e}))}return this.getOpenTickets(e)}},{key:"searchUsers",value:function(){var e=Object(u.a)(i.a.mark((function e(t){var r,n,a,s=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:10,n=s.length>2&&void 0!==s[2]?s[2]:0,a=null,e.prev=3,e.next=6,this.$ajax.get(j.c.searchUser,t,r,n);case 6:a=e.sent,e.next=15;break;case 9:return e.prev=9,e.t0=e.catch(3),console.error("User search failed. Using alternate search mechanism.",e.t0),e.next=14,this.$ajax.get(j.c.searchUser_Alt,t,r,n);case 14:a=e.sent;case 15:return e.abrupt("return",a);case 16:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"fillWorklogs",value:function(e,t){var r=(e=e.filter((function(e){return!(e.fields||{}).worklog||(((e.fields||{}).worklog||{}).worklogs||[]).length<e.fields.worklog.total}))).length,n=0;r>3&&(r=3),console.log("FillStarted:- ".concat(e.length," tickets found"));for(var a=function(a){a&&n++,0===--r&&t(e.length-n,e)},i=0;i<r;i++)this.fillWL(e[i]).then(a);0===e.length&&t(e.length)}},{key:"fillWL",value:function(e){return console.log("Started fetching worklog for ".concat(e.key)),this.getWorklogs(e.key).then((function(t){return console.log("Success fetching worklog for ".concat(e.key)),e.fields||(e.fields={}),e.fields.worklog=t,!0}),(function(){return console.log("Failed fetching worklog for ".concat(e.key)),!1}))}},{key:"getUserDetails",value:function(e){var t=this,r="userdetail_".concat(e);return this.fetchCachedData(r,(function(){return t.$ajax.get(j.c.getUserDetails,e).then((function(e){return t.$jaCache.session.set(r,e,10),e}),t.jiraErrorHandler)}))}},{key:"fetchCachedData",value:function(){var e=Object(u.a)(i.a.mark((function e(t,r){var n,a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.getCachedData(t))){e.next=3;break}return e.abrupt("return",n);case 3:if(!(a=this.runningRequests[t])){e.next=8;break}return e.next=7,a;case 7:return e.abrupt("return",this.getCachedData(t));case 8:return s=r(),this.runningRequests[t]=s,e.abrupt("return",s);case 11:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getCachedData",value:function(e){var t=this.$jaCache.session.get(e);if(t)return Promise.resolve(t)}},{key:"getCurrentUser",value:function(){return this.$ajax.get(j.c.mySelf).then(null,this.jiraErrorHandler)}},{key:"getJAWorklog",value:function(e,t){var r=this;return this.getWorklog(e,t).then((function(e){var n=e.timeSpentSeconds/60;return{id:j.g,createdBy:r.$session.CurrentUser.userId,dateStarted:I(e.started).toDate(),description:e.comment,isUploaded:!0,ticketNo:t,worklogId:Number(e.id),timeSpent:"".concat(parseInt((n/60).toString()).pad(2),":").concat(parseInt((n%60).toString()).pad(2))}}))}},{key:"getWorklog",value:function(e,t){return this.$ajax.get(j.c.individualWorklog,t,e)}}]),e}();J.dependencies=["AjaxService","CacheService","MessageService","SessionService"];var _=function(){function e(){Object(l.a)(this,e),this.handler=function(e){console.log(e)}}return Object(d.a)(e,[{key:"onNewMessage",value:function(e){this.handler=e}},{key:"warning",value:function(e,t){var r={life:5e3,summary:t,detail:e,severity:"warn"};this.handler(r)}},{key:"error",value:function(e,t,r){var n=(new Date).getTime();if(!(r&&this.lastErrorTime+500>n)){this.lastErrorTime=n;var a={life:6e3,summary:t,detail:e,severity:"error"};this.handler(a)}}},{key:"success",value:function(e,t){var r={life:4e3,summary:t,detail:e,severity:"success"};this.handler(r)}},{key:"info",value:function(e,t){var r={life:5e3,summary:t,detail:e,severity:"info"};this.handler(r)}}]),e}(),q=function(){function e(t,r,n,a){var i=this;Object(l.a)(this,e),this.$ajax=t,this.$cache=r,this.$userutils=a,n.getAppVersion().then((function(e){return i.version=parseFloat(e)}))}return Object(d.a)(e,[{key:"getNotifications",value:function(){var e=Object(u.a)(i.a.mark((function e(){var t,r,n,a,s,o,u=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchNotifications();case 2:if(t=e.sent,r=t.updates_info,n=t.notifications){e.next=7;break}return e.abrupt("return",{count:0,list:[]});case 7:return a=(a=this.$cache.get("processed_notifications")||[]).filter((function(e){return!!n[e]})),this.$cache.set("processed_notifications",a.length?a:null),a.forEach((function(e){n[e].read=!0})),s=Object.keys(n).map((function(e){var t=n[e],r=t.version,a=t.browsers;if(a&&a.length&&!a.contains(b))return!1;if(r){var i="=",s=0;if(isNaN(r)?(i=r[0],s=parseFloat(r.substring(1))):s=parseFloat(r),"="===i&&s!==u.version||">"===i&&s>=u.version||"<"===i&&s<=u.version)return!1}return{id:e,type:t.type,title:t.title,message:t.message,autohide:t.autohide,module:t.module,read:t.read,important:t.important}})).filter(Boolean),(o=this.getVersionNotification(r))&&s.splice(0,0,o),e.abrupt("return",{updates_info:r,list:s,total:s.length,unread:s.count((function(e){return!e.read}))});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getVersionNotification",value:function(e){if(e&&Array.isArray(e)&&e.length){var t=this.$cache.get("readVersion")||{version:0,timestamp:0},r=e[0],n=r.version,a=r.timestamp,i=r.whatsnew,s=r.publishDate,o=r.expectedOn;if(t.version<n||t.timestamp<a){var u="You have ".concat(i.length," new updates added in this version. Click to know what is new..."),c="Whats new in Jira Assistant v".concat(n);if(n>this.version){var l="is available now to update";if(!s){var d=o?"on ".concat(this.$userutils.formatDate(o,"dd-MMM-yyyy")," approximately"):"soon";l="will be published ".concat(d)}u="You have ".concat(i.length," new updates added in this version and ").concat(l,". Click to know what is new..."),c="Upcomming in Jira Assistant v".concat(n)}return{id:"v".concat(n),type:"versionInfo",version:n,timestamp:a,title:c,message:u}}}}},{key:"markRead",value:function(e){if(e)if("versionInfo"===e.type){var t=e.version,r=e.timestamp;this.$cache.set("readVersion",{version:t,timestamp:r})}else{var n=this.$cache.get("processed_notifications")||[];n.push(e.id),this.$cache.set("processed_notifications",n)}}},{key:"getUnreadCount",value:function(){var e=Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getNotifications();case 2:return t=e.sent,e.abrupt("return",t.unread);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchNotifications",value:function(){var e=Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.$cache.get("messages")){e.next=7;break}return e.next=4,this.$ajax.execute("GET",j.w,null,{withCredentials:!1});case 4:return(t=e.sent)&&this.$cache.set("messages",t,I().add(4,"hours")),e.abrupt("return",t);case 7:return e.abrupt("return",new Promise((function(e){setTimeout((function(){e(t)}),500)})));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();q.dependencies=["AjaxService","CacheService","AppBrowserService","UtilsService","MessageService"];var H=function(){function e(t){Object(l.a)(this,e),this.settings=t,Object(n.a)(this,"AjaxService","AppBrowserService")}return Object(d.a)(e,[{key:"authenticate",value:function(e){var t=this;return new Promise(function(){var r=Object(u.a)(i.a.mark((function r(n){var a,o,u,c,l,d,h;return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=t.settings,o=a.client_id,u=a.redirect_uri,c=a.scope,l=Object(s.a)(Object(s.a)({},e),{},{client_id:o,redirect_uri:u,scope:c}),d=Object(p.j)(t.settings.authEndPoint,l),r.next=6,t.$jaBrowserExtn.launchWebAuthFlow({interactive:!0,url:d});case 6:h=r.sent,h=new URL(h).hash,n(t.parseQueryString(h.clearStart("#"))),r.next=13;break;case 11:window.oAuthHandler=function(e){window.oAuthHandler=null,n(t.parseQueryString(e.clearStart("#")))},window.open(d,"oAuthHandler","height=610,width=500");case 13:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())}},{key:"getToken",value:function(){var e=Object(u.a)(i.a.mark((function e(t,r){var n,a,o,u,c,l,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.settings,a=n.client_id,o=n.redirect_uri,u=n.scope,c=Object(s.a)(Object(s.a)({},t),{},{client_id:a,redirect_uri:o,scope:u}),l=this.settings.tokenEndPoint,d=null,!r){e.next=11;break}return l=Object(p.j)(l,c),e.next=8,this.$jaBrowserExtn.launchWebAuthFlow({interactive:!1,url:l});case 8:d=e.sent,e.next=14;break;case 11:return e.next=13,this.$ajax.request(r?"GET":"POST",l,c);case 13:d=e.sent;case 14:return console.log("Client:getToken:Access Token response: ",d),d=new URL(d).hash,d=this.parseQueryString(d.clearStart("#")),e.abrupt("return",d);case 18:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"parseQueryString",value:function(e){var t={};return e.replace(/([^=]+)=([^&]*)&?/g,(function(e,r,n){return t[r]=decodeURIComponent(n),""})),t}}]),e}(),Q="https://login.microsoftonline.com/common/oauth2/v2.0/",G="".concat(Q,"authorize"),Y="".concat(Q,"authorize"),z="".concat("https://graph.microsoft.com/v1.0/me/","/calendar/calendarView?startDateTime={0}&endDateTime={1}"),Z=function(){function e(t,r,n,a,i,s){Object(l.a)(this,e),this.$ajax=t,this.$analytics=r,this.$message=n,this.$cache=a,this.$jaBrowserExtn=i,this.$session=s,this.initConfigs()}return Object(d.a)(e,[{key:"initConfigs",value:function(){var e=Object(u.a)(i.a.mark((function e(){var t,r,n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.oauth||null===(t=this.$session.CurrentUser)||void 0===t||!t.oIntegration){e.next=17;break}return r=null,e.next=5,this.$jaBrowserExtn.requestPermission(["identity"]);case 5:if(e.sent){e.next=7;break}return e.abrupt("return",!1);case 7:r=this.$jaBrowserExtn.getRedirectUrl("outlook-auth"),e.next=15;break;case 10:r=document.location.href,~(n=r.indexOf("#"))&&(r=r.substring(0,n)),~(a=r.indexOf("?"))&&(r=r.substring(0,a));case 15:return this.oauth=new H({authEndPoint:G,tokenEndPoint:Y,client_id:"a8efd8fc-0657-490e-a622-7b2aaa4f4f46",redirect_uri:r,scope:"Calendars.Read profile offline_access openid"}),e.abrupt("return",!0);case 17:return e.abrupt("return",!!this.oauth);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAddlProps",value:function(e){return{response_type:e,state:"c455eb5d-cc14-4539-ad51-59612035c260",nonce:"8ad55dab-93d4-4456-99c8-fcc2f0d09b80",response_mode:"fragment"}}},{key:"authenticate",value:function(){var e=Object(u.a)(i.a.mark((function e(){var t,r,n,a,s,o,u,c,l,d,h;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initConfigs();case 2:return t=this.getAddlProps("id_token token"),e.next=5,this.oauth.authenticate(t);case 5:if(r=e.sent,a=(n=r||{}).access_token,s=n.id_token,!a||!this.setAuthToken(r)){e.next=14;break}return o=Object(p.h)(s),console.log("Outlook: ID Token Value: ",o),c=(u=o||{}).name,l=u.preferred_username,d=u.tid,h=u.oid,e.abrupt("return",{name:c,preferred_username:l,tid:d,oid:h,access_token:a});case 14:return e.abrupt("return",Promise.reject(r));case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setAuthToken",value:function(e){var t=e||{},r=t.token_type,n=t.access_token,a=t.expires_in;if(n)return"bearer"===r&&(this.bearerToken=n),this.tokenExpiresAt=T()().add(a-10,"seconds"),this.$cache.set("olbt",n,this.tokenExpiresAt),n}},{key:"getToken",value:function(){var e=Object(u.a)(i.a.mark((function e(){var t,r,n,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.bearerToken&&this.tokenExpiresAt&&T()().isBefore(this.tokenExpiresAt))){e.next=2;break}return e.abrupt("return",this.bearerToken);case 2:if(!(t=this.$cache.get("olbt"))){e.next=5;break}return e.abrupt("return",t);case 5:return this.bearerToken=null,this.tokenExpiresAt=null,e.next=9,this.initConfigs();case 9:return r=Object(s.a)(Object(s.a)({},this.getAddlProps("token")),{},{prompt:"none"},this.getOptionalHints()),e.next=12,this.oauth.getToken(r,!0);case 12:return n=e.sent,console.log("getToken:Access Token response: ",n),(a=this.setAuthToken(n))||(console.log("getToken:Access token request params: ",r),this.$cache.remove("olbt")),e.abrupt("return",a);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getOptionalHints",value:function(){var e=this.$session.CurrentUser.outlookStore||{},t=e.preferred_username,r=e.tid,n={login_hint:t||""};return r&&(n.domain_hint="9188040d-6c67-4c5b-b112-36a304b66dad"===r?"consumers":"organizations"),n}},{key:"getEvents",value:function(){var e=Object(u.a)(i.a.mark((function e(t,r,n){var a,s,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initConfigs();case 2:return n=n||{},e.next=5,this.getToken();case 5:if(a=e.sent){e.next=9;break}return this.$message.warning("Unable to authenticate with Outlook. You will have to reauthenticate from settings page."),e.abrupt("return",[]);case 9:return t||(t=T()().startOf("month").add(-1,"days")),r||(r=T()().endOf("month").add(1,"days")),t=encodeURIComponent(T()(t).toDate().toISOString()),r=encodeURIComponent(T()(r).toDate().toISOString()),e.prev=13,e.next=16,this.$ajax.request("GET",z.format(t,r),{},{Authorization:"Bearer ".concat(a)});case 16:return s=e.sent,this.$analytics.trackEvent("Outlook - fetched data",j.i.DataFetch),o=s.value.map((function(e){return e.start.dateTime&&(e.start.dateTime=T.a.tz(e.start.dateTime,e.start.timeZone).toDate()),e.end.dateTime&&(e.end.dateTime=T.a.tz(e.end.dateTime,e.end.timeZone).toDate()),{id:e.id,start:e.start.dateTime,end:e.end.dateTime,title:e.subject,url:e.onlineMeetingUrl,entryType:2,sourceObject:e,source:"outlook",editable:!1,allDay:e.isAllDay}})),e.abrupt("return",o);case 22:e.prev=22,e.t0=e.catch(13),this.$analytics.trackEvent("Authentication error :-".concat((e.t0||"").status||""),j.i.DataFetch),e.t0&&401===e.t0.status?this.$message.warning("Authenticated session with the Outlook Calendar has expired. You will have to reauthenticate."):this.$message.error("Unknown error occured while trying to fetch the calendar data.");case 26:case"end":return e.stop()}}),e,this,[[13,22]])})));return function(t,r,n){return e.apply(this,arguments)}}()}]),e}();Z.dependencies=["AjaxService","AnalyticsService","MessageService","CacheService","AppBrowserService","SessionService"];var K=r(29),X=r.n(K),ee=function(){function e(){var t=this;Object(l.a)(this,e),this.add=function(e){var r={callback:e};return r.promise=new Promise((function(e){r.startTask=e})).then(e),t.queue.push(r),r.promise},this.continueOnFailure=!0,this.concurrentRuns=3,this.event=new K.EventEmitter,this.reset()}return Object(d.a)(e,[{key:"on",value:function(e,t){this.event.on(e,t)}},{key:"reset",value:function(){this.queue=[],this.failedItems=[],this.runningItems=[]}},{key:"addRange",value:function(e){if(e)return Array.isArray(e)&&e.length?e.map(this.add):void 0}},{key:"start",value:function(){this.processNextItem()}},{key:"processNextItem",value:function(){var e=this;if(this.queue.length&&(this.runningItems.length<this.concurrentRuns||this.runningItems.count((function(e){return!e.completed}))<this.concurrentRuns)){var t=this.queue.splice(0,1),r=Object(W.a)(t,1)[0];this.runningItems.push(r);var n=r.startTask,a=r.promise;n(),a.finally((function(){r.completed=!0,e.clearCompletedItems(),e.processNextItem()}))}else 0===this.queue.length&&0===this.runningItems.length&&this.event.emit("completed")}},{key:"clearCompletedItems",value:function(){for(;this.runningItems.length&&this.runningItems[0].completed;)this.runningItems.splice(0,1)}}]),e}(),te=function(){function e(t,r,n){Object(l.a)(this,e),this.$db=t,this.$session=r,this.$analytics=n}return Object(d.a)(e,[{key:"deleteSavedQuery",value:function(e){return this.getSavedQueries(e).delete()}},{key:"getSavedQueries",value:function(e){return this.$db.savedFilters.where("id").anyOf(e)}},{key:"exportQueries",value:function(e){var t=this;return this.getSavedQueries(e).toArray().then((function(e){return Promise.all(e.filter((function(e){return!e.uniqueId})).map((function(e){return t.saveQuery(e)}))).then((function(){e.forEach((function(e){delete e.id,delete e.createdBy}));var r=JSON.stringify({exported:new Date,reports:e}),n=1===e.length?e[0].queryName:"JA_Reports";return n="".concat(n,"_").concat((new Date).format("yyyyMMdd"),".jrd"),Object(p.k)(r,"jrd",n),t.$analytics.trackEvent("Report definition exported",j.i.UserActions),!0}))}))}},{key:"getReportsList",value:function(){return this.$db.savedFilters.where("createdBy").equals(this.$session.userId).toArray().then((function(e){return e.map((function(e){var t,r;return{id:e.id,queryName:e.queryName,dateCreated:e.dateCreated,advanced:e.advanced,outputCount:e.advanced?null:(null===(t=e.outputFields)||void 0===t?void 0:t.length)||(null===(r=e.fields)||void 0===r?void 0:r.length),isNew:!e.advanced&&Array.isArray(e.fields)}}))}))}},{key:"getReportDefinition",value:function(e){return this.$db.savedFilters.where("id").equals(parseInt(e)).first()}},{key:"saveQuery",value:function(e){var t=this;e.createdBy=this.$session.userId;var r=!0;e.uniqueId||(r=!1,e.uniqueId=j.r.generate()),e.dateCreated=new Date;var n=this.$db.savedFilters.where("queryName").equals(e.queryName);return e.id>0?n.and((function(r){return r.createdBy===t.$session.userId&&e.id!==r.id})).first().then((function(n){return n?Promise.reject({message:'The query with the name "'.concat(e.queryName,'" already exists!')}):(r&&(e.updateId=j.r.generate()),e.dateUpdated=new Date,t.$db.savedFilters.put(e).then((function(){return t.$analytics.trackEvent("Report modified",j.i.UserActions,e.advanced?"Report builder":"Custom report"),e.id})))})):n.and((function(e){return e.createdBy===t.$session.userId})).first().then((function(r){return r?Promise.reject({message:'The query with the name "'.concat(e.queryName,'" already exists!')}):t.$db.savedFilters.add(e).then((function(r){return t.$analytics.trackEvent("Report created",j.i.UserActions,e.advanced?"Report builder":"Custom report"),r}))}))}}]),e}();te.dependencies=["DatabaseService","SessionService","AnalyticsService"];var re=r(31),ne=r(2),ae=r.n(ne),ie=r(32),se=r(47),oe=r(49),ue=function(){function e(t,r,n,a,i,s,o){Object(l.a)(this,e),this.processSearchData=function(e){return e.map((function(e){var t=e.fields;return t.key=e.key,t.worklog&&t.worklog.worklogs&&(t.worklogs=t.worklog.worklogs,delete t.worklog),t}))},this.$report=t,this.$session=r,this.$jira=n,this.$http=a,this.$usergroup=i,this.$userutils=s,this.$bookmark=o,this.parameters=new X.a,this.eventPipe=new X.a}return Object(d.a)(e,[{key:"hasScriptExecPermission",value:function(){try{return!!Function("return true")()}catch(e){return console.log("Jira Assistant is not granted permission for executing expressions. Hence some dynamic expressions in Report Builder will not work."),!1}}},{key:"configureReport",value:function(){var e=this;if(!this.isConfigured){var t=!this.hasScriptExecPermission(),r={selfHandleScriptExecution:t,compiler:t?oe.a:function(e,t){return Function.apply(void 0,Object(re.a)(t).concat([e]))()},useExternalDnDProvider:!0,customFunctions:!t,subReports:function(t){return e.$report.getReportsList().then((function(e){return e=e.filter((function(e){return e.advanced})).map((function(e){return{id:e.id,name:e.queryName}})),t&&t.id&&(e=e.filter((function(e){return e.id!==t.id}))),e}))},resolveReportDefinition:function(t){return e.$report.getReportDefinition(t)},resolveHttpRequest:function(t,r,n,a){return e.$http.request(t,r,n,a)},builtInFields:{UserDateFormat:{value:this.$session.CurrentUser.dateFormat,helpText:"Provides the date format of the current user"},UserTimeFormat:{value:this.$session.CurrentUser.timeFormat},UserDateTimeFormat:{value:"".concat(this.$session.CurrentUser.dateFormat," ").concat(this.$session.CurrentUser.timeFormat)}},commonFunctions:{getUsersFromGroup:{value:function(e){}},getJiraIssueUrl:{value:function(t){return e.$userutils.getTicketUrl(t)}},getUserProfileUrl:{value:function(e){}},getTicketDetails:{value:function(t,r){return e.$report.fetchTicketDetails(t,r)}},executeJQL:{value:function(t,r){return e.$jira.searchTickets(t,r)}},getRapidSprintList:{value:function(t){return e.$jira.getRapidSprintList(t)}},getProjectSprintList:{value:function(t){return e.$jira.getSprintList(t)}},getRapidSprintDetails:{value:function(t,r){return e.$jira.getRapidSprintDetails(t,r)}},searchUsers:{value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e.$jira.searchUsers(t,r,n)}},addWorklog:{value:function(t){return e.eventPipe.emit("addWorklog","string"===typeof t?{ticketNo:t}:t)}},getWorklogs:{value:function(t){return e.$jira.getWorklogs(t)}},bookmarkTicket:{value:function(t){return e.$bookmark.addBookmark([t]).then((function(){e.eventPipe.emit("gadgetAction",se.a.TicketBookmarked)}))}},formatDate:{value:this.$userutils.formatDate},formatTime:{value:this.$userutils.formatTime},formatDateTime:{value:this.$userutils.formatDateTime}}};Object(ie.initReportBuilder)(r),this.isConfigured=!0}}},{key:"getDatasetConfig",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{JQL:{label:"JQL search result",resolveSchema:t.JQL||function(t,r,n){return new Promise((function(a,i){e.eventPipe.emit("resolveSchema_JQL",{name:t,props:r,data:n,schema:{resolve:a,reject:i}})}))},resolveData:function(t,r,n){var a=n.parameterTemplate;return e.$jira.searchTickets(e.prepareJQL(t.jql,r,a),t.outputFields.map((function(e){return e.id}))).then(e.processSearchData)}},FLT:!0,PLS:{label:"Project list",allowEdit:!1,resolveSchema:function(t,r,n){return e.$jira.getProjects().then((function(e){return n.resolve(e),r}))},resolveData:function(t){return e.$jira.getProjects()}},ITL:{label:"Issue type list",allowEdit:!1,resolveSchema:function(t,r,n){return e.$jira.getIssueTypes().then((function(e){return n.resolve(e)})),Promise.resolve(r)},resolveData:function(t){return e.$jira.getIssueTypes()}},OTL:{label:"My open tickets list",allowEdit:!1,resolveSchema:function(t,r,n){return e.$jira.getOpenTickets().then((function(e){return n.resolve(e)})),Promise.resolve(r)},resolveData:function(t){return e.$jira.getOpenTickets()}},RPV:{label:"Rapid view list (sprint board list)",allowEdit:!1,resolveSchema:function(t,r,n){return e.$jira.getRapidViews().then((function(e){return n.resolve(e)})),Promise.resolve(r)},resolveData:function(t){return e.$jira.getRapidViews()}},CUF:{label:"Custom fields list",allowEdit:!1,resolveSchema:function(t,r,n){return e.$jira.getCustomFields().then((function(e){return n.resolve(e)})),Promise.resolve(r)},resolveData:function(t){return e.$jira.getCustomFields()}},EXP:!0,HTP:!0,FIL:!0,STC:!0}}},{key:"getParameterTypesConfig",value:function(){var e=this,t=null;return{UG:{label:"User group",control:function(r){return r.value||(t?r.onChange(r.definition,t):e.$usergroup.getUserGroups().then((function(e){(t=e)&&r.onChange(r.definition,t)}))),ae.a.createElement("span",{onClick:function(t){e.parameters.emit("click",r)},className:"link"},"Select users")}}}}},{key:"configureViewer",value:function(){if(!this.isViewerConfigured){var e={parameterTypes:this.getParameterTypesConfig(),datasetTypes:this.getDatasetConfig()};Object(ie.initReportBuilder)(e),this.configureReport(),this.isViewerConfigured=!0}}},{key:"configureBuilder",value:function(){if(!this.isBuilderConfigured){var e={parameterTypes:this.getParameterTypesConfig(),datasetTypes:this.getDatasetConfig()};Object(ie.initReportBuilder)(e),this.configureViewer(),this.isBuilderConfigured=!0}}},{key:"prepareJQL",value:function(e,t,r){var n=this,a=e.match(/@Parameters.([a-zA-Z_\d.]+[|a-zA-Z_\d.()"',-//]+)\$/g);return a&&a.length&&a.forEach((function(a){var i=a.substring(12,a.length-1),s=i.split("|");if(!(s.length>2)){i=s[0];var o=t?n.getParamValue(t,r,i):s[1];e=e.replace(a,o)}})),e}},{key:"getParamValue",value:function(e,t,r){var n=r.split("."),a=n[0],i=e[a];if(void 0===i)return console.error('Value for parameter "'.concat(a,'" does not exists')),i;for(var s=1;i&&s<n.length;s++)i=i[n[s]];if(i)if(i instanceof Date)i=i.format("yyyy-MM-dd");else if(Array.isArray(i))i=i.join('","');else if("object"===Object(c.a)(i)){switch(t[a].type){case"UG":i=i.union((function(e){return e.users.map((function(e){return Object(p.e)(e)}))})).join('","')}}return Number(i)?i:'"'.concat(i||"",'"')}}]),e}();ue.dependencies=["ReportService","SessionService","JiraService","AjaxService","UserGroup","UserUtilsService","BookmarkService"];var ce=function(){function e(t){Object(l.a)(this,e),this.$cache=t,this.CurrentUser={}}return Object(d.a)(e,[{key:"getCurrentUserId",value:function(){var e=this.userId;if(e||(e=this.$cache.get("CurrentUserId"),this.userId=e),!e)throw new Error({needIntegration:!0});return e}}]),e}();ce.dependencies=["CacheService"];var le=function(){function e(t,r){Object(l.a)(this,e),this.$jira=t,this.$bookmark=r}return Object(d.a)(e,[{key:"getTicketSuggestion",value:function(){return Promise.all([this.$bookmark.getBookmarks(),this.$jira.getTicketSuggestion()]).then((function(e){return e[1].map((function(e){return{value:e.key,label:"".concat(e.key," - ").concat(e.fields.summary)}})).addRange(e[0].map((function(e){return{value:e.ticketNo,label:"".concat(e.ticketNo," - ").concat(e.summary)}})))}))}}]),e}();le.dependencies=["JiraService","BookmarkService"];var de=function(){function e(t){var r=this;Object(l.a)(this,e),this.prepareParentAndProjectFields=function(e){var t=Object(s.a)({},e);Object.keys(t).forEach((function(e){t[e]||delete t[e]}));var r=e.issuekey,n=e.project;return r&&(r=r.trim().toUpperCase(),t.issuekey=r),n&&(n=n.trim().toUpperCase(),t.project=n),!n&&r&&(n=r.split("-")[0].toUpperCase(),t.project=n),t.parent&&(t.parent=t.parent.trim().toUpperCase(),n||(n=t.parent.split("-")[0].toUpperCase(),t.project=n)),t},this.getValueForImport=function(e,t){var n=t.schema,a=n.type,i=n.items,s=t.allowedValues,o=null;switch(a){case"user":o={name:e};break;case"date":o=r.$utils.formatDateTimeForJira(e);break;case"array":o=e.split(",").map((function(t){var r={};if("string"===i)return t;var n=null;if(s)for(var a=0;a<s.length;a++){var o=s[a],u=o.id,c=o.key,l=o.name;if(c&&e===c)n="key";else if(e===l)n="name";else{if(e!==u)continue;n="id"}break}else n=isNaN(t)?"key":"id";return r[n]=t,r}));break;case"string":case"timetracking":o=e;break;default:var u={},c=null;if(c=isNaN(e)?"key":"id",s)for(var l=0;l<s.length;l++){var d=s[l],h=d.id,f=d.key,p=d.name;if(e===f)c="key";else if(e===p)c="name";else{if(e!==h)continue;c="id"}break}u[c]=e,o=u}return o},this.$jira=t,this.ticketsCache={}}return Object(d.a)(e,[{key:"getTicketDetails",value:function(e,t){var r=this;if(!e)return null;var n=!1;return"string"===typeof e&&(e=[e],n=!0),this.fetchTicketDetails(e,["summary","assignee","reporter","priority","status","resolution","created","updated","issuetype","parent"]).then((function(e){var a={};return e.forEach((function(e){r.ticketsCache[e.key.toUpperCase()]=e,t||(a[e.key]=e)})),n?e[0]:t?e:a}))}},{key:"fetchTicketDetails",value:function(e,t){var r=this,n=[],a=[];if((e=e.distinct((function(e){return e}))).forEach((function(e){r.ticketsCache[e]?n.push(r.ticketsCache[e]):a.push(e)})),a.length>0){var i="'".concat(a.join("', '"),"'");return i="key in (".concat(i,")"),this.$jira.searchTickets(i,t).then((function(e){return n.addRange(e),n}))}return Promise.resolve(n)}},{key:"processIssuesForImport",value:function(){var e=Object(u.a)(i.a.mark((function e(t){var r,n,a,s,o,c,l,d=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.repeatIssuesWithMultipleParent(t),r=t.map(this.prepareParentAndProjectFields),n=r.distinct((function(e){return e.project}),!0),e.next=5,this.$jira.getProjectImportMetadata(n);case 5:return a=e.sent,s=r.distinct((function(e){return e.issuekey||null}),!0),e.next=9,this.getTicketDetails(s,!1);case 9:return o=e.sent,e.next=12,this.getFieldsToImport(a,t);case 12:return c=e.sent,e.next=15,Promise.all(r.map(function(){var e=Object(u.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.issuekey&&o&&(o[t.issuekey]||{}).fields,e.next=3,d.prepareIssue(t,a,c,r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 15:return l=e.sent,e.abrupt("return",{importFields:c,metadata:a,importData:l,ticketDetails:o});case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"repeatIssuesWithMultipleParent",value:function(e){var t=[];return e.forEach((function(e){if(e.parent){var r=(e.parent||"").trim().toUpperCase().split(/[ ;,]/gi).filter((function(e){return!!e})).distinct();if(r.length>1)return void r.forEach((function(r){return t.push(Object(s.a)(Object(s.a)({},e),{},{parent:r}))}))}t.push(e)})),t}},{key:"prepareIssue",value:function(){var e=Object(u.a)(i.a.mark((function e(t,r,n,a){var s,o,c,l,d,h,f,p=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.validateBasicFields(t,r,a);case 2:return s=e.sent,o=s.raw,c=s.options,l=s.fields,d=s.issuetype,h=this.validateCrossFields(o,c,d)||s.hasError,f=Object.keys(l),e.next=8,f.asyncForEach(function(){var e=Object(u.a)(i.a.mark((function e(t){var r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l[t],n=p.getOptionField(c,t),e.next=4,p.prepareField(t,r,o,n,d,a);case 4:h||(h=n.errors.length>0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:return f.length>0&&Object.keys(o).forEach((function(e){var t=p.getOptionField(c,e,!0),r=p.assignExistingValuesWhenEmpty(e,o,t,a);if(!l[e]&&"issuekey"!==e||!r){var i=n.first((function(t){return t.key===e}));t.displayValue=r,i?o.issuekey?p.isValueChanged(e,o,a)&&(t.errors.push("This field is not editable"),h=!0):t.warnings.push("Not an allowed field while creation of issue. Will try to update after issue is created."):(t.errors.push("This is not a known field"),h=!0)}})),h?(s.hasError=h,s.status="Error"):s.status="Will Import (".concat(o.issuekey?"update":"new",")"),e.abrupt("return",s);case 11:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a){return e.apply(this,arguments)}}()},{key:"assignExistingValuesWhenEmpty",value:function(e,t,r,n){var a=(t[e]||"").trim(),i="null"===a.toLowerCase();i&&(a="",t[e]="");var s=n&&n[e];return!s||a||i||(a="object"===Object(c.a)(s)?s.name||s.id:s,t[e]=a,r.displayValue=a),a}},{key:"isValueChanged",value:function(e,t,r){var n=(t[e]||"").trim().toLowerCase(),a=r&&r[e];return!!a&&("object"===Object(c.a)(a)?a.id!=n&&(a.name||"").toLowerCase()!==n:"".concat(a).toLowerCase()!==n)}},{key:"getOptionField",value:function(e,t,r){var n=e[t]||{errors:[]};return e[t]=n,r&&(n.warnings=[]),n}},{key:"validateBasicFields",value:function(){var e=Object(u.a)(i.a.mark((function e(t,r,n){var a,o,u,c,l,d,h,f,p,g,v,m;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={project:{errors:[]},issuetype:{errors:[]}},o=this.assignExistingValuesWhenEmpty("project",t,a.project,n),u=this.assignExistingValuesWhenEmpty("issuetype",t,a.issuetype,n),c=!1,o?a.project.displayValue=o:(a.project.errors.push("Value is required"),c=!0),u?a.issuetype.displayValue=u:(a.issuetype.errors.push("Value is required"),c=!0),l={},e.prev=7,!t.issuekey){e.next=12;break}return e.next=11,this.$jira.getIssueMetadata(t.issuekey);case 11:l=e.sent;case 12:e.next=22;break;case 14:e.prev=14,e.t0=e.catch(7),d=e.t0.error,h=(d=void 0===d?{}:d).errorMessages,f=void 0===h?[]:h,this.getOptionField(a,"issuekey").errors=f,c=!0;case 22:return(p=o&&r[o])?(t.project=p.key,a.project.displayValue=p.name):o&&(a.project.errors.push("Value is invalid"),c=!0),t.issuekey?p&&(p=Object(s.a)(Object(s.a)({},p),{},{fields:l})):(v=(p||{issuetypes:[]}).issuetypes,m=pe(u),(g=m&&v.filter((function(e){return pe(e.name)===m}))[0])?(t.issuetype=g.name,a.issuetype.displayValue=g.name,l=g.fields):u&&(a.issuetype.errors.push("Value is invalid"),c=!0)),e.abrupt("return",{raw:t,options:a,fields:l,issuetype:g,project:p,hasError:c});case 26:case"end":return e.stop()}}),e,this,[[7,14]])})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"validateCrossFields",value:function(e,t,r){if(!r)return!0;var n=r.subtask,a=this.getOptionField(t,"parent"),i=this.getOptionField(t,"issuetype"),s=!1;return e.parent&&!n&&(a.errors.push("Value is invalid for this issue type"),i.errors.push("This is not a valid sub task type"),s=!0),n&&!e.parent&&(i.errors.push("Subtask is not valid without parent"),s=!0),s}},{key:"prepareField",value:function(){var e=Object(u.a)(i.a.mark((function e(t,r,n,a,s,o){var u,c,l,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=r.required,c=r.schema,l=r.allowedValues,d=this.assignExistingValuesWhenEmpty(t,n,a,o),u&&!d&&a.errors.push("Value is required"),!a.displayValue&&d&&(a.displayValue=d),e.next=6,this.validateType(c,d,a);case 6:this.validateAllowedValues(n,t,l,d,a);case 7:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i,s){return e.apply(this,arguments)}}()},{key:"validateAllowedValues",value:function(e,t,r,n,a){if(r&&n){var i=this.getField(n,r);i?(a.displayValue=i.name||i.value,e[t]=i.id||i.key||i.name):a.errors.push("Invalid value for this field")}}},{key:"getField",value:function(e,t){var r=pe(e);return t.filter((function(t){return t.id===e||pe(t.key)===r||pe(t.name)===r||pe(t.value)===r}))[0]}},{key:"validateType",value:function(){var e=Object(u.a)(i.a.mark((function e(t,r,n){var a,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:a=(t||{}).type,e.t0=a,e.next="string"===e.t0?6:"array"===e.t0?8:"user"===e.t0?10:14;break;case 6:return s=Object(c.a)(r)===a,e.abrupt("break",16);case 8:return s=!0,e.abrupt("break",16);case 10:return s=!0,e.next=13,this.validateIfValidUser(r,n);case 13:return e.abrupt("break",16);case 14:return s=!0,e.abrupt("break",16);case 16:s||n.errors.push("Invalid value for this field");case 17:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"validateIfValidUser",value:function(e,t){return this.$jira.searchUsers(e).then((function(t){if(t.length>1){var r=t.filter((function(t){return he(t.accountId,e)||he(t.emailAddress,e)||he(t.displayName,e)||he(t.name,e)}));if(r.length)return r[0]}return t[0]})).then((function(e){return e||Promise.reject()})).then((function(e){t.displayValue=e.displayName}),(function(e){t.errors.push("Not a valid jira user name")}))}},{key:"getFieldsToImport",value:function(){var e=Object(u.a)(i.a.mark((function e(t,r){var n,a,s,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={},a=[],Object.keys(t).forEach((function(e){t[e].issuetypes.forEach((function(e){var t=e.fields;Object.keys(t).filter((function(e){return!n[e]})).forEach((function(e){n[e]=!0;var r=t[e],i=r.required,s=r.name;a.push({key:e,required:i,name:s})}))}))})),n.issuekey=!0,!((s=Object.keys(r[0]||{}).filter((function(e){return!n[e]})))&&s.length>0)){e.next=11;break}return e.next=9,this.$jira.getCustomFields();case 9:o=e.sent,s.forEach((function(e){var t=o.first((function(t){return t.id===e}));t?a.push({key:e,name:t.name,jiraField:t}):a.push({key:e,name:e,unknown:!0})}));case 11:return e.abrupt("return",a);case 12:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"importIssues",value:function(){var e=Object(u.a)(i.a.mark((function e(t){var r,n,a,o=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(re.a)(t),e.next=3,this.prepareIssuesForImport(t);case 3:return r=e.sent,n=r.map((function(e){return{fields:e.fields}})),e.next=7,this.$jira.bulkImportIssues(n).then(null,(function(e){return e.error})).then((function(e){var r=e.errors,n=e.issues,a=e.errorMessages,i=!1,u=[];if(r&&r.length>0&&(r.forEach((function(e){var r=e.failedElementNumber,n=e.elementErrors,a=n.errors,i=n.errorMessages;u.push(r);var c=Object(s.a)({},t[r]);t[r]=c;var l=c.options;Object.keys(a).forEach((function(e){o.getOptionField(l,e).errors.push(a[e])})),i&&i.length&&(c.statusErrors||(c.statusErrors=[]),c.statusErrors.addRange(i)),c.hasError=!0,c.status="Import Error"})),i=!0),n&&n.length>0){for(var c=-1,l=0;l<t.length;l++)if(!u.contains(l)){var d=t[l];c++,(d=Object(s.a)({},d)).raw.issuekey=n[c].key,d.status="Imported",d.disabled=!0,d.selected=!1,t[l]=d}i=!0}return i?t:Promise.reject(a)}));case 7:return a=e.sent,e.abrupt("return",a);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"prepareIssuesForImport",value:function(){var e=Object(u.a)(i.a.mark((function e(t){var r,n=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$jira.getCustomFields();case 2:return r=(r=e.sent).reduce((function(e,t){return e[t.id]=t,e}),{}),e.abrupt("return",t.map((function(e){var t=e.fields,a=e.raw,i=Object.keys(a).filter((function(e){return!!a[e]})),s={},o=!1,u=i.reduce((function(e,i){if(i.indexOf(".")>=0){var u=i.split("."),c=n.getValueForImport(a[i],t[u[0]]||r[u[0]]);t[u[0]]?(e[u[0]]=e[u[0]]||{},e[u[0]][u[1]]=c):(s[u[0]]=s[u[0]]||{},s[u[0]][u[1]]=c,o=!0)}else{var l=n.getValueForImport(a[i],t[i]||r[i]);t[i]?e[i]=l:(s[i]=l,o=!0)}return e}),{});return o?{fields:u,update:s}:{fields:u}})));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function he(e,t){return(e=(e||"").toLowerCase())===(e||"").toLowerCase()}de.dependencies=["JiraService"];var fe=/ -_/g;function pe(e){return e?"string"===typeof e?e.replace(fe,"").toLowerCase():e.toString():e}var ge=function(){function e(t,r){Object(l.a)(this,e),this.$db=t,this.$jira=r}return Object(d.a)(e,[{key:"getUser",value:function(){var e=Object(u.a)(i.a.mark((function e(t){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$db.users.get(t);case 2:return void 0===(r=e.sent).commentLength&&(r.commentLength=5),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllUsers",value:function(){return this.$db.users.toArray()}},{key:"saveGlobalSettings",value:function(){var e=Object(u.a)(i.a.mark((function e(t){var r,n=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=function(e,t,r,n){e[r]||n?t[r]=e[r]:delete t[r]},e.next=3,Promise.all(t.map(function(){var e=Object(u.a)(i.a.mark((function e(t){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getUser(t.id);case 2:return a=e.sent,(a=Object(s.a)({},a)).jiraUrl=t.jiraUrl,a.userId=t.userId,a.email=t.email,r(t,a,"openTicketsJQL"),r(t,a,"suggestionJQL"),r(t,a,"disableJiraUpdates"),r(t,a,"jiraUpdatesJQL"),r(t,a,"enableAnalyticsLogging",!0),r(t,a,"enableExceptionLogging",!0),r(t,a,"disableDevNotification"),e.next=16,n.$db.users.put(a);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"saveUser",value:function(){var e=Object(u.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.$db.users.put(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getUsersList",value:function(){var e=Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$db.users.where("id").notEqual(1).toArray();case 2:return t=e.sent,e.abrupt("return",t.map((function(e){return{id:e.id,email:e.email,jiraUrl:e.jiraUrl,userId:e.userId}})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getUserDetails",value:function(){var e=Object(u.a)(i.a.mark((function e(t){var r,n,a,s,o,u,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getUser(t);case 2:if(r=e.sent,"https://docs.google.com/forms/d/e/1FAIpQLScJvQtHZI_yZr1xd4Z8TwWgvtFss33hW5nJp4gePCgI2ScNvg/viewform?entry.326955045&entry.1696159737&entry.485428648={0}&entry.879531967={1}&entry.1426640786={2}&entry.972533768={3}",r.settings||(r.settings={}),n={page_dashboard:r.settings.page_dashboard,page_calendar:r.settings.page_calendar,page_reports_UserDayWise:r.settings.page_reports_UserDayWise},(a=(n.page_dashboard||{}).gridList)&&a.length>0?(s={myTickets:"myOpenTickets",bookmarksList:"myBookmarks",dtWiseWL:"dateWiseWorklog",pendingWL:"pendingWorklog",ticketWiseWL:"ticketWiseWorklog",savedQuery:"myFilters"},a=a.map((function(e){return s[e]||e}))):a=["myOpenTickets","myBookmarks","dateWiseWorklog","pendingWorklog"],r.jiraUrl=r.jiraUrl.clearEnd("/"),o={userId:r.id,dateFormat:r.dateFormat||j.s[0],timeFormat:r.timeFormat||j.x[0],workingDays:r.workingDays||[1,2,3,4,5],startOfDay:r.startOfDay||"10:00",endOfDay:r.endOfDay||"19:00",notifyWL:r.notifyWL,jiraUrl:r.jiraUrl,ticketViewUrl:"".concat(r.jiraUrl,"/browse/"),profileUrl:"".concat(r.jiraUrl,"/secure/ViewProfile.jspa"),maxHours:r.maxHours||8,meetingTicket:r.meetingTicket,team:r.team||[],projects:r.projects,rapidViews:r.rapidViews,storyPointField:r.storyPointField,epicNameField:r.epicNameField,commentLength:r.commentLength,startOfWeek:r.startOfWeek,allowClosedTickets:r.allowClosedTickets,settings:n,autoUpload:r.autoUpload,gIntegration:r.googleIntegration,oIntegration:r.outlookIntegration,hasGoogleCreds:!!r.dataStore,hasOutlookCreds:!!r.outlookStore,outlookStore:r.outlookStore,feedbackUrl:"".concat("https://docs.google.com/forms/d/e/1FAIpQLScJvQtHZI_yZr1xd4Z8TwWgvtFss33hW5nJp4gePCgI2ScNvg/viewform?entry.326955045&entry.1696159737&entry.485428648={0}&entry.879531967={1}&entry.1426640786={2}&entry.972533768={3}","&embedded=true"),dashboards:r.dashboards||[{isQuickView:!0,layout:1,name:"Default",icon:"fa fa-tachometer",widgets:a.map((function(e){return{name:e}}))}],openTicketsJQL:r.openTicketsJQL,suggestionJQL:r.suggestionJQL,disableJiraUpdates:r.disableJiraUpdates,jiraUpdatesJQL:r.jiraUpdatesJQL},!(t>1)){e.next=15;break}return e.next=13,this.getUser(1);case 13:(u=e.sent)&&(o.disableDevNotification=u.disableDevNotification,u.disableJiraUpdates&&(o.disableJiraUpdates=u.disableJiraUpdates));case 15:return(c=r.jiraUrl.toLowerCase()).indexOf("pearson")>=0||c.indexOf("emoneyadv")>=0?(o.noDonations=!0,o.hideDonateMenu=!0):(delete o.noDonations,o.hideDonateMenu=r.hideDonateMenu),e.abrupt("return",o);case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();ge.dependencies=["DatabaseService","JiraService"];var ve=function(){function e(t,r,n){Object(l.a)(this,e),this.$auth=t,this.$session=r,this.$user=n}return Object(d.a)(e,[{key:"getUserGroups",value:function(){var e=this;return this.$auth.getCurrentUser().then((function(t){var r=t.groups;return!r&&t.team&&t.team.length>0&&(r=[{name:"My Team",users:t.team}]),r||[{name:"Default group: No name set",timeZone:"",users:[e.$session.CurrentUser.jiraUser]}]}))}},{key:"saveUserGroups",value:function(e){var t=this;return this.$auth.getCurrentUser().then((function(r){return r.groups=e,t.$user.saveUser(r)}))}}]),e}();ve.dependencies=["AuthService","SessionService","UserService"];var me=function(){function e(t,r){var n=this;Object(l.a)(this,e),this.getTicketUrl=function(e){if(e)return n.$session.CurrentUser.ticketViewUrl+e},this.mapJiraUrl=function(e){return!e||e.startsWith("http")&&e.indexOf(":")>3?e:(e.startsWith("/")||(e="/".concat(e)),n.$session.CurrentUser.jiraUrl+e)},this.isHoliday=function(e){var t=e.getDay();return-1===n.$session.CurrentUser.workingDays.indexOf(t)},this.getProfileImgUrl=function(e){return e.jiraUser&&(e=e.jiraUser),e.avatarUrls?e.avatarUrls["48x48"]||e.avatarUrls["32x32"]:"".concat(n.$session.rootUrl,"/secure/useravatar?ownerId=").concat(Object(p.e)(e,!0))},this.getProfileUrl=function(e,t){return e||(e=n.$session.CurrentUser),"object"===Object(c.a)(e)?(e.jiraUser&&(e=e.jiraUser),e=Object(p.e)(e)):"string"!==typeof e&&(e=""),"".concat(t||n.$session.rootUrl,"/secure/ViewUser.jspa?name=").concat(e.toLowerCase())},this.formatDateTime=function(e,t,r){if(!e)return e;t||(t="".concat(n.$session.CurrentUser.dateFormat," ").concat(n.$session.CurrentUser.timeFormat));var a,i=n.$utils.convertDate(e);return i&&i instanceof Date?(!0===r&&(i=i.toUTCDate()),"quick"===(null===(a=t)||void 0===a?void 0:a.toLowerCase())?T()(i).fromNow():i.format(t)):i},this.formatDate=function(e,t,r){return t||(t=n.$session.CurrentUser.dateFormat),n.formatDateTime(e,t,r)},this.formatTime=function(e,t,r){return n.formatDateTime(e,t||n.$session.CurrentUser.timeFormat,r)},this.getDays=function(e,t){var r=n.$utils.getDateArray(e,t),a=(new Date).getTime();return r.map((function(e){return{prop:e.format("yyyyMMdd"),display:e.format("DDD, dd"),date:e,isHoliday:n.isHoliday(e),isFuture:e.getTime()>a}}))},this.$session=t,this.$utils=r}return Object(d.a)(e,[{key:"getWorklogUrl",value:function(e,t){var r=this.getTicketUrl(e);return r+="?focusedWorklogId=".concat(t,"&page=com.atlassian.jira.plugin.system.issuetabpanels%3Aworklog-tabpanel#worklog-").concat(t)}}]),e}();me.dependencies=["SessionService","UtilsService"];var ye=function(){function e(){Object(l.a)(this,e)}return Object(d.a)(e,[{key:"formatDate",value:function(e,t){e instanceof Date||(e=this.convertDate(e));var r=e.getFullYear().toString(),n=e.getMonth(),a=n<9?"0".concat(n+1):(n+1).toString(),i=e.getDate()<10?"0".concat(e.getDate()):e.getDate().toString(),s=e.getHours(),o=s<10?"0".concat(s):s.toString(),u=e.getMinutes()<10?"0".concat(e.getMinutes()):e.getMinutes().toString(),c=e.getSeconds()<10?"0".concat(e.getSeconds()):e.getSeconds().toString(),l=e.getDay();return t?t.replace("yyyy",r).replace("yy",r).replace("MMMM",j.l[n]).replace("MMM",j.p[n]).replace("MM",a).replace("DDDD",j.k[l]).replace("DDD",j.o[l]).replace("dddd",j.k[l]).replace("ddd",j.o[l]).replace("DD",j.q[l]).replace("dd",i).replace("HH",o).replace("hh",(s>12?s-12:o).toString()).replace("mm",u).replace("ss",c).replace("tt",s>=12?"PM":"AM"):"".concat(r).concat(a).concat(i).concat(o).concat(u).concat(c)}},{key:"formatDateTimeForJira",value:function(e){return e instanceof Date||(e=this.convertDate(e)),"".concat(e.toISOString().replace("Z","").replace("z",""),"+0000")}},{key:"formatDateForJira",value:function(e){return e instanceof Date||(e=this.convertDate(e)),e.format("dd/MMM/yy")}},{key:"getRowStatus",value:function(e){var t="";if(e.status&&(t+="closed"===(e.status.name||e.status).toLowerCase()?"closed ":""),e.difference){var r=this.getTotalSecs(e.difference);r>0?t+="log-high ":r<0&&(t+="log-less ")}return t}},{key:"getTotalSecs",value:function(e){if("string"===typeof e){var t=null;if(!e||(t=e.split(":")).length<2)return e;var r=60*parseInt(t[0],0)*60;return r+=60*parseInt(t[1],0),t.length>2&&(r+=parseInt(t[2],0)),r}if("number"===typeof e)return e/1e3}},{key:"convertDate",value:function(e){if(!e)return e;if(e instanceof Date)return e;if("string"===typeof e&&e.indexOf("/Date(")>-1)return new Date(parseInt(e.replace("/Date(","").replace(")/",""),10));var t=I(e);return t.isValid()?t.toDate():void 0}},{key:"getDateArray",value:function(e,t){for(var r=[],n=new Date(e);n<=t;)r.push(new Date(n)),n=n.addDays(1);return r}},{key:"yesno",value:function(e){return!0===e||!1===e?"Yes":e}},{key:"avg",value:function(e,t){return e?t?e.avg((function(e){return e[t]})):e.avg():null}},{key:"sum",value:function(e,t){return e?t?e.sum((function(e){return e[t]})):e.sum():null}},{key:"min",value:function(e,t){return e?t?e.min((function(e){return e[t]})):e.min():null}},{key:"max",value:function(e,t){return e?t?e.max((function(e){return e[t]})):e.max():null}},{key:"bytes",value:function(e,t){if(isNaN(parseFloat(e))||!isFinite(e))return"-";"undefined"===typeof t&&(t=1);var r=Math.floor(Math.log(e)/Math.log(1024));return"".concat((e/Math.pow(1024,Math.floor(r))).toFixed(t)," ").concat(["bytes","kB","MB","GB","TB","PB"][r])}},{key:"convertSecs",value:function(e,t){return t||(t={}),e?(Array.isArray(e)&&(e=e.sum()),e=Number(e),t.format?this.formatSecs(e,t.showZeroSecs):parseFloat((e/3600).toFixed(4))):t.showZeroSecs?0:""}},{key:"count",value:function(e,t){return e?t?e.count((function(e){return e[t]})):e.count():null}},{key:"cut",value:function(e,t,r,n){if(!e||-1===t)return e;if(!(t=parseInt(t||20,10)))return e;if(e.length<=t)return e;if(e=e.substr(0,t),r){var a=e.lastIndexOf(" ");-1!==a&&("."!==e.charAt(a-1)&&","!==e.charAt(a-1)||(a-=1),e=e.substr(0,a))}return e+(n||"...")}},{key:"formatSecs",value:function(e,t,r,n){if(0===e)return t?"0s":"";e&&Array.isArray(e)&&(e=e.sum());var a,i,s,o,u="";return(e=Number(e))<0&&(u="-",e=Math.abs(e)),n?(a=Math.floor(e/86400),e%=86400,i=Math.floor(e/3600),s=Math.floor(e%3600/60),o=Math.floor(e%3600%60)):(i=Math.floor(e/3600),s=Math.floor(e%3600/60),o=Math.floor(e%3600%60)),r?"".concat(u).concat(a>0?"".concat(a.pad(2),":"):"").concat(i>0?i.pad(2):"00",":").concat(s>0?s.pad(2):"00"):u+((a>0?"".concat(a,"d "):"")+(i>0?"".concat(i,"h "):"")+(s>0?"".concat(s,"m "):"")+(o>0?"".concat(o,"s"):"")).trim()}},{key:"formatTs",value:function(e,t){return this.formatSecs(this.getTotalSecs(e),!1,t)}},{key:"formatUser",value:function(e,t){if(!e)return null;switch(t){case"EM":return e.emailAddress;case"LG":return Object(p.e)(e);case"NE":return"".concat(e.displayName," (").concat(e.emailAddress,")");case"NL":return"".concat(e.displayName," (").concat(Object(p.e)(e),")");default:return e.displayName}}},{key:"propOfNthItem",value:function(e,t,r,n){if(!e)return null;if(!Array.isArray(e))return"#Error:Array expected";if(!e.length)return null;if("string"===typeof t&&isNaN(Number(t))&&"last"===t&&(t=e.length-1),t=Number(t),!isNaN(t)){if((t-=0)<0)return"#Error:Out of L Bound";if(t>=e.length)return"#Error:Out of U Bound"}return this.getProperty(e[t],r,n)}},{key:"getProperty",value:function(e,t,r){return e?(r&&"string"===typeof e&&(e=this.convertCustObj(e)),t?e[t]:e):e}},{key:"convertCustObj",value:function(e){var t;if(Array.isArray(e)){var r=[];for(t=0;t<e.length;t++)r[t]=this.convertCustObj(e[t]);return r}return"string"===typeof e?Object(p.g)(e):e}}]),e}(),ke=function(){function e(t,r,n,a,i,s,o){Object(l.a)(this,e),this.$userutils=t,this.$jira=r,this.$session=n,this.$db=a,this.$ticket=i,this.$ajax=s,this.$utils=o}return Object(d.a)(e,[{key:"getUploadedWorklogs",value:function(e,t,r,n){var a=this,i=I(e).startOf("day"),s=I(t).endOf("day");e=i.toDate(),t=s.toDate();var o="";r&&0!==r.length?o='"'.concat(r.join('", "'),'"'):(o="currentUser()",r=[Object(p.e)(this.$session.CurrentUser)]);var u="worklogAuthor in (".concat(o,") and worklogDate >= '").concat(i.clone().add(-1,"days").format("YYYY-MM-DD"),"' and worklogDate < '").concat(s.clone().add(1,"days").format("YYYY-MM-DD"),"'");return n&&0!==n.length||(n=["worklog"]),this.$jira.searchTickets(u,n).then((function(n){for(var i=r.map((function(e){return{logData:[],userName:e.toLowerCase()}})),s={},o=0;o<i.length;o++){var u=i[o];s[u.userName]=u}for(var c=0;c<n.length;c++)for(var l=n[c],d=l.fields||{},h=(d.worklog||{}).worklogs||[],f=0;f<h.length;f++){var g=h[f]||{},v=I(g.started).toDate(),m=I(g.started).startOf("day").toDate();if(m.getTime()>=e.getTime()&&m.getTime()<=t.getTime()){var y=s[Object(p.e)(g.author,!0)];if(y){var k=g.timeSpentSeconds/60;y.logData.push({ticketNo:l.key,url:a.$userutils.getTicketUrl(l.key),issueType:(d.issuetype||"").name,parent:(d.parent||"").key,summary:d.summary,logTime:v,comment:g.comment,totalHours:"".concat(parseInt((k/60).toString()).pad(2),":").concat(parseInt((k%60).toString()).pad(2)),worklogId:g.id})}}}return i}))}},{key:"getPendingWorklogs",value:function(){var e=this;return this.$db.worklogs.where("createdBy").equals(this.$session.userId).and((function(e){return!e.isUploaded})).toArray().then((function(t){var r=t.distinct((function(e){return e.ticketNo}));return e.$ticket.getTicketDetails(r).then((function(e){return t.map((function(t){var r=(e[t.ticketNo.toUpperCase()]||{}).fields||{},n=t;return n.summary=r.summary||"(unavailable)",n.status=(r.status||"").name||"(unavailable)",n}))}))}))}},{key:"uploadWorklogs",value:function(e,t){var r=this;return this.$db.worklogs.where("id").anyOf(e).toArray().then((function(e){var t=e.groupBy((function(e){return e.ticketNo})).map((function(e){var t=null;return e.values.forEach((function(e){t=t?t.then((function(t){return r.uploadWorklog(e)})):r.uploadWorklog(e)})),t}));return Promise.all(t).then((function(){return e}))})).then((function(e){return t?e:r.getPendingWorklogs()}))}},{key:"uploadWorklog",value:function(e){var t=this,r=e.overrideTimeSpent||e.timeSpent;return this.upload(e.ticketNo,e.dateStarted,r,e.description,e.worklogId).then((function(n){return e.worklogId=n.id,e.isUploaded=!0,e.timeSpent=r,delete e.overrideTimeSpent,e.parentId?t.$db.worklogs.put(e).then((function(){return e})):e.id!==j.g?t.$db.worklogs.delete(e.id).then((function(){return e.id=j.g,e})):e}))}},{key:"upload",value:function(e,t,r,n,a){var i={comment:n,started:this.$utils.formatDateTimeForJira(t),timeSpent:this.$utils.formatTs(r)};return(a>0?this.$ajax.put(j.c.updateIndividualWorklog,i,e,a):this.$ajax.post(j.c.addIssueWorklog,i,e,a||0)).then(null,(function(t){if(400===t.status&&((t.error||{}).errorMessages||[]).some((function(e){return e.indexOf("non-editable")>-1})))return Promise.reject({message:"".concat(e," is already closed and cannot upload worklog")});return Promise.reject(t)}))}},{key:"deleteWorklogs",value:function(e){var t=this,r=[];return this.$db.worklogs.where("id").anyOf(e).toArray().then((function(e){return e.forEach((function(e){r.push(t.deleteWorklog(e))})),Promise.all(r)}))}},{key:"deleteWorklog",value:function(e){var t=this,r=this.$db.worklogs.where("id").equals(e.id).delete().then(null,(function(t){return e.worklogId?0:Promise.reject(t)}));return e.worklogId>0&&r.then((function(){return t.$ajax.delete(j.c.individualWorklog,e.ticketNo,e.worklogId)})),r}},{key:"deleteWorklogsBefore",value:function(e){return this.$db.worklogs.where("dateStarted").below(e).delete()}},{key:"getWorklogs",value:function(e){var t=this,r=this.$session.userId,n=I(e.fromDate).toDate(),a=I(e.toDate).endOf("day").toDate(),i=this.$db.worklogs.where("dateStarted").between(n,a,!0,!0).and((function(e){return e.createdBy===r})).toArray(),s=this.getUploadedWorklogs(n,a).then((function(e){return e.first().logData.map((function(e){return{createdBy:r,dateStarted:e.logTime,description:e.comment,id:j.g,isUploaded:!0,timeSpent:e.totalHours,ticketNo:e.ticketNo,worklogId:e.worklogId}}))})),o=Promise.all([i,s]).then((function(e){var t=e[0].filter((function(e){return!e.isUploaded&&!e.worklogId}));return e[1].forEach((function(t){var r=e[0].first((function(e){return e.worklogId===t.worklogId}));r&&(t.id=r.id,t.parentId=r.parentId)})),t.addRange(e[1])}));return!0===e.dateWise?o=o.then((function(e){return t.getDWWorklog(e,n,a)})):!1===e.dateWise&&(o=o.then((function(e){return t.getTWWorklog(e)}))),o}},{key:"getWorklogsEntry",value:function(e,t){var r=this;return this.getWorklogs({fromDate:e.toDate(),toDate:t.toDate()}).then((function(e){return e.map((function(e){return r.getWLCalendarEntry(e)}))}))}},{key:"copyWorklog",value:function(e,t){var r=this,n={createdBy:this.$session.CurrentUser.userId,dateStarted:I(t).toDate(),description:e.description,timeSpent:e.overrideTimeSpent||e.timeSpent,ticketNo:e.ticketNo,isUploaded:!1};return this.$db.worklogs.add(n).then((function(e){return n.id=e,r.getWLCalendarEntry(n)}))}},{key:"changeWorklogDate",value:function(e,t){var r=this;return(isNaN(Number(e.id))||e.id===j.g?Promise.resolve(e):this.$db.worklogs.where("id").equals(e.id).first()).then((function(e){e.dateStarted=I(t).toDate();var n=function(){return r.getWLCalendarEntry(e)};return e.worklogId>0?r.uploadWorklog(e).then((function(){return n()})):r.$db.worklogs.put(e).then((function(){return n()}))}))}},{key:"changeWorklogTS",value:function(e,t){var r=this;return(isNaN(Number(e.id))||e.id===j.g?Promise.resolve(e):this.$db.worklogs.where("id").equals(e.id).first()).then((function(e){e.timeSpent=t,delete e.overrideTimeSpent;var n=function(){return r.getWLCalendarEntry(e)};return e.worklogId>0?r.uploadWorklog(e).then((function(){return n()})):r.$db.worklogs.put(e).then(n)}))}},{key:"getLocalWorklog",value:function(e){return this.$db.worklogs.where("id").equals(parseInt("".concat(e))).first()}},{key:"getWorklog",value:function(e){return e.isUploaded?this.$jira.getJAWorklog(e.worklogId,e.ticketNo):this.getLocalWorklog(e.id)}},{key:"saveWorklog",value:function(e,t){var r=this;return this.$ticket.getTicketDetails(e.ticketNo).then((function(n){if(!n)return Promise.reject("".concat(e.ticketNo," is not a valid Jira Key"));if(!r.$session.CurrentUser.allowClosedTickets&&"closed"===n.fields.status.name.toLowerCase())return Promise.reject("".concat(n.key," is already closed. Cannot add worklog for closed ticket!"));var a={createdBy:r.$session.userId,dateStarted:I(e.dateStarted).toDate(),ticketNo:n.key,description:e.description};e.id&&e.id!==j.g&&(a.id=e.id),e.isUploaded&&(a.isUploaded=e.isUploaded),e.worklogId&&(a.worklogId=e.worklogId),e.timeSpent&&(a.timeSpent=e.timeSpent),e.overrideTimeSpent&&(a.overrideTimeSpent=e.overrideTimeSpent),e.parentId&&(a.parentId=e.parentId);var i=null;return i=(e=a).id>0?r.$db.worklogs.put(e):r.$db.worklogs.add(e).then((function(t){e.id=t})),(t||e.worklogId)&&(i=i.then((function(){return r.uploadWorklog(e)}))),i.then((function(){return r.getWLCalendarEntry(e)}))}),(function(e){return console.log("error for ticket number",e),Promise.reject(e)}))}},{key:"getWLCalendarEntry",value:function(e){var t={entryType:1,start:e.dateStarted,title:"".concat(e.ticketNo,": ").concat(e.description||"(no comment provided)"),id:e.id.toString()+(e.worklogId?"#".concat(e.worklogId):""),url:"",end:I(e.dateStarted).add(this.getTimeSpent(e),"minutes").toDate(),editable:!0,sourceObject:e};return e.parentId&&(t.parentId=e.parentId),t}},{key:"getTimeSpent",value:function(e,t){if(!e)return 0;var r="string"===typeof e?e:e.overrideTimeSpent||e.timeSpent;if(!r)return 0;var n=r.replace(" ","0").split(":");return 2===n.length?(60*parseInt("0".concat(n[0]))+parseInt("0".concat(n[1])))*(t?6e4:1):0}},{key:"getDWWorklog",value:function(e,t,r){var n=this,a=this.$userutils.getDays(t,r),i=e.groupBy((function(e){return e.dateStarted.format("yyyy-MM-dd")}));i=a.leftJoin(i,(function(e,t){return e.date.format("yyyy-MM-dd")===t.key})).select((function(e){return e.right||(e.left.isHoliday||e.left.isFuture?null:{key:e.left.date.format("yyyy-MM-dd"),values:[]})})).map((function(e){var t=e.values,r=I(e.key,"YYYY-MM-DD").toDate();return{key:e.key,dateLogged:r,difference:0,uploaded:60*t.filter((function(e){return e.isUploaded})).sum((function(e){return n.getTimeSpent(e)}))*1e3,pendingUpload:60*t.filter((function(e){return!e.isUploaded})).sum((function(e){return n.getTimeSpent(e)}))*1e3,totalHours:60*t.sum((function(e){return n.getTimeSpent(e)}))*1e3,ticketList:t.map((function(e){return{id:e.id,ticketNo:e.ticketNo,uploaded:e.overrideTimeSpent||e.timeSpent,comment:e.description,worklogId:e.worklogId}}))}})).orderByDescending((function(e){return e.key}));var s=this.$session.CurrentUser.maxHours;return s=60*s*60*1e3,i.forEach((function(e){if(null!==s&&s>0){var t=e.totalHours-s;0!==t&&(e.difference=t)}})),i}},{key:"getTWWorklog",value:function(e){var t=this,r=e;return this.$ticket.getTicketDetails(r.distinct((function(e){return e.ticketNo}))).then((function(e){return r.groupBy((function(e){return e.ticketNo})).map((function(r){var n=e[r.key],a={ticketNo:r.key,parentSumm:((n.fields.parent||"").fields||"").summary,parentKey:((n.fields||"").parent||"").key,summary:n.fields.summary,status:(n.fields.status||"").name,uploaded:60*r.values.filter((function(e){return e.isUploaded})).sum(t.getTimeSpent)*1e3,totalHours:60*r.values.sum(t.getTimeSpent)*1e3,logData:r.values.map((function(e){return{id:e.id,dateLogged:e.dateStarted,uploaded:e.overrideTimeSpent||e.timeSpent,worklogId:e.worklogId}}))};return a.pendingUpload=a.totalHours-a.uploaded,a})).orderBy((function(e){return e.ticketNo}))}))}}]),e}();function be(){Object(n.b)(w,"AjaxService","$ajax"),Object(n.b)(S,"AnalyticsService","$analytics"),k.isChrome?(console.log("Chrome Browser service injected"),Object(n.b)(A,"AppBrowserService","$jaBrowserExtn")):k.isFirefox?(console.log("Firefox Browser service injected"),Object(n.b)(C,"AppBrowserService","$jaBrowserExtn")):k.isEdge&&(console.log("Edge Browser service injected"),Object(n.b)(D,"AppBrowserService","$jaBrowserExtn")),Object(n.b)(E,"AuthService","$auth"),Object(n.b)(L,"BookmarkService","$bookmark"),Object(n.b)(M,"CacheService","$cache"),Object(n.b)(P,"CalendarService","$calendar"),Object(n.b)(F,"ConfigService","$config"),Object(n.b)(N,"DashboardService","$dashboard"),Object(n.b)(V,"DatabaseService","$db"),Object(n.b)(J,"JiraService","$jira"),Object(n.b)(R,"JiraUpdatesService","$jupdates"),Object(n.b)(_,"MessageService","$message"),Object(n.b)(q,"NotificationService","$noti"),Object(n.b)(Z,"OutlookService","$outlook"),Object(n.b)(ee,"QueueService","$q",{isSingleton:!1}),Object(n.b)(te,"ReportService","$report"),Object(n.b)(ue,"ReportConfigService","$reportConfig"),Object(n.b)(ce,"SessionService","$session"),Object(n.b)(le,"SuggestionService","$suggestion"),Object(n.b)(de,"TicketService","$ticket"),Object(n.b)(ge,"UserService","$user"),Object(n.b)(ve,"UserGroupService","$usergroup"),Object(n.b)(me,"UserUtilsService","$userutils"),Object(n.b)(ye,"UtilsService","$utils"),Object(n.b)(ke,"WorklogService","$worklog")}ke.dependencies=["UserUtilsService","JiraService","SessionService","DatabaseService","TicketService","AjaxService","UtilsService","MessageService"]},47:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n={None:0,AddWorklog:1,WorklogModified:2,DeletedWorklog:3,TicketBookmarked:10,SettingsChanged:20,RemoveGadget:100}},49:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"c",(function(){return u})),r.d(t,"b",(function(){return c}));var n=r(44),a=r.n(n),i=r(45),s={ecmaVersion:10,sourceType:"script",ecmaFeatures:{jsx:!1,globalReturn:!1,impliedStrict:!0}};function o(e,t,r){var n,o=r.array,u=r.getObjVal;r.sandbox;null!==t&&void 0!==t&&t.$this&&(e="(function () { return ".concat(e,";}).call(_$this_)"));var c={};null!==t&&void 0!==t&&t.$this&&(c._$this_=null===t||void 0===t?void 0:t.$this);var l=null===(n=Object(i.parse)(e,s))||void 0===n?void 0:n.body[0],d=function(){return a()(l,c)},h=!0===(null===t||void 0===t?void 0:t.noWrap),f=null;h||(f=function(e,t,r,n){return c.Fields=e,c.RowGroup=t,c.ColGroup=r,c.Variables=n,c.Field=function(t){return u(e,t)},d()});var p=function(e,t,r,n,a,i,s,o){return c.CommonFunctions=e,c.MyFunctions=t,c.Parameters=r,c.Datasets=n,c.array=a,c.getObjVal=i,c.ReportState=s,c.setReportState=o,h?d():f};if(t){var g=t.commonFunctions,v=t.myFunctions,m=t.parameters,y=t.datasets,k=t.setReportState,b=t.getReportState;p=p(g,v,m,y,o,u,b,k)}return p}function u(e){e.indexOf("\n")>-1&&(e="(function () { ".concat(e," }).call(this)"));try{var t;return null===(t=Object(i.parse)(e,s))||void 0===t?void 0:t.body[0]}catch(r){return r.toString()}}function c(e,t){return a()(e,t)}},75:function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r(79),a=r(8),i=r(5),s=r(6),o=r(46),u=r(15),c=r(16),l=r(2),d=r.n(l),h=r(14),f=(r(138),r(35)),p=(r(223),r(110)),g=(r(226),r(227),r(228),r(229),r(230),r(231),r(111)),v=function(){return d.a.createElement("div",{style:{position:"fixed",top:"0px",left:"0px",height:"100%",minHeight:"600px",width:"100%",minWidth:"700px",zIndex:3e3,backgroundColor:"#f1f5f9"}},d.a.createElement("div",{className:"center-block",style:{width:"200px",marginTop:"150px"}},d.a.createElement("h4",{className:"animated fadeIn text-center"},d.a.createElement("i",{className:"fa fa-refresh fa-spin",style:{fontSize:"150px",fontWeight:"bold"}}),d.a.createElement("br",null),d.a.createElement("br",null),"Loading... Please wait...")))},m=d.a.lazy((function(){return Promise.all([r.e(6),r.e(16),r.e(5),r.e(20)]).then(r.bind(null,240))})),y=d.a.lazy((function(){return Promise.all([r.e(6),r.e(5),r.e(36)]).then(r.bind(null,238))})),k=d.a.lazy((function(){return r.e(30).then(r.bind(null,239))})),b=Object(l.createContext)({}),w=function(e){Object(u.a)(r,e);var t=Object(c.a)(r);function r(e){var n;return Object(i.a)(this,r),(n=t.call(this,e)).contextProps={switchUser:function(e){var t=document.location.hash.substring(2);t=t.substring(t.indexOf("/")),t="/".concat(e).concat(t),n.authenticateUser(t,!0)},navigate:function(e,t){n.props.history.push(t?"/".concat(n.$session.userId).concat(e):e)}},n.getMessanger=function(){return d.a.createElement(p.Growl,{ref:function(e){return n.messenger=e},baseZIndex:3e3})},Object(f.a)(),Object(f.b)(Object(o.a)(n),"AnalyticsService","SessionService","AuthService","MessageService","AnalyticsService"),n.state={isLoading:!0,needIntegration:!1,authenticated:!1},n.props.history.listen(n.routeChanged.bind(Object(o.a)(n))),n}return Object(s.a)(r,[{key:"routeChanged",value:function(e){this.$analytics.trackPageView(e.pathname)}},{key:"UNSAFE_componentWillMount",value:function(){var e=this;this.$message.onNewMessage((function(t){var r=t.detail;r&&"string"!==typeof r&&(r=r.toString(),t=Object(a.a)(Object(a.a)({},t),{},{detail:r})),e.messenger&&e.messenger.show(t)})),this.authenticateUser(this.props.location.pathname)}},{key:"authenticateUser",value:function(e,t){var r=this,n=e.split("/"),a=parseInt(n[1]);a&&Object(g.isNumber)(a)||(a=null),e.endsWith("/dashboard")&&(t=!0,e+="/0"),e.startsWith("/dashboard")&&(t=!0),"integrate"===n[1]?this.setState({isLoading:!1}):this.$auth.authenticate(a).then((function(n){r.$analytics.trackPageView(),n?e&&"/"!==e?t?(e.startsWith("/dashboard")&&(e="/".concat(r.$session.userId).concat(e)),r.props.history.push(e)):a||r.props.history.push("/".concat(r.$session.userId).concat(e)):r.props.history.push("/".concat(r.$session.userId,"/dashboard/0")):r.props.history.push(r.$session.needIntegration?"/integrate":"/401");var i=r.$session.userId||null;r.setState({isLoading:!1,authenticated:n,jiraUrl:r.$session.rootUrl,userId:i})}),(function(){r.props.history.push(r.$session.needIntegration?"/integrate":"/401"),r.setState({isLoading:!1,needIntegration:r.$session.needIntegration,jiraUrl:r.$session.rootUrl})}))}},{key:"render",value:function(){var e=this,t=this.state,r=t.isLoading,a=t.userId;return r?d.a.createElement(d.a.Fragment,null,this.getMessanger(),v()):d.a.createElement(d.a.Fragment,null,this.getMessanger(),d.a.createElement(b.Provider,{value:this.contextProps},d.a.createElement(d.a.Suspense,{fallback:v()},d.a.createElement(h.g,null,d.a.createElement(h.d,{exact:!0,path:"/integrate",name:"Integrate Page",render:function(e){return d.a.createElement(y,e)}}),d.a.createElement(h.d,{exact:!0,path:"/401",name:"Page 401",render:function(t){return d.a.createElement(k,Object(n.a)({},t,{jiraUrl:e.state.jiraUrl}))}}),d.a.createElement(h.d,{key:a,path:"/:userId",name:"Home",render:function(e){return d.a.createElement(m,e)}})))))}}]),r}(l.PureComponent);t.b=Object(h.o)(w)},9:function(e,t,r){"use strict";r.d(t,"c",(function(){return i})),r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return o}));r(42);var n=r(8),a=function(){var e={},t={isSingleton:!0},r={getRef:function(t){if(!t)throw Error("Service name is required to resolve it");if("string"!==typeof t)throw Error("Service name must be a string");t=t.trim();var r=e[t];if(r||-1!==t.indexOf("Service")||(r=e["".concat(t,"Service")]),!r)throw Error("'".concat(t,"' is not a known service"));return r},resolve:function(e){var t=r.getRef(e);if(t.isSingleton&&t.instance)return t.instance;var n=null;if(t.dependency){var a=t.dependency.length,i=new Array(a+1);i[0]=t.type;for(var s=0;s<a;s++)i[s+1]=r.resolve(t.dependency[s]);n=new(t.type.bind.apply(t.type,i))}else n=new t.type;return t.isSingleton&&(t.instance=n),n},injectable:function(e,t,n,a){return r.addService(t,e,n,e.dependencies,a),e},inject:function(e,t){t.forEach((function(t){var n=r.getRef(t);e[n.defaultName]=r.resolve(t)}))},addService:function(r,a,i,s,o){if(!r)throw Error("Service name is required to resolve it");if("string"!==typeof r)throw Error("Service name must be a string");if(s=s||a.dependencies){if(!Array.isArray(s))throw Error("Dependencies must be an array with the name of services");0===s.length&&(s=null)}r=r.trim();var u={isSingleton:(o=Object(n.a)(Object(n.a)({},t),o)).isSingleton,type:a,instance:null,dependency:s,name:r,defaultName:i};e[r]=u}};return r}();function i(e){return a.resolve(e)}function s(e,t,r,n){return a.injectable(e,t,r,n)}function o(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];a.inject(e,r)}}},[[130,12,4,17]]]);
//# sourceMappingURL=index.89f7d481.chunk.js.map