(this["webpackJsonpjira-assistant"]=this["webpackJsonpjira-assistant"]||[]).push([[27],{531:function(e,t,a){},852:function(e,t,a){"use strict";a.r(t);var r=a(12),i=a(31),n=a(8),s=a(5),o=a(6),c=a(46),l=a(243),u=a(37),m=a(15),p=a(16),d=a(2),g=a.n(d),k=a(420),f=a(245),b=a(242),h=a(9),y=(a(531),a(10)),v={issuekey:"issuekey",ticketno:"issuekey",ticket:"issuekey",issue:"issuekey",key:"issuekey",id:"issuekey",project:"project",projectkey:"project",parent:"parent",parentkey:"parent",parentticket:"parent",parentticketno:"parent",parentissue:"parent",parentid:"parent",status:"status",issuestatus:"status",summary:"summary",priority:"priority",resolution:"resolution",description:"description",estimate:"timetracking.originalEstimate",originalestimate:"timetracking.originalEstimate",initialestimate:"timetracking.originalEstimate",remaining:"timetracking.remainingEstimate",remainingestimate:"timetracking.remainingEstimate",currentestimate:"timetracking.remainingEstimate",assignee:"assignee",assignto:"assignee",assignedto:"assignee",reporter:"reporter",reported:"reporter",reportedby:"reporter",issuetype:"issuetype",type:"issuetype",label:"labels"},E=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(s.a)(this,a),(r=t.call(this,e,"Issue","fa fa-ticket")).transformHeader=function(e){e=e.replace(/ /g,"").toLowerCase();var t=v[e]||null;if(!t){var a=r.customFields.first((function(t){return t.id.toLowerCase()===e||t.name.replace(/ /g,"").toLowerCase()===e||t.clauseNames&&t.clauseNames.some((function(t){return t.replace(/ /g,"").toLowerCase()===e}))}));a&&(t=a.id)}return t||e},r.toggleAllRows=function(){var e=r.state,t=e.importData,a=e.selectAll;a=!a,t=t.map((function(e){return(e=Object(n.a)({},e)).selected=!e.disabled&&a,e})),r.setState({importData:t,selectAll:a,selectedCount:r.getSelectedCount(t)})},r.toggleSelection=function(e,t){(e=Object(n.a)({},e)).selected=!e.disabled&&!e.selected;var a=r.state.importData;(a=Object(i.a)(a))[t]=e,r.setState({selectAll:!0,importData:a,selectedCount:r.getSelectedCount(a)})},r.getSelectedCount=function(e){return e.filter((function(e){return e.selected})).length},r.importIssues=function(){var e=r.state.importData,t=e.findAllIndex((function(e){return e.selected})),a=t.map((function(t){return e[t]}));r.setState({isLoading:!0,uploading:!0}),r.$ticket.importIssues(a).then((function(a){e=Object(i.a)(e),t.forEach((function(t,r){e[t]=a[r]})),r.setState({isLoading:!1,uploading:!1,importData:e})}),(function(e){r.$message.error(e,"Import failed"),r.setState({isLoading:!1,uploading:!1})}))},r.downloadTemplate=function(){Object(y.a)(["Ticket No,Project,Parent ticket,IssueType,Summary,Assignee,Reporter,Priority,Status,Resolution",",JAS,,Story,Sample template to be downloaded for Issues import,admin",",JAS,,Bug,Summary of Bug to be imported,admin",",JAS,,Task,Third task to be imported,admin"].join("\n"),"sample_issues")},r.clearImportData=function(){r.setState({importFields:[],ticketDetails:{},importData:null,selectedCount:null})},Object(h.a)(Object(c.a)(r),"JiraService","TicketService","MessageService"),r.metadata={},r.state={importData:[],importFields:[],ticketDetails:{}},r}return Object(o.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){var e=this;this.$jira.getCustomFields().then((function(t){return e.customFields=t}))}},{key:"processData",value:function(e){var t=this;this.$ticket.processIssuesForImport(e).then((function(e){var a=e.importData;a&&a.forEach((function(e){e.disabled=e.hasError,e.selected=!e.disabled})),t.setState(Object(n.a)(Object(n.a)({},e),{},{selectedCount:t.getSelectedCount(a)}))}))}},{key:"renderFooter",value:function(){var e=this.state,t=e.isLoading,a=e.selectedCount,r="Import ".concat(a||""," Issues");return g.a.createElement("div",{className:"pnl-footer"},g.a.createElement("div",{className:"pull-right"},g.a.createElement(b.b,{type:"info",icon:"fa fa-list",label:"Clear",disabled:t,onClick:this.clearImportData}),g.a.createElement(b.b,{type:"success",icon:"fa fa-upload",disabled:t||!(a>0),label:r,onClick:this.importIssues})))}},{key:"render",value:function(){var e=this,t=this.state,r=t.importData,i=t.importFields,n=t.ticketDetails,s=t.selectAll;return Object(l.a)(Object(u.a)(a.prototype),"renderBase",this).call(this,g.a.createElement("div",{className:"import-issue"},g.a.createElement(f.c,{dataset:r,className:"issue-table"},g.a.createElement(f.e,null,g.a.createElement(f.f,null,g.a.createElement(f.a,null,"#"),g.a.createElement(f.a,null,g.a.createElement(b.c,{checked:s,onChange:this.toggleAllRows})),g.a.createElement(f.a,null,"Ticket No"),i.map((function(e,t){return g.a.createElement(f.a,{key:t},e.name)})),g.a.createElement(f.a,{sortBy:"status"},"Status"))),g.a.createElement(f.d,null,(function(t,a){return g.a.createElement(j,{key:a,index:a,row:t,ticketDetails:n,importFields:i,toggleSelection:e.toggleSelection,getTicketLink:e.getTicketLink})})),g.a.createElement(f.b,{span:12},"Upload the list of issues by clicking the ( ",g.a.createElement("span",{className:"fa fa-upload"})," ) icon in top right corner. Click ",g.a.createElement("span",{className:"link",onClick:this.downloadTemplate},"here")," to download a sample template."))))}}]),a}(k.a);t.default=E;var j=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(s.a)(this,a);for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];return(e=t.call.apply(t,[this].concat(i))).toggleSelection=function(){var t=e.props,a=t.row,r=t.index;e.props.toggleSelection(a,r)},e}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props,t=e.row,a=e.ticketDetails,r=e.importFields,i=e.index,n=t.raw,s=t.options,o=t.fields,c=t.hasError,l=t.disabled,u=t.selected,m=t.statusErrors,p=a[n.issuekey]||null;return g.a.createElement("tr",{className:t.error?"row-error":""},g.a.createElement("td",{className:c?"error-row":"valid-row"},i+1),g.a.createElement("td",null,g.a.createElement(b.c,{checked:u,disabled:l,onChange:this.toggleSelection})),g.a.createElement(S,{rawTicket:p,issuekey:n.issuekey,option:s.issuekey,getTicketLink:this.props.getTicketLink}),r.map((function(e,a){var r=e.key,i=n[r],c=s[r],l=o[r];return g.a.createElement(w,{key:a,index:a,row:t,field:e,value:i,option:c,metadata:l,rawTicket:p})})),g.a.createElement("td",{title:"One or more errors exists"},c&&g.a.createElement("span",{title:m,className:"fa fa-exclamation-triangle msg-error"})," ",t.status))}}]),a}(d.PureComponent);function O(e,t){var a=e&&e.length>0,r=t&&t.length>0;if(a||r){var i="fa fa-exclamation-triangle ".concat(a?"msg-error":"msg-warning");return g.a.createElement("span",{title:a?e:t,className:i})}}var S=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(s.a)(this,a),r=t.call(this,e),Object(h.a)(Object(c.a)(r),"JiraService"),r}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props,t=e.issuekey,a=e.option,r=e.rawTicket,i=a||{},n=O(i.errors,i.warnings);return r?g.a.createElement("td",null,this.props.getTicketLink(t)," ",n):g.a.createElement("td",null,t," ",n)}}]),a}(d.PureComponent),w=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(s.a)(this,a),r=t.call(this,e),Object(h.a)(Object(c.a)(r),"JiraService"),r}return Object(o.a)(a,[{key:"render",value:function(){var e=this.props,t=e.option,a=e.rawTicket,i=e.field,n=(i=void 0===i?{}:i).key,s=(a||{}).fields,o=t||{},c=o.errors,l=o.warnings,u=(t||{}).displayValue;if(!u&&s&&n){var m=s[n];m&&"object"===Object(r.a)(m)?u=m.name||m.key||m.id:m&&(u=m)}return g.a.createElement("td",null,u," ",O(c,l))}}]),a}(d.PureComponent)}}]);
//# sourceMappingURL=27.4ef346e4.chunk.js.map