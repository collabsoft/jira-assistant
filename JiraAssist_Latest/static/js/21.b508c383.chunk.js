(this["webpackJsonpjira-assistant"]=this["webpackJsonpjira-assistant"]||[]).push([[21],{255:function(e,t,a){"use strict";var r=a(8),n=a(5),o=a(6),s=a(46),i=a(243),l=a(37),c=a(15),u=a(16),d=a(2),m=a.n(d),p=a(113),g=a(247),f=a(9),h=a(242),v=a(3),y=a.n(v),k=a(262),b=a(1),E=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var o;Object(n.a)(this,a),(o=t.call(this,e,"Add worklog",{width:"550px"})).searchTickets=function(e){return e=(e||"").toLowerCase(),o.allTicketList.filter((function(t){return t.label.toLowerCase().indexOf(e)>-1}))},o.saveWorklog=function(e,t,a){if(!o.validateData(e,t,o.state.ctlClass))return o.$message.warning("Please provide value for all the mandatory fields","Incomplete worklog details"),!1;o.setState({isLoading:!0}),o.$worklog.saveWorklog({ticketNo:o.getTicketNo(e),dateStarted:e.dateStarted,overrideTimeSpent:e.overrideTimeSpent,description:e.description,worklogId:e.worklogId,isUploaded:e.isUploaded,timeSpent:e.timeSpent,parentId:e.parentId,id:e.id},a).then((function(t){o.props.onDone(e.id>0?{type:k.c.WorklogModified,edited:t,previousTime:o.previousTime}:{type:k.c.WorklogModified,added:t}),o.onHide()}),(function(e){o.setState({isLoading:!1}),"string"===typeof e?o.$message.error(e):console.error(e)}))},o.setValue=function(e,t){var a=o.state.log;t?a[e]=t:delete a[e],a=Object(r.a)({},a),o.setState({log:a})},o.formatTs=function(e){return e},o.handleKeyPress=function(e){var t=e.ctrlKey,a=e.charCode;if(t&&13===a){var r=Object(s.a)(o),n=r.isLoading,i=r.state,l=i.log,c=i.vald,u=i.uploadImmediately;n||o.saveWorklog(l,c,u&&!(l.id>0))}},Object(f.a)(Object(s.a)(o),"SessionService","SuggestionService","WorklogService","MessageService","UtilsService"),o.displayDateFormat="yyyy-MM-dd HH:mm";var i=o.$session.CurrentUser,l=i.commentLength,c=i.autoUpload;o.minCommentLength=l||0;var u=e.worklog,d=e.uploadImmediately;return o.state=o.getState(u),o.state.uploadImmediately="boolean"===typeof d?d:c||!1,o.allTicketList=[],o}return Object(o.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){var e=this;this.$suggestion.getTicketSuggestion().then((function(t){e.allTicketList=t})),this.loadWorklog(this.state.log)}},{key:"loadWorklog",value:function(e){e.id&&this.fillWorklog(e,e.copy)}},{key:"getState",value:function(e){var t={showDialog:!0,vald:{},ctlClass:{},isLoading:!1,log:e};if(!e.id){t.log={ticketNo:e.ticketNo,dateStarted:y()(e.startTime||e.dateStarted||new Date).toDate(),allowOverride:e.allowOverride},e.parentId&&(t.log.parentId=e.parentId);var a=e.timeSpent;"number"===typeof a&&(a=this.$utils.formatSecs(a,!1,!0)),!e.allowOverride&&a&&(t.log.timeSpent=a),a?t.log.overrideTimeSpent=a:(t.log.overrideTimeSpent="01:00",t.log.allowOverride=!0),this.validateData(t.log,t.vald,t.ctlClass)}return t}},{key:"fillWorklog",value:function(e,t){var a=this;return this.$worklog.getWorklog(e).then((function(e){e.timeSpent&&(e.timeSpent=e.timeSpent.substring(0,5),"00:00"===e.timeSpent&&(e.timeSpent=null)),e.overrideTimeSpent&&(e.overrideTimeSpent=e.overrideTimeSpent.substring(0,5),e.allowOverride=!0),t?(a.$analytics.trackEvent("Worklog copy",b.i.UserActions,e.isUploaded?"Uploaded worklog":"Pending worklog"),delete e.id,delete e.isUploaded,delete e.worklogId,delete e.parentId,e.dateStarted=y()("".concat((new Date).format("yyyy/MM/dd")," ").concat(e.dateStarted.format("HH:mm:ss"))).toDate()):(a.previousTime=e.dateStarted,a.$analytics.trackEvent("Worklog view",b.i.UserActions,e.isUploaded?"Uploaded worklog":"Pending worklog"));var r={log:e,vald:a.state.vald,ctlClass:a.state.ctlClass};return a.validateData(r.log,r.vald,r.ctlClass),a.setState(r),e}))}},{key:"validateData",value:function(e,t,a){e.allowOverride&&(e.overrideTimeSpent=e.overrideTimeSpent||e.timeSpent||"00:00");var r=!0,n=this.getTicketNo(e);return r=(t.ticketNo=!(!n||n.length<3))&&r,r=(t.dateStarted=!(!e.dateStarted||e.dateStarted.length<16))&&r,t.overrideTimeSpent=e.allowOverride&&e.overrideTimeSpent&&e.overrideTimeSpent.length>=4,t.overrideTimeSpent=t.overrideTimeSpent&&this.$worklog.getTimeSpent(e.overrideTimeSpent)>0,r=(t.overrideTimeSpent=t.overrideTimeSpent||!e.allowOverride&&e.timeSpent&&e.timeSpent.length>=4)&&r,r=(t.description=this.minCommentLength<1||!(!e.description||e.description.length<this.minCommentLength))&&r,a.ticketNo=t.ticketNo?"is-valid":"is-invalid",a.dateStarted=t.dateStarted?"is-valid":"is-invalid",a.overrideTimeSpent=t.overrideTimeSpent?"is-valid":"is-invalid",a.description=t.description?"is-valid":"is-invalid",r}},{key:"getTicketNo",value:function(e){return e&&e.ticketNo?"string"===typeof e.ticketNo?e.ticketNo:e.ticketNo.value:null}},{key:"deleteWorklog",value:function(e){var t=this;this.setState({isLoading:!0});var a=e.ticketNo;e.ticketNo=a.value||a,this.$worklog.deleteWorklog(e).then((function(a){t.setState({isLoading:!1}),t.props.onDone({type:k.c.DeletedWorklog,removed:e.id,deleted:e.id,deletedObj:e}),t.onHide()}),(function(){e.ticketNo=a}))}},{key:"getFooter",value:function(){var e=this,t=this.isLoading,a=this.state,r=a.log,n=a.vald,o=a.uploadImmediately;return m.a.createElement(m.a.Fragment,null,!r.id&&m.a.createElement(h.c,{checked:o,className:"pull-left",label:"Upload immediately to Jira",onChange:function(t){return e.setState({uploadImmediately:t})}}),r.id>0&&m.a.createElement(h.b,{type:"danger",icon:"fa fa-trash-o",label:"Delete",className:"pull-left",disabled:t,onClick:function(){return e.deleteWorklog(r)}}),r.id>0&&!r.worklogId&&m.a.createElement(h.b,{type:"success",isLoading:t,icon:"fa fa-upload",label:"Save & Upload",className:"pull-left",disabled:t,onClick:function(){return e.saveWorklog(r,n,!0)}}),m.a.createElement(h.b,{type:"primary",icon:"fa fa-save",label:"Save",isLoading:t,disabled:t,onClick:function(){return e.saveWorklog(r,n,o&&!(r.id>0))}}),m.a.createElement(h.b,{type:"secondary",icon:"fa fa-times",label:"Cancel",onClick:this.onHide}))}},{key:"render",value:function(){var e=this,t=this.minCommentLength,r=this.state,n=r.log,o=r.vald;return Object(i.a)(Object(l.a)(a.prototype),"renderBase",this).call(this,m.a.createElement("div",{className:"pad-22",onKeyPress:this.handleKeyPress},m.a.createElement("div",{className:"row pad-b"},m.a.createElement("div",{className:"col-sm-3"},m.a.createElement("strong",null,"Log time")),m.a.createElement("div",{className:"p-col-9 col-sm-9"},m.a.createElement("div",{className:"form-group"},m.a.createElement("div",{className:"ctlClass.dateStarted"},m.a.createElement(h.e,{value:n.dateStarted,showTime:!0,onChange:function(t){return e.setValue("dateStarted",t)}})),m.a.createElement("span",{className:"help-block ".concat(o.dateStarted?"":"msg-error")},"Provide the time you had started the work")))),m.a.createElement("div",{className:"row pad-b"},m.a.createElement("div",{className:"col-sm-3"},m.a.createElement("strong",null,"Ticket no")),m.a.createElement("div",{className:"col-sm-9"},m.a.createElement(h.a,{value:n.ticketNo,displayField:"value",className:"w-p-100",placeholder:"Enter the ticket number or start typing the summary to get suggestion",dataset:this.searchTickets,disabled:n.isUploaded,maxlength:20,onChange:function(t){return e.setValue("ticketNo",t)},autoFocus:!0},(function(e){return m.a.createElement("span",{style:{fontSize:12,margin:"10px 10px 0 0"}},e.label)})),m.a.createElement("span",{className:"help-block ".concat(o.ticketNo?"":"msg-error")},"Provide the ticket no on which you had to log your work"))),m.a.createElement("div",{className:"row pad-b"},m.a.createElement("div",{className:"col-sm-3"},m.a.createElement("strong",null,"Actual time spent")),m.a.createElement("div",{className:"col-sm-2"},m.a.createElement("strong",null,this.formatTs(n.timeSpent)||"-")),m.a.createElement("div",{className:"col-sm-4"},m.a.createElement("strong",null,"Override time spent")),m.a.createElement("div",{className:"col-sm-3"},m.a.createElement("div",{className:"form-group no-margin"},m.a.createElement("div",{className:"p-inputgroup ctlClass.overrideTimeSpent"},m.a.createElement("span",{className:"p-inputgroup-addon"},m.a.createElement(h.c,{checked:n.allowOverride||!1,onChange:function(t){return e.setValue("allowOverride",t)}})),m.a.createElement(p.InputMask,{mask:"99:99",className:"w-80",value:n.overrideTimeSpent||"",placeholder:"00:00",maxlength:5,disabled:!n.allowOverride,onChange:function(t){return e.setValue("overrideTimeSpent",t.value)}})))),m.a.createElement("div",{className:"col-sm-3"}),m.a.createElement("div",{className:"col-sm-9 no-t-padding"},m.a.createElement("span",{className:"help-block ".concat(o.overrideTimeSpent?"":"msg-error")},"Provide the time spent on this task (override to change existing)"))),m.a.createElement("div",{className:"row"},m.a.createElement("div",{className:"col-sm-3"},m.a.createElement("strong",null,"Comments")),m.a.createElement("div",{className:"col-sm-9"},m.a.createElement(h.j,{multiline:!0,rows:5,value:n.description||"",className:"form-control ".concat(o.description?"":"ctl-error"),onChange:function(t){return e.setValue("description",t)},placeholder:"Provide a brief info about the task you had done.".concat(t?" Should be atleast ".concat(t," chars is length."):"")})))))}}]),a}(g.a);t.a=E},262:function(e,t,a){"use strict";a.d(t,"c",(function(){return r.a})),a.d(t,"a",(function(){return R})),a.d(t,"b",(function(){return z})),a.d(t,"k",(function(){return ce})),a.d(t,"e",(function(){return me})),a.d(t,"f",(function(){return fe})),a.d(t,"g",(function(){return ye})),a.d(t,"h",(function(){return be})),a.d(t,"j",(function(){return Ee})),a.d(t,"i",(function(){return _})),a.d(t,"d",(function(){return we}));var r=a(47),n=a(31),o=a(0),s=a.n(o),i=a(4),l=a(8),c=a(5),u=a(6),d=a(46),m=a(15),p=a(16),g=a(243),f=a(37),h=a(2),v=a.n(h),y=a(22),k=a.n(y),b=a(244),E=a(9),w=a(316),S=a(294),N=a(317),C=a(318),j=a(3),O=a.n(j),T=a(259),D=a(283),x=a(32),W=a(255),U=a(295),F=a(10),A=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={},e.toggleShowAttendees=function(){return e.setState({showAttendees:!e.state.showAttendees})},e.toggleShowDesc=function(){return e.setState({showFullDesc:!e.state.showFullDesc})},e}return Object(u.a)(a,[{key:"render",value:function(){var e=this.props,t=e.cut,a=e.eventDetails,r=this.state,n=r.showAttendees,o=r.showFullDesc;return a?v.a.createElement("div",{className:"event-details"},v.a.createElement("div",{className:"header"},v.a.createElement("div",{className:"controls"}),v.a.createElement("div",{className:"title"},t(a.summary,75))),v.a.createElement("div",{className:"body"},v.a.createElement("div",{className:"detail"},v.a.createElement("div",{className:"title"},v.a.createElement("i",{className:"fa fa-clock-o"})),v.a.createElement("div",{className:"info"},v.a.createElement("span",null,a.date),v.a.createElement("span",{className:"info"},a.startTime," - ",a.endTime," ",a.remaining))),a.location&&v.a.createElement("div",{className:"detail"},v.a.createElement("div",{className:"title"},v.a.createElement("i",{className:"fa fa-map-marker"})),v.a.createElement("div",{className:"info"},a.location)),a.videoCall&&v.a.createElement("div",{className:"detail"},v.a.createElement("div",{className:"title"},v.a.createElement("i",{className:"fa fa-video-camera"})),v.a.createElement("div",{className:"info"},v.a.createElement("a",{href:a.videoCall.url,target:"_blank",rel:"noopener noreferrer"},"Join meeting: ",a.videoCall.name))),a.attendees&&v.a.createElement("div",{className:"detail pointer"},v.a.createElement("div",{className:"title"},v.a.createElement("i",{className:"fa fa-users"})),v.a.createElement("div",{className:"info",onClick:this.toggleShowAttendees},v.a.createElement("div",{className:"icon pull-right"},v.a.createElement("i",{className:"fa ".concat(n?"fa-angle-up":"fa-angle-down")})),v.a.createElement("div",null,v.a.createElement("span",null,a.attendees.total," guests"),a.attendees&&v.a.createElement("span",{className:"info"},a.attendees.yes&&v.a.createElement("font",null,a.attendees.yes," yes,"),a.attendees.no&&v.a.createElement("font",null,a.attendees.no," no,"),a.attendees.tentative&&v.a.createElement("font",null," ",a.attendees.tentative," tentative,"),a.attendees.awaiting&&v.a.createElement("font",null," ",a.attendees.awaiting," awaiting")))),n&&a.attendees&&v.a.createElement("div",{className:"attendees"},a.attendees.list.map((function(e,t){return v.a.createElement("div",{key:t,className:"attendee"},e.displayName&&v.a.createElement("span",{className:"name"}," ",e.displayName),e.email&&v.a.createElement("span",{className:"email"}," (",e.email,")"))})))),a.description&&v.a.createElement("div",{className:"detail"},v.a.createElement("div",{className:"title"},v.a.createElement("i",{className:"fa fa-align-justify"})),v.a.createElement("div",{className:"info"},Object(F.f)(o?a.description:t(a.description,350))),a.description.length>350&&v.a.createElement("div",{style:{textAlign:"center"}},v.a.createElement("span",{className:"link",onClick:this.toggleShowDesc},o?"show less":"show all"))))):null}}]),a}(h.PureComponent),L=a(247),I=a(242),M=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e,"Calendar configurations")).setValue=function(e,t){var a=r.state.settings;a=Object(l.a)({},a),e?a[t]=e:delete a[t],r.setState({settings:a})},r.onDone=function(){r.props.onDone(r.state.settings),r.onHide()},r.state={showDialog:!0,settings:Object(l.a)({},e.settings)},r.style={width:"667px"},r}return Object(u.a)(a,[{key:"getFooter",value:function(){return v.a.createElement(v.a.Fragment,null,v.a.createElement(I.b,{type:"default",icon:"fa fa-times",label:"Cancel",onClick:this.onHide}),v.a.createElement(I.b,{type:"success",icon:"fa fa-floppy-o",label:"Done",onClick:this.onDone}))}},{key:"render",value:function(){var e=this,t=this.state.settings;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement("div",{className:"pad-22"},v.a.createElement("h3",{className:"control-sidebar-heading"},"Item Colors"),v.a.createElement("div",{className:"form-group row"},v.a.createElement("label",{className:"col-md-3 col-form-label"},"Meeting entry color"),v.a.createElement("div",{className:"col-md-9 col-form-label"},v.a.createElement(I.d,{value:t.eventColor,fieldName:"eventColor",onChange:this.setValue}),v.a.createElement("label",{className:"form-check-label"},"Specify the color of the entry for meeting"))),v.a.createElement("div",{className:"form-group row"},v.a.createElement("label",{className:"col-md-3 col-form-label"},"Worklog entry color"),v.a.createElement("div",{className:"col-md-9 col-form-label"},v.a.createElement(I.d,{value:t.worklogColor,fieldName:"worklogColor",onChange:this.setValue}),v.a.createElement("label",{className:"form-check-label"},"Specify the color of the worklog entry"))),v.a.createElement("div",{className:"form-group row"},v.a.createElement("label",{className:"col-md-3 col-form-label"},"Info color (Valid)"),v.a.createElement("div",{className:"col-md-9 col-form-label"},v.a.createElement(I.d,{value:t.infoColor_valid,fieldName:"infoColor_valid",onChange:this.setValue}),v.a.createElement("label",{className:"form-check-label"},"Specify the color of the info entry when the total hours logged is equal to the max hours to log setting"))),v.a.createElement("div",{className:"form-group row"},v.a.createElement("label",{className:"col-md-3 col-form-label"},"Info color (Less)"),v.a.createElement("div",{className:"col-md-9 col-form-label"},v.a.createElement(I.d,{value:t.infoColor_less,fieldName:"infoColor_less",onChange:this.setValue}),v.a.createElement("label",{className:"form-check-label"},"Specify the color of the info entry when the total hours logged is lesser than the max hours to log"))),v.a.createElement("div",{className:"form-group row"},v.a.createElement("label",{className:"col-md-3 col-form-label"},"Info color (High)"),v.a.createElement("div",{className:"col-md-9 col-form-label"},v.a.createElement(I.d,{value:t.infoColor_high,fieldName:"infoColor_high",onChange:this.setValue}),v.a.createElement("label",{className:"form-check-label"},"Specify the color of the info entry when the total hours logged is higher than the max hours to log"))),v.a.createElement("h3",{className:"control-sidebar-heading"},"Show / Hide Entries"),v.a.createElement("div",{className:"form-group"},v.a.createElement(I.c,{checked:t.showMeetings||!1,onChange:function(t){return e.setValue(t,"showMeetings")},label:"Display entry for meetings integrated from calendar"})),v.a.createElement("div",{className:"form-group"},v.a.createElement(I.c,{checked:t.showWorklogs||!1,onChange:function(t){return e.setValue(t,"showWorklogs")},label:"Display worklog added by you"})),v.a.createElement("div",{className:"form-group"},v.a.createElement(I.c,{checked:t.showInfo||!1,onChange:function(t){return e.setValue(t,"showInfo")},label:"Display information about total hours logged on daily basis"}))))}}]),a}(L.a),$=a(1),P=(a(272),[{value:"dayGridMonth",label:"Month"},{value:"timeGridWeek",label:"Week"},{value:"timeGridDay",label:"Day"}]),R=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var r,n;return Object(c.a)(this,a),(n=t.call(this,e,"Calendar","fa-calendar")).refreshData=function(){n.fillEvents(n.startDate,n.endDate)},n.viewModeChanged=function(e){n.setState({viewMode:e}),n.fc.calendar.changeView(e),n.saveSettings(Object(l.a)(Object(l.a)({},n.state.settings),{},{viewMode:e}),!0)},n.hideWorklogDialog=function(){return n.setState({showAddWorklogPopup:!1})},n.toggleSettingsDialog=function(){return n.setState({showSettingsPopup:!n.state.showSettingsPopup})},n.addEvent=function(e){if(0!==e.type){var t=!1,a=Object(d.a)(n).events;if(e.removed){var r=e.removed+(e.deletedObj.worklogId?"#".concat(e.deletedObj.worklogId):"");e=a.first((function(e){return e.id===r&&1===e.entryType})),a.remove(e),n.latestData.remove((function(t){return t.id===e.id&&1===t.entryType}))}else if(e.added||e.edited){var o=e.previousTime;(e=e.added||e.edited).backgroundColor=n.state.settings.worklogColor,e.borderColor=e.backgroundColor,a.removeAll((function(t){return t.id===e.id&&1===t.entryType})),a.push(e),n.latestData.removeAll((function(t){return t.id===e.id&&1===t.entryType})),n.latestData.push(e),t=!0,o&&n.updateAllDayEvent({start:o})}return n.updateAllDayEvent(e),n.setEventsData(a),t}},n.hideOPEvent=function(){return n.setState({showOpEvent:!1})},n.saveSettings=function(e,t){if(n.isGadget)return Object(g.a)((r=Object(d.a)(n),Object(f.a)(a.prototype)),"saveSettings",r).call(r),void(!0!==t&&n.refreshData());n.$session.pageSettings.calendar=e,n.setState({settings:e},!0!==t?n.refreshData:null),n.$config.saveSettings("calendar",e)},Object(E.a)(Object(d.a)(n),"SessionService","WorklogService","MessageService","AnalyticsService","OutlookService","CalendarService","UtilsService","UserUtilsService","ConfigService","TicketService"),n.hideMenu=!e.isGadget,n.hideExport=!0,e.isGadget&&(n.className="calendar-view"),n.$session.pageSettings.calendar?n.state.settings=Object.assign({showMeetings:!0,showWorklogs:!0,showInfo:!0},n.$session.pageSettings.calendar):n.state.settings={viewMode:"timeGridWeek",showMeetings:!0,showWorklogs:!0,showInfo:!0},n.setMenuItems(),n.CurrentUser=n.$session.CurrentUser,n.maxTime=n.CurrentUser.maxHours,n.maxTime&&(n.maxTime=60*n.maxTime*60),n.fullCalendarOpts=n.getCalendarOptions(),n}return Object(u.a)(a,[{key:"setMenuItems",value:function(){var e=Object(i.a)(s.a.mark((function e(){var t,a,r,n=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.mnuWL_Upload={label:"Upload worklog",icon:"fa fa-upload",command:function(){return n.uploadWorklog()}},this.contextMenuItems=[{label:"Edit worklog",icon:"fa fa-edit",command:function(){return n.showWorklogPopup(n.currentWLItem)}},{label:"Open ticket",icon:"fa fa-external-link",command:function(){return n.openTicket(n.currentWLItem)}},{label:"Copy worklog",icon:"fa fa-copy",command:function(){return n.copyWorklog()}},this.mnuWL_Upload,{label:"Delete worklog",icon:"fa fa-times",command:function(){return n.deleteWorklog()}}],t=(this.$session.CurrentUser.meetingTicket||"").trim().split(",").select((function(e){return e||null})),e.next=5,this.$ticket.getTicketDetails(t);case 5:a=e.sent,r=[],t.length>0&&(t.forEach((function(e){var t=(a[e.toUpperCase()]||{}).fields,o=(t=void 0===t?{}:t).summary,s=void 0===o?"":o;r.push({label:s?"".concat(e,": ").concat(n.$utils.cut(s,65,!0)):e,icon:"fa fa-ticket",command:function(t){return n.createWorklog(t.originalEvent,n.currentMeetingItem,e)}})})),1===t.length&&(this.defaultMeetingTicket=t[0])),r.length>0&&r.push({separator:!0}),r.push({label:"Choose ticket",icon:"fa fa-pencil-square-o",command:function(e){return n.createWorklog(e.originalEvent,n.currentMeetingItem,"")}}),this.mnuCal_AddWL={label:"Add worklog to",icon:"fa fa-clock-o",items:r,command:function(e){return n.createWorklog(e.originalEvent,n.currentMeetingItem,"")}},this.mnuCal_OpenUrl={label:"Open video call",icon:"fa fa-video-camera",command:function(){return n.openVideoCall(n.currentMeetingItem)}},this.calMenuItems=[this.mnuCal_AddWL,{label:"Show details",icon:"fa fa-info-circle",command:function(e){return n.showCalendarDetails({extendedProps:{sourceObject:n.currentMeetingItem}},e.originalEvent,null)}},this.mnuCal_OpenUrl];case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCalendarOptions",value:function(){var e=this.CurrentUser,t=e.startOfWeek,a=e.startOfDay,r=e.endOfDay,n=e.workingDays,o=e.timeFormat,s=this.props.viewMode;this.isGadget||("agendaWeek"===(s=this.state.settings.viewMode)?s="timeGridWeek":"month"===s?s="dayGridMonth":"agendaDay"===s&&(s="timeGridDay"));var i=t;i&&i>0?i-=1:i=null;var l=(o||"").indexOf("tt")>-1,c=!!l&&"short";return{plugins:[S.d,N.a,C.a],timezone:"local",selectHelper:!0,displayEventTime:!0,selectable:!0,firstDay:i,height:"parent",fixedWeekCount:!1,eventLimit:!0,editable:!0,droppable:!0,slotDuration:"00:15:00",minTime:a||"10:00",maxTime:r||"19:00",allDayText:"total",header:!1,nowIndicator:!0,navLinks:!0,defaultView:s,businessHours:{dow:n||[1,2,3,4,5],start:a||"10:00",end:r||"19:00"},slotLabelFormat:{hour:"numeric",minute:"2-digit",omitZeroMinute:l,meridiem:c,hour12:l},eventTimeFormat:{hour:"numeric",minute:"2-digit",omitZeroMinute:l,meridiem:c,hour12:l},select:this.select.bind(this),eventRender:this.eventRender.bind(this),datesRender:this.viewRender.bind(this),eventDrop:this.eventDrop.bind(this),eventResize:this.eventResize.bind(this),eventClick:this.eventClick.bind(this)}}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.viewMode&&this.setState({settings:Object(l.a)(Object(l.a)({},this.state.settings),{},{viewMode:e.viewMode})}),Object(g.a)(Object(f.a)(a.prototype),"UNSAFE_componentWillReceiveProps",this).call(this,e)}},{key:"createWorklog",value:function(e,t,a){var r=this;if(Object(x.hideContextMenu)(),t.start.dateTime){e.stopPropagation(),e.preventDefault();var n=j.duration(j(t.end.dateTime).diff(t.start.dateTime)),o={dateStarted:t.start.dateTime,timeSpent:"".concat(n.hours().pad(2),":").concat(n.minutes().pad(2)),description:t.summary,parentId:t.id};return a?(o.ticketNo=a,this.$worklog.saveWorklog(o).then((function(t){r.addEvent({added:t}),k()(e.currentTarget).remove()}),(function(e){"string"===typeof e?r.$message.error(e):console.error(e)})),this.$analytics.trackEvent("Quick add WL",$.i.UserActions)):this.showWorklogPopup(o),!1}}},{key:"fillEvents",value:function(e,t){var a=this;e=j(e).startOf("day"),t=j(t).endOf("day");var r=[this.$worklog.getWorklogsEntry(e,t)];this.CurrentUser.gIntegration&&this.CurrentUser.hasGoogleCreds&&this.state.settings.showMeetings&&r.push(this.$calendar.getEvents(e,t).then(null,(function(e){var t="Unable to fetch Google meetings!";return e.error&&e.error.message&&(t+="<br /><br />Reason:- ".concat(e.error.message)),a.$message.warning(t),[]}))),this.CurrentUser.oIntegration&&this.CurrentUser.hasOutlookCreds&&this.state.settings.showMeetings&&r.push(this.$outlook.getEvents(e,t).then(null,(function(e){var t="Unable to fetch Outlook meetings!";return e.error&&e.error.message&&(t+="<br /><br />Reason:- ".concat(e.error.message)),a.$message.warning(t),[]}))),this.setState({isLoading:!0,uploading:!1}),Promise.all(r).then((function(e){a.setState({isLoading:!1});var t=e[0],r=t.filter((function(e){return 1===e.entryType})).groupBy((function(e){return j(e.start).format("YYYY-MM-DD")})).map((function(e){return a.getAllDayObj(e)}));a.latestData=t,function(e){var t=[],r=a.state.settings;switch(r.showMeetings&&t.push(2),r.showWorklogs&&t.push(1),r.showInfo&&t.push(3),t.length){case 0:e=[];break;case 3:break;default:e=e.filter((function(e){return t.indexOf(e.entryType)>-1}))}a.setColors(e),a.setEventsData(e)}(t.addRange(r).addRange(e[1]))}),(function(e){return a.setState({isLoading:!1}),Promise.reject(e)}))}},{key:"setLoggedTime",value:function(e,t){var a=this.getTimeSpent(e);t.logged=a;var r="Logged: ".concat(this.$utils.formatSecs(a));return t.diff=a-this.maxTime,this.maxTime&&t.diff&&(r+=" (".concat(t.diff>0?"+":"-").concat(this.$utils.formatSecs(Math.abs(t.diff)),")")),this.setInfoColor(t,this.state.settings),t.title=r,t}},{key:"setInfoColor",value:function(e,t){this.maxTime&&e.diff?e.backgroundColor=e.diff>0?t.infoColor_high:t.infoColor_less:e.backgroundColor=t.infoColor_valid,e.borderColor=e.backgroundColor}},{key:"getTimeSpent",value:function(e){return e.sum((function(e){var t=j(e.start),a=j(e.end);return j.duration(a.diff(t)).asSeconds()}))}},{key:"updateAllDayEvent",value:function(e){var t=j(e.start).format("YYYY-MM-DD"),a=this.events;a.removeAll((function(e){return e.id===t&&3===e.entryType}));var n=a.filter((function(e){return 1===e.entryType&&j(e.start).format("YYYY-MM-DD")===t}));if(n&&n.length>0){var o=this.getAllDayObj({key:t,values:n});o.logged&&(a.push(o),this.setLoggedTime(n,o))}this.setEventsData(a),this.performAction(r.a.WorklogModified)}},{key:"openTicket",value:function(e){var t=this.$userutils.getTicketUrl(e.ticketNo);window.open(t)}},{key:"showWorklogPopup",value:function(e){Object(x.hideContextMenu)();var t,a={showAddWorklogPopup:!0};if(e.copy)return a.worklogItem=e.copy,void this.setState(a);if(e.id||e.parentId)t=e;else{var r=j.duration(e.end.diff(e.start));t={timeSpent:"".concat(r.hours().pad(2),":").concat(r.minutes().pad(2)),allowOverride:!0},e.dateStarted?t.startTime=e.dateStarted:t.startTime=e.isMonthMode?j("".concat(e.start.format("YYYY-MM-DD")," ").concat(this.CurrentUser.startOfDay),"YYYY-MM-DD HH:mm").toDate():e.start.toDate()}a.worklogItem=t,this.setState(a)}},{key:"setEventsData",value:function(e){this.events=Object(n.a)(e),this.setState({isLoading:!1,events:Object(n.a)(e),pendingWorklogCount:this.getPendingWorklogs(e).length})}},{key:"getAllDayObj",value:function(e){return this.setLoggedTime(e.values,{id:e.key,entryType:3,start:e.key,allDay:!0,editable:!1})}},{key:"setColors",value:function(e){var t=this,a=this.state.settings,r=a.worklogColor,n=a.eventColor;e.forEach((function(e){switch(e.entryType){case 1:e.backgroundColor=r,e.borderColor=r;break;case 2:e.backgroundColor=n,e.borderColor=n;break;case 3:t.setInfoColor(e,a)}}))}},{key:"select",value:function(e){var t=e.start,a=e.end,r=e.allDay,n="dayGridMonth"===this.state.settings.viewMode&&!this.isGadget;return!n&&r||(this.$analytics.trackEvent("Worklog drag",$.i.UserActions),this.showWorklogPopup({isMonthMode:n,start:j(t),end:j(a)})),!1}},{key:"showCalendarDetails",value:function(e,t,a){Object(x.hideContextMenu)(),t.preventDefault(),t.stopPropagation();var r=e.extendedProps.sourceObject;if(this.$analytics.trackEvent("View event details",$.i.UserActions,e.extendedProps.source),"goolge"===e.extendedProps.source)this.currentMeetingItem=this.getGoogleEventView(r);else if("outlook"===e.extendedProps.source)return void(this.currentMeetingItem=this.getOutlookEventView(r));if(this.$session.isQuickView){var n=k()(".app-header.navbar > button[appmobilesidebartoggler]").get(0);n&&(t={currentTarget:n})}else this.currentMeetingViewItem&&(t={currentTarget:this.currentMeetingViewItem});this.opEvent.show(t),this.setState({showOpEvent:!0})}},{key:"getGoogleEventView",value:function(e){var t={summary:e.summary,htmlLink:e.htmlLink,location:e.location,description:e.description,descrLimit:350,creator:e.creator,organizer:e.organizer};if(e.start){t.date=this.$userutils.formatDate(e.start.dateTime),t.startTime=this.$userutils.formatTime(e.start.dateTime);var a=j(e.start.dateTime).diff(j());a=a<0?e.end&&e.end.dateTime&&j().diff(e.end.dateTime)<0?"(now ongoing)":"":"(in ".concat(this.$utils.formatTs(a),")"),t.remaining=a}if(e.end&&e.end.dateTime&&(t.endTime=this.$userutils.formatTime(e.end.dateTime)),e.attendees&&(t.attendees={total:e.attendees.length,yes:e.attendees.count((function(e){return"accepted"===e.responseStatus})),no:e.attendees.count((function(e){return"notAccepted"===e.responseStatus})),awaiting:e.attendees.count((function(e){return"needsAction"===e.responseStatus})),tentative:e.attendees.count((function(e){return"tentative"===e.responseStatus})),list:e.attendees}),e.hangoutLink){var r=e.hangoutLink;r.lastIndexOf("/")>0&&(r=r.substring(r.lastIndexOf("/")+1)),t.videoCall={url:e.hangoutLink,name:r}}return t}},{key:"getOutlookEventView",value:function(e){var t={summary:e.subject,htmlLink:e.webLink,location:(e.location||{}).displayName,description:e.bodyPreview,descrLimit:350,creator:e.creator,organizer:((e.organizer||{}).emailAddress||{}).name};if(e.start){t.date=this.$userutils.formatDate(e.start.dateTime),t.startTime=this.$userutils.formatTime(e.start.dateTime);var a=j(e.start.dateTime).diff(j());a=a<0?e.end&&e.end.dateTime&&j().diff(e.end.dateTime)<0?"(now ongoing)":"":"(in ".concat(this.$utils.formatTs(a),")"),t.remaining=a}if(e.end&&e.end.dateTime&&(t.endTime=this.$userutils.formatTime(e.end.dateTime)),e.attendees&&(t.attendees={total:e.attendees.length,yes:e.attendees.count((function(e){return"accepted"===(e.status||{}).response})),no:e.attendees.count((function(e){return"notAccepted"===(e.status||{}).response})),awaiting:e.attendees.count((function(e){return"needsAction"===(e.status||{}).response})),tentative:e.attendees.count((function(e){return"tentative"===(e.status||{}).response})),list:e.attendees.map((function(e){var t=e.emailAddress;return{email:t.address,displayName:t.name}}))}),e.onlineMeetingUrl){var r=e.onlineMeetingUrl;r.lastIndexOf("/")>0&&(r=r.substring(r.lastIndexOf("/")+1)),t.videoCall={url:e.onlineMeetingUrl,name:r}}return t}},{key:"openVideoCall",value:function(e){Object(x.hideContextMenu)(),e&&e.hangoutLink&&window.open(e.hangoutLink)}},{key:"eventClick",value:function(e){var t=e.event,a=e.jsEvent,r=e.view;return this.currentMeetingViewItem=null,1===t.extendedProps.entryType?this.showWorklogPopup(t.extendedProps.sourceObject):2===t.extendedProps.entryType&&this.showCalendarDetails(t,a,r),!1}},{key:"viewRender",value:function(e){var t=e.view;this.startDate=t.activeStart,this.endDate=t.activeEnd,this.title="Calendar - [".concat(t.title.replace(/[^a-zA-Z0-9, ]+/g,"-"),"]"),this.saveSettings(Object(l.a)(Object(l.a)({},this.state.settings),{},{viewMode:t.type}))}},{key:"eventDrop",value:function(e){var t=this,a=e.event,r=e.revert,n=e.jsEvent;if(n.ctrlKey||n.altKey){r();var o=this.events.first((function(e){return 1===e.entryType&&e.id===a.id}));if(o){var s=o.sourceObject;o.start=j(new Date(s.dateStarted)).toDate(),o.end=j(new Date(s.dateStarted)).add(this.$worklog.getTimeSpent(s),"minutes").toDate()}this.$worklog.copyWorklog(a.extendedProps.sourceObject,a.start).then((function(e){t.addEvent({added:e}),t.$analytics.trackEvent("Worklog quick copied",$.i.UserActions,a.extendedProps.sourceObject.isUploaded?"Uploaded worklog":"Pending worklog")}))}else{var i=a.extendedProps.sourceObject.dateStarted;this.$worklog.changeWorklogDate(a.extendedProps.sourceObject,a.start).then((function(e){t.$analytics.trackEvent("Worklog moved",$.i.UserActions,a.extendedProps.sourceObject.isUploaded?"Uploaded worklog":"Pending worklog"),t.addEvent({previousTime:i,edited:e})}))}}},{key:"eventResize",value:function(e){var t=this,a=e.event;this.$worklog.changeWorklogTS(a.extendedProps.sourceObject,this.getEventDuration(a)).then((function(e){t.addEvent({edited:e}),t.$analytics.trackEvent("Worklog resized",$.i.UserActions,a.extendedProps.sourceObject.isUploaded?"Uploaded worklog":"Pending worklog")}))}},{key:"getEventDuration",value:function(e){if(e.end&&e.start){var t=j.duration(j(e.end).diff(e.start));return"".concat(t.hours().pad(2),":").concat(t.minutes().pad(2))}if(e.extendedProps.sourceObject){var a=e.extendedProps.sourceObject,r=a.overrideTimeSpent||a.timespent;if(r&&~r.indexOf(":"))return r}return"00:00"}},{key:"eventRender",value:function(e){var t=this,a=e.event,r=e.el,n=k()(r),o=" (".concat(this.$utils.formatTs(this.getEventDuration(a)),")"),s=a.extendedProps.sourceObject;if(s){var i="".concat(n.find(".fc-time").text()+o,"\n").concat(a.title);n.attr("title",i)}n.find(".fc-time").append('<span class="fc-hour">'.concat(o,"</span>"));var l=a.extendedProps.entryType;if(1===l){var c=s,u=function(e){e.stopPropagation(),e.preventDefault(),t.mnuWL_Upload.disabled=c.isUploaded,t.currentWLItem=c,Object(x.showContextMenu)(e,t.contextMenuItems)},d=k()('<i class="fa fa-ellipsis-v pull-left" title="Show options"></i>').on("click",u);n.find(".fc-time").prepend(d),n.bind("contextmenu",u)}else if(2===l){var m=null,p=s,g=this.latestData.some((function(e){return e.parentId===a.id&&1===e.entryType})),f=function(e){e.stopPropagation(),e.preventDefault(),e.currentTarget=m.get(0),t.currentMeetingItem=p,t.currentMeetingViewItem=h.find("i.fa").get(0),t.mnuCal_AddWL.disabled=g,t.mnuCal_OpenUrl.disabled=!p.hangoutLink,Object(x.showContextMenu)(e,t.calMenuItems)};m=g?k()('<i class="fa fa-ellipsis-v pull-left" title="Show options"></i>').on("click",f):k()('<i class="fa fa-clock-o pull-left" title="Create worklog for this meeting"></i>').on("click",(function(e){e.stopPropagation(),t.createWorklog(e,p,t.defaultMeetingTicket)}));var h=n.find(".fc-time");h.prepend(m),n.bind("contextmenu",f)}}},{key:"uploadWorklog",value:function(e){var t=this;if(this.setState({uploading:!0}),Object(x.hideContextMenu)(),e){var a=this.getPendingWorklogs().map((function(e){return e.sourceObject.id}));this.$worklog.uploadWorklogs(a).then((function(){t.$message.success("".concat(a.length," worklog(s) uploaded successfully!")),t.$analytics.trackEvent("Worklog uploaded: All",$.i.UserActions),t.refreshData()}),(function(){t.refreshData()}))}else this.$worklog.uploadWorklogs([this.currentWLItem.id],!0).then((function(e){t.setState({uploading:!1}),t.$message.success("Worklog uploaded successfully!"),t.events.removeAll((function(e){return 1===e.entryType&&e.id.toString()===t.currentWLItem.id.toString()})),t.addEvent({added:t.$worklog.getWLCalendarEntry(e[0])}),t.$analytics.trackEvent("Worklog uploaded: Individual",$.i.UserActions)}),(function(){return t.setState({uploading:!1})}))}},{key:"deleteWorklog",value:function(){var e=this;Object(x.hideContextMenu)(),this.$worklog.deleteWorklog(this.currentWLItem).then((function(){e.$analytics.trackEvent("Worklog deleted",$.i.UserActions,e.currentWLItem.isUploaded?"Uploaded worklog":"Pending worklog"),e.addEvent({removed:e.currentWLItem.id,deletedObj:e.currentWLItem})}))}},{key:"copyWorklog",value:function(){Object(x.hideContextMenu)();var e=Object.create(this.currentWLItem);e.copy=!0,this.showWorklogPopup({copy:e})}},{key:"getPendingWorklogs",value:function(e){return e||(e=this.events),e.filter((function(e){return 1===e.entryType&&!e.sourceObject.isUploaded}))}},{key:"executeEvent",value:function(e){e.type===r.a.AddWorklog||e.type===r.a.DeletedWorklog||e.type===r.a.WorklogModified?this.refreshData():Object(g.a)(Object(f.a)(a.prototype),"executeEvent",this).call(this,e)}},{key:"renderCustomActions",value:function(){var e=this,t=this.isGadget,a=this.state,r=a.pendingWorklogCount,n=a.isLoading,o=a.uploading;return v.a.createElement(v.a.Fragment,null,!this.isGadget&&v.a.createElement(v.a.Fragment,null,v.a.createElement(T.a,{icon:"fa fa-arrow-left",onClick:function(){return e.calendar.prev()}}),v.a.createElement(T.a,{icon:"fa fa-arrow-right",onClick:function(){return e.calendar.next()}}),v.a.createElement(D.a,{dataset:P,value:this.state.settings.viewMode,valueField:"value",displayField:"label",placeholder:"Select a view mode",onChange:this.viewModeChanged})),v.a.createElement("span",{className:"info-badge",title:r?"Upload ".concat(r," pending worklog(s)"):"No worklog pending to be uploaded"},r>0&&v.a.createElement("span",{className:"info btn-warning"},r),v.a.createElement(T.a,{type:"success",icon:o?"fa fa-spin fa-spinner":"fa fa-upload",disabled:o||r<1||n,onClick:function(){return e.uploadWorklog(!0)}})),!t&&v.a.createElement(T.a,{icon:"fa fa-refresh",disabled:n||o,onClick:this.refreshData,title:"Refresh meetings and worklogs"}),!t&&v.a.createElement(T.a,{icon:"fa fa-cogs",onClick:this.toggleSettingsDialog,title:"Show settings"}))}},{key:"render",value:function(){var e=this,t=this.hideWorklogDialog,r=this.addEvent,n=this.state,o=n.showAddWorklogPopup,s=n.showSettingsPopup,i=n.worklogItem,l=n.events,c=n.showOpEvent;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement(v.a.Fragment,null,v.a.createElement(w.FullCalendar,{ref:function(t){t&&(e.fc=t,e.calendar=t.calendar)},events:l,options:this.fullCalendarOpts}),o&&v.a.createElement(W.a,{worklog:i,onDone:r,onHide:t}),s&&v.a.createElement(M,{settings:this.state.settings,onDone:this.saveSettings,onHide:this.toggleSettingsDialog}),v.a.createElement(U.OverlayPanel,{className:"op-event-details",ref:function(t){e.opEvent=t},showCloseIcon:!0,dismissable:!0,appendTo:document.body,onHide:this.hideOPEvent},c&&this.currentMeetingItem&&v.a.createElement(A,{eventDetails:this.currentMeetingItem,cut:this.$utils.cut}))))}}]),a}(b.b),B=a(264),q=a(253),H=(a(273),function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var r;Object(c.a)(this,a),r=t.call(this,e),Object(E.a)(Object(d.a)(r),"JiraService","SessionService");var n=r.$session.CurrentUser,o=n.epicNameField,s=n.storyPointField;r.epicNameField=null===o||void 0===o?void 0:o.id,r.storyPointField=null===s||void 0===s?void 0:s.id;var i=["key","summary","project","status","parent","assignee","issuetype","reporter","created","changeLog","timeestimate","aggregatetimeestimate","timeoriginalestimate","aggregatetimeoriginalestimate"];return r.epicNameField&&i.push(r.epicNameField),r.storyPointField&&i.push(r.storyPointField),r.fieldNames=i,r.state={},r}return Object(u.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){this.fetchData()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.jql;this.jql!==(null===t||void 0===t?void 0:t.trim())&&this.fetchData()}},{key:"fetchData",value:function(){var e=Object(i.a)(s.a.mark((function e(){var t,a,r,n,o,i,l,c,u=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props,a=t.jql,r=t.setLoader,this.jql=null===a||void 0===a?void 0:a.trim(),this.jql){e.next=5;break}return this.setState({reportData:[],statusList:[]}),e.abrupt("return");case 5:return r&&r(!0),e.next=8,this.$jira.searchTickets(a,this.fieldNames,0,{expand:["changelog"]});case 8:return n=e.sent,o=(new Date).getTime(),i=n.map((function(e){for(var t=e.key,a=e.changelog,r=(a=void 0===a?{}:a).histories,n=e.fields,s=n.summary,i=n.status,l=n.issuetype,c=n.assignee,d=n.reporter,m=n.created,p=n.project,g=n.parent,f=n.timeestimate,h=n.aggregatetimeestimate,v=n.timeoriginalestimate,y=n.aggregatetimeoriginalestimate,k=n[u.epicNameField],b=n[u.storyPointField],E=[],w=r.length,S=function(){var e=r[w],t=e.created;e.items.filter((function(e){return"status"===e.field})).forEach((function(e){var a=e.fromString,r=e.toString;E.push({date:O()(t).toDate().getTime(),from:a,to:r})}))};--w>=0;)S();var N=O()(m).toDate().getTime(),C=E.length-1,j=E.reduce((function(e,t,a){var r=t.date,n=t.from,s=t.to;return e[n]=(e[n]||0)+(r-N),N=r,C===a&&(e[s]=(e[s]||0)+(o-N)),e}),{});return Object.keys(j).forEach((function(e){j[e]||delete j[e]})),{key:t,summary:s,status:i,issuetype:l,assignee:c,reporter:d,created:m,project:p,parent:g,timeestimate:f,aggregatetimeestimate:h,timeoriginalestimate:v,aggregatetimeoriginalestimate:y,statusData:j,changelog:E,epic:k,storyPoint:b}})),l=i.distinct((function(e){return e.project.key})),e.next=14,this.getStatuses(l);case 14:c=e.sent,this.columnList=this.getFieldList(c),r&&r(!1),this.setState({reportData:i,statusList:c});case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getFieldList",value:function(e){var t=this.props.onAddWorklog;return[{field:"key",displayText:"Ticket No",type:"string",viewComponent:q.i,props:{onAddWorklog:t}},{field:"summary",displayText:"Summary",type:"string"},{field:"project",fieldKey:"project.key",displayText:"Project",type:"string",viewComponent:q.g},{field:"issuetype",fieldKey:"issuetype.name",displayText:"Issue Type",type:"string",viewComponent:q.e},{field:"epic",displayText:"Epic",type:"string",viewComponent:q.i,props:{hideWorklog:!0}},{field:"storyPoint",displayText:"Story Points",type:"number"},{field:"timeestimate",displayText:"Time Estimate",type:"number",viewComponent:q.j},{field:"aggregatetimeestimate",displayText:"\u03a3 Time Estimate",type:"number",viewComponent:q.j},{field:"timeoriginalestimate",displayText:"Original Estimate",type:"number",viewComponent:q.j},{field:"aggregatetimeoriginalestimate",displayText:"\u03a3 Original Estimate",type:"number",viewComponent:q.j},{field:"parent",fieldKey:"project.key",displayText:"Parent",type:"string",viewComponent:q.c,props:{onAddWorklog:t}},{field:"status",fieldKey:"status.name",displayText:"Status",type:"string",viewComponent:q.e},{field:"created",displayText:"Created",type:"datetime",viewComponent:q.b},{field:"assignee",fieldKey:"assignee.displayName",displayText:"Assignee",type:"string",viewComponent:q.m},{field:"reporter",fieldKey:"reporter.displayName",displayText:"Reporter",type:"string",viewComponent:q.m}].concat(Object(n.a)(e.map((function(e){return{field:"statusData.".concat(e.name),displayText:"Spent on ".concat(e.name),type:"number",viewComponent:q.j,props:{inputType:"ticks",days:!0}}}))))}},{key:"getStatuses",value:function(){var e=Object(i.a)(s.a.mark((function e(t){var a,r,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$jira.getProjectStatuses(t);case 2:return a=e.sent,r=[],n=[],a.forEach((function(e){e.forEach((function(e){e.statuses.forEach((function(e){if(!~r.indexOf(e.id)){var t=e.id,a=e.name,o=e.iconUrl;r.push(t),n.push({name:a,iconUrl:o})}}))}))})),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.columnList,t=this.state,a=t.loading,r=t.reportData,n=this.props,o=n.settings,s=n.settingsChanged,i=o||{},l=i.displayColumns,c=i.groupBy,u=i.groupFoldable,d=i.sortField,m=i.isDesc;return v.a.createElement("div",{className:"statuswise-ts-grid"},!a&&r&&v.a.createElement(B.a,{dataset:r,exportSheetName:"Status wise time spent",columns:e,allowSorting:!0,onChange:s,displayColumns:l,groupBy:c,groupFoldable:u,sortField:d,isDesc:m,noRowsMessage:"No ticket details available"}))}}]),a}(h.PureComponent)),Q=a(296),G=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var r;Object(c.a)(this,a),(r=t.call(this,e,"Gadget configurations")).onDone=function(){r.onHide(r.state.pageSettings)},r.onChange=function(e,t){var a=r.state.pageSettings;a=Object(l.a)(Object(l.a)({},a),{},{jql:e,jqlSettings:t}),r.setState({pageSettings:a})},r.className="no-padding";var n=e.pageSettings;return r.state={showDialog:!0,pageSettings:Object(l.a)({},n)},r}return Object(u.a)(a,[{key:"getFooter",value:function(){return v.a.createElement(I.b,{icon:"fa fa-floppy-o",label:"Done",onClick:this.onDone})}},{key:"render",value:function(){var e=this.state.pageSettings,t=e.jql,r=e.jqlSettings;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement("div",null,v.a.createElement(Q.a,{jql:t,settings:r,onChange:this.onChange})))}}]),a}(L.a),_=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e,"Status Wise Time Spent","fa-list-alt")).settingsChanged=function(e){r.pageSettingsChanged({gridSettings:e})},r.pageSettingsChanged=function(e){e&&(r.settings=Object(l.a)(Object(l.a)({},r.settings),e),r.saveSettings()),r.setState({showSettings:!1,settings:e})},r.showSettings=function(){r.setState({showSettings:!0})},r.setLoader=function(e){r.setState({isLoading:e})},r.refreshData=function(){var e=r.state.gridKey;e++,r.setState({gridKey:e})},Object(E.a)(Object(d.a)(r),"SessionService","AnalyticsService"),r.state.gridKey=0,r}return Object(u.a)(a,[{key:"renderCustomActions",value:function(){return v.a.createElement(I.b,{icon:"fa fa-cogs",onClick:this.showSettings,title:"Show settings"})}},{key:"render",value:function(){var e=this.state,t=e.showSettings,r=e.gridKey,n=this.settings||{},o=n.jql,s=n.gridSettings;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement("div",{className:"status-wise-ts-gadget"},!o&&v.a.createElement("div",{className:"no-jql"},"No JQL was set to fetch the data. Click on ",v.a.createElement("span",{className:"fa fa-cogs"})," icon from top right corner of the gadget and modify the JQL to fetch data from Jira."),o&&v.a.createElement(H,{key:r,setLoader:this.setLoader,jql:o,settings:s,settingsChanged:this.settingsChanged,onAddWorklog:this.addWorklogOn}),t&&v.a.createElement(G,{pageSettings:this.settings,onHide:this.pageSettingsChanged})))}}]),a}(b.b),V=a(33),Y=a(35),J=a(245),K=a(282),z=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e,"Daywise worklog","fa-list-alt")).refreshData=function(){var e=r.settings.dateRange;if(e){var t=Object(K.b)(e.quickDate)||[],a=Object(V.a)(t,2),n=a[0],o=a[1];n&&(e.fromDate=n,e.toDate=o),e.fromDate&&(r.setState({isLoading:!0}),e.dateWise=!0,r.$worklog.getWorklogs(e).then((function(e){e.forEach((function(e){return e.rowClass=r.$utils.getRowStatus(e)})),r.setState({worklogs:e,isLoading:!1})})))}},Object(Y.b)(Object(d.a)(r),"WorklogService","UtilsService","UserUtilsService"),r.contextMenu=[{label:"Upload worklog",icon:"fa fa-clock-o",command:function(){return r.uploadWorklog()}},{label:"Add worklog",icon:"fa fa-bookmark",command:function(){return r.addWorklog()}}],r}return Object(u.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){this.refreshData()}},{key:"getWorklogUrl",value:function(e,t){return this.$userutils.getWorklogUrl(e,t)}},{key:"showContext",value:function(e,t){this.selectedDay=t,Object(x.showContextMenu)(e,this.contextMenu)}},{key:"dateSelected",value:function(e){this.settings.dateRange=e,e.toDate&&(this.refreshData(),e.auto||this.saveSettings())}},{key:"uploadWorklog",value:function(){var e=this,t=this.selectedDay.ticketList.filter((function(e){return!e.worklogId})).map((function(e){return e.id}));0!==t.length&&(this.setState({isLoading:!0}),this.$worklog.uploadWorklogs(t).then((function(){e.refreshData(),Object(g.a)(Object(f.a)(a.prototype),"performAction",e).call(e,b.a.WorklogModified)}),(function(t){e.setState({isLoading:!1})})))}},{key:"addWorklog",value:function(){var e=O()(this.selectedDay.dateLogged).toDate(),t=null;this.selectedDay.pendingUpload>0&&(t=this.$utils.formatTs(this.selectedDay.pendingUpload,!0)),Object(g.a)(Object(f.a)(a.prototype),"addWorklog",this).call(this,{startTime:e,timeSpent:t,allowOverride:!!t})}},{key:"executeEvent",value:function(e){e.type===b.a.AddWorklog||e.type===b.a.DeletedWorklog||e.type===b.a.WorklogModified?this.refreshData():Object(g.a)(Object(f.a)(a.prototype),"executeEvent",this).call(this,e)}},{key:"renderCustomActions",value:function(){var e=this;return v.a.createElement(I.e,{range:!0,value:this.settings.dateRange,onChange:function(t){return e.dateSelected(t)},style:{marginRight:"35px"}})}},{key:"render",value:function(){var e=this,t=this.state.worklogs;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement(J.c,{dataset:t,exportSheetName:"Datewise worklog"},v.a.createElement(J.e,null,v.a.createElement("tr",null,v.a.createElement(J.a,{sortBy:"dateLogged",style:{width:"100px"}},"Logged Date"),v.a.createElement(J.a,{sortBy:"totalHours"},"Total Hours"),v.a.createElement(J.a,{sortBy:"uploaded"},"Uploaded"),v.a.createElement(J.a,{sortBy:"pendingUpload"},"Pending Upload"),v.a.createElement(J.a,null,"Ticket List"))),v.a.createElement(J.d,null,(function(t){return v.a.createElement("tr",{key:t.dateLogged,onContextMenu:function(a){return e.showContext(a,t)},className:t.rowClass},v.a.createElement("td",null,e.$userutils.formatDate(t.dateLogged)),v.a.createElement("td",null,e.$utils.formatTs(t.totalHours)),v.a.createElement("td",null,e.$utils.formatTs(t.uploaded)),v.a.createElement("td",null,e.$utils.formatTs(t.pendingUpload)),v.a.createElement("td",null,v.a.createElement("ul",{className:"tags"},t.ticketList.map((function(t,a){return v.a.createElement("li",{key:a},t.worklogId&&v.a.createElement("a",{className:"link badge badge-pill skin-bg-font",href:e.getWorklogUrl(t.ticketNo,t.worklogId),target:"_blank",rel:"noopener noreferrer",title:t.comment},v.a.createElement("span",{className:"fa fa-clock-o"})," ",t.ticketNo,": ",t.uploaded),!t.worklogId&&v.a.createElement("span",{className:"link badge badge-pill skin-bg-font",onClick:function(){return e.editWorklog(t.id)},title:t.comment},v.a.createElement("span",{className:"fa fa-clock-o"})," ",t.ticketNo,": ",t.uploaded))})))))})),v.a.createElement(J.b,{span:5},"No worklog exists for selected date range!")))}}]),a}(b.b),Z=a(274),X=a(112),ee=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var r;Object(c.a)(this,a),(r=t.call(this,e,"Report configurations")).onDone=function(){r.$config.saveSettings("reports_UserDayWise",r.state.pageSettings),r.onHide(r.state.pageSettings)},r.setValue=function(e,t){var a=r.state.pageSettings;a[e]=t,a=Object(l.a)({},a),r.setState({pageSettings:a})},Object(Y.b)(Object(d.a)(r),"ConfigService"),r.className="no-padding";var n=e.pageSettings;return r.state={showDialog:!0,pageSettings:Object(l.a)({},n)},r.hideEstimate=n.hideEstimate,r}return Object(u.a)(a,[{key:"getFooter",value:function(){return v.a.createElement(I.b,{icon:"fa fa-floppy-o",label:"Done",onClick:this.onDone})}},{key:"render",value:function(){var e=this.setValue,t=this.state.pageSettings,r=t.logFormat,n=t.breakupMode,o=t.timeZone,s=t.jql,i=t.hideEstimate;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement(X.TabView,{styleclass:"query-tab"},v.a.createElement(X.TabPanel,{header:"General",leftIcon:"fa fa-cog",contentClassName:"pad-22"},v.a.createElement("div",{className:"form-group row"},v.a.createElement("label",{className:"col-md-3 col-form-label"},"Log hour format"),v.a.createElement("div",{className:"col-md-9 col-form-label"},v.a.createElement("div",{className:"form-check"},v.a.createElement("label",{className:"form-check-label"},v.a.createElement("input",{className:"form-check-input",value:r,onChange:function(){return e("logFormat","1")},type:"radio",checked:"1"===r,name:"hourformat"}),"Format hours (2h 30m)")),v.a.createElement("div",{className:"form-check"},v.a.createElement("label",{className:"form-check-label"},v.a.createElement("input",{className:"form-check-input",value:r,onChange:function(){return e("logFormat","2")},type:"radio",checked:"2"===r,name:"hourformat"}),"Show in hours (2.5)")))),v.a.createElement("div",{className:"form-group row"},v.a.createElement("label",{className:"col-md-3 col-form-label"},"Log breakup"),v.a.createElement("div",{className:"col-md-9 col-form-label"},v.a.createElement("div",{className:"form-check"},v.a.createElement("label",{className:"form-check-label"},v.a.createElement("input",{className:"form-check-input",value:n,onChange:function(){return e("breakupMode","1")},type:"radio",checked:"1"===n,name:"logbreakup"}),"Single entry (Sum worklog added for same ticket on same day)")),v.a.createElement("div",{className:"form-check"},v.a.createElement("label",{className:"form-check-label"},v.a.createElement("input",{className:"form-check-input",value:n,onChange:function(){return e("breakupMode","2")},type:"radio",checked:"2"===n,name:"logbreakup"}),"Individual entry (Display individual entry for each of the worklog)")))),v.a.createElement("div",{className:"form-group row"},v.a.createElement("label",{className:"col-md-3 col-form-label"},"Report timezone (experimental)"),v.a.createElement("div",{className:"col-md-9 col-form-label"},v.a.createElement("div",{className:"form-check"},v.a.createElement("label",{className:"form-check-label"},v.a.createElement("input",{className:"form-check-input",value:o,onChange:function(){return e("timeZone","1")},type:"radio",checked:"1"===o,name:"timezone"}),"Use my local time zone for all users")),v.a.createElement("div",{className:"form-check"},v.a.createElement("label",{className:"form-check-label"},v.a.createElement("input",{className:"form-check-input",value:o,onChange:function(){return e("timeZone","2")},type:"radio",checked:"2"===o,name:"timezone"}),"Use containing groups timezone for all users")),v.a.createElement("div",{className:"form-check"},v.a.createElement("label",{className:"form-check-label"},v.a.createElement("input",{className:"form-check-input",value:o,onChange:function(){return e("timeZone","3")},type:"radio",checked:"3"===o,name:"timezone"}),"Use individual users timezone")))),v.a.createElement("div",{className:"form-group row"},v.a.createElement("div",{className:"form-check"},v.a.createElement("label",{className:"form-check-label"},v.a.createElement(I.c,{checked:i,onChange:function(t){return e("hideEstimate",t)},label:"Hide estimate related fields"}),this.hideEstimate&&!i&&v.a.createElement("span",{className:"pad-left-15"}," ( ",v.a.createElement("i",{className:"fa fa-exclamation-triangle"})," Change will take effect only after report is refreshed )"))))),v.a.createElement(X.TabPanel,{header:"JQL Filter",leftIcon:"fa fa-filter"},v.a.createElement(I.j,{multiline:!0,value:s,onChange:function(t){return e("jql",t)},style:{width:"100%",height:323},placeholder:"Provide the additional JQL filters to be applied while fetching data.",defaultValue:""}),v.a.createElement("span",null,v.a.createElement("strong",null,"Note:")," Date range and user list filter will be added automatically."))))}}]),a}(L.a),te=["-originalestimate","-totalLogged","-remainingestimate","-estVariance"],ae=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e)).settingsChanged=function(e,t){r.props.onChange(e,t)},r.setPropsInClass(e),r.state=r.getNewState(e),r.state.groupBy=[],r}return Object(u.a)(a,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.updateData(e)}},{key:"updateData",value:function(e){this.data===e.flatData&&this.pageSettings===e.pageSettings||(this.setPropsInClass(e),this.setState(this.getNewState(e)))}},{key:"getNewState",value:function(e){return{columns:this.getColumnSettings(e)}}},{key:"setPropsInClass",value:function(e){this.data=e.flatData,this.pageSettings=this.props.pageSettings}},{key:"getColumnSettings",value:function(e){var t=this,a=e.formatDateTime,r=e.convertSecs;return[{field:"groupName",displayText:"Group Name",type:"string"},{field:"projectName",displayText:"Project Name",type:"string"},{field:"issueType",displayText:"Issue Type",type:"string"},{field:"epicDisplay",displayText:"Epic",type:"string",format:function(e,a){return t.formatTicket(e,a.epicUrl)}},{field:"parent",displayText:"Parent",type:"string",format:function(e,a){return t.formatTicket(e,a.parentUrl)}},{field:"ticketNo",displayText:"Ticket No",type:"string",format:function(e,a){return t.formatTicket(e,a.ticketUrl)}},{field:"statusName",displayText:"Status",type:"string"},{field:"summary",displayText:"Summary",type:"string"},{field:"logTime",displayText:"Log Date & Time",type:"datetime",format:a},{field:"userDisplay",displayText:"Assignee",type:"string"},{field:"timeSpent",displayText:"Hr. Spent",type:"number",format:r},{field:"originalestimate",displayText:"Ori. Estm.",type:"number",format:r},{field:"totalLogged",displayText:"Total Worklogs",type:"number",format:r},{field:"remainingestimate",displayText:"Rem. Estm.",type:"number",format:r},{field:"estVariance",displayText:"Estm. Variance",type:"number",format:function(e){return(e>0?"+":"")+r(e)}},{field:"comment",displayText:"Comment"}]}},{key:"formatTicket",value:function(e,t){return e&&v.a.createElement("a",{href:t,className:"link",target:"_blank",rel:"noopener noreferrer"},e)}},{key:"render",value:function(){var e=this.props,t=e.flatData,a=e.pageSettings,r=(a=void 0===a?{}:a).hideEstimate,n=a.flatTableSettings,o=(n=void 0===n?{displayColumns:r?te:null}:n).groupBy,s=n.groupFoldable,i=n.displayColumns,l=n.sortField,c=n.isDesc,u=this.state.columns;return v.a.createElement(B.a,{className:"flat-data-grid",dataset:t,exportSheetName:"Flat Worklogs",columns:u,allowSorting:!0,onChange:this.settingsChanged,displayColumns:i,groupBy:o,groupFoldable:s,sortField:l,isDesc:c,noRowsMessage:"No worklog details available"})}}]),a}(h.PureComponent),re=a(12),ne=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e)).state={groupedData:r.generateGroupData(e)},r}return Object(u.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){this.setState({groupedData:this.generateGroupData(this.props)})}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState({groupedData:this.generateGroupData(e)})}},{key:"getCssClass",value:function(e,t){if(t=t>0?t:0,e.isHoliday)return t?"log-high":"col-holiday";var a=this.props.maxSecsPerDay;return t===a?"log-good":t<a?"log-less":t>a?"log-high":void 0}},{key:"generateGroupData",value:function(e){var t=this,a=e.rawData,r=e.dates,n=e.pageSettings,o=e.groups,s=e.getTicketUrl,i=parseInt(n.timeZone),l=o.map((function(e){var n={name:e.name,total:{},grandTotal:0,users:null};n.users=e.users.map((function(n){var o=null;2===i?o=e.timeZone:3===i&&(o=n.timeZone||e.timeZone),o&&"object"===Object(re.a)(o)&&(o="string"===typeof o.value?o.value:""),"GRP_TZ"===o&&(o=e.timeZone),o&&"object"===Object(re.a)(o)&&(o="string"===typeof o.value?o.value:"");var l={name:Object(F.e)(n),displayName:n.displayName,emailAddress:n.emailAddress,timeZone:o,imageUrl:n.avatarUrls["48x48"]||n.avatarUrls["32x32"],profileUrl:n.self,tickets:null,total:{},logClass:{},grandTotal:0},c=a.first((function(e){return e.userName===Object(F.e)(n,!0)}))||{};c.isCurrentUser&&(l.isCurrentUser=!0);var u=c.logData||[];l.tickets=u.groupBy((function(e){return e.ticketNo})).map((function(e){var t=e.values,a=t.first(),r={},n={ticketNo:e.key,parent:a.parent,parentUrl:a.parent?s(a.parent):null,epicDisplay:a.epicDisplay,epicUrl:a.epicUrl,issueType:a.issueType,statusName:a.statusName,summary:a.summary,originalestimate:a.originalestimate,remainingestimate:a.remainingestimate,totalLogged:a.totalLogged,estVariance:a.estVariance,url:a.url,logs:r,totalHours:0},i=0;return t.forEach((function(e){var t=e.logTime;o&&(t=O()(O()(t).tz(o).format("YYYY-MM-DD HH:mm:ss")).toDate());var a=t.format("yyyyMMdd"),n=r[a];n||(n=[],r[a]=n),n.push({logTime:t,totalHours:e.totalHours,comment:e.comment}),i+=e.totalHours})),n.totalHours=i,n}));var d=l.logClass,m=l.total,p=0;return r.forEach((function(e){var a=l.tickets.sum((function(t){var a=t.logs[e.prop];return a?a.sum((function(e){return e.totalHours})):0}));a>0&&(m[e.prop]=a,p+=a),d[e.prop]=t.getCssClass(e,a)})),l.grandTotal=p,l}));var o=n.total,l=0;return r.forEach((function(e){var t=n.users.sum((function(t){return t.total[e.prop]||0}));t>0&&(o[e.prop]=t,l+=t)})),n.grandTotal=l,n})),c=0,u={};return r.forEach((function(e){var t=l.sum((function(t){return t.total[e.prop]||0}));t>0&&(u[e.prop]=t,c+=t)})),l.grandTotal=c,l.total=u,l}},{key:"render",value:function(){var e=this.state.groupedData,t=this.props,a=t.months,r=t.dates,n=t.convertSecs,o=t.formatTime,s=t.breakupMode,i=t.pageSettings,l=t.addWorklog,c="2"===(null===i||void 0===i?void 0:i.logFormat)?"float":void 0;return v.a.createElement(J.c,{exportSheetName:"Grouped - [User daywise]"},v.a.createElement(J.e,null,v.a.createElement("tr",{className:"data-center pad-min auto-wrap"},v.a.createElement("th",{style:{minWidth:380},rowSpan:2},"User Details"),a.map((function(e,t){return v.a.createElement("th",{key:t,style:{minWidth:35},colSpan:e.days},e.monthName)})),v.a.createElement("th",{style:{minWidth:50},rowSpan:2},"Total Hours")),v.a.createElement("tr",{className:"pad-min auto-wrap"},r.map((function(e,t){return v.a.createElement("th",{key:t,style:{minWidth:35}},e.display)})))),v.a.createElement(J.d,null,e.map((function(e,t){return v.a.createElement(oe,{key:t,group:e,dates:r,addWorklog:l,convertSecs:n,timeExportFormat:c,formatTime:o,breakupMode:s,pageSettings:i})})),v.a.createElement("tr",{className:"grouped-row right auto-wrap"},v.a.createElement("td",null,"Grand Total ",v.a.createElement("i",{className:"fa fa-arrow-right"})),r.map((function(t,a){return v.a.createElement("td",{key:a,exportType:c},n(e.total[t.prop]))})),v.a.createElement("td",{exportType:c},n(e.grandTotal)))))}}]),a}(h.PureComponent),oe=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={},e.toggleDisplay=function(){return e.setState({hidden:!e.state.hidden})},e}return Object(u.a)(a,[{key:"render",value:function(){var e=this.props,t=e.group,a=e.dates,r=e.convertSecs,n=e.formatTime,o=e.breakupMode,s=e.pageSettings,i=e.addWorklog,l=e.timeExportFormat,c=this.state.hidden;return v.a.createElement(v.a.Fragment,null,!c&&v.a.createElement("tr",{className:"grouped-row left",title:"Click to hide user details"},v.a.createElement("td",{colSpan:a.length+2,onClick:this.toggleDisplay},v.a.createElement("i",{className:"pull-left drill-down fa fa-chevron-circle-down"}),t.name)),!c&&t.users.map((function(e,t){return v.a.createElement(se,{key:t,user:e,dates:a,breakupMode:o,addWorklog:i,timeExportFormat:l,convertSecs:r,formatTime:n,pageSettings:s})})),v.a.createElement("tr",{className:"grouped-row right auto-wrap",onClick:c?this.toggleDisplay:null},v.a.createElement("td",null,c&&v.a.createElement("div",null,v.a.createElement("i",{className:"pull-left drill-down fa fa-chevron-circle-right",title:"Click to show user details"}),v.a.createElement("span",{className:"pull-left"},t.name),v.a.createElement("span",{className:"pull-right"},"Total ",v.a.createElement("i",{className:"fa fa-arrow-right"}))),!c&&v.a.createElement("div",null,t.name," ",v.a.createElement("i",{className:"fa fa-arrow-right"})," Total ",v.a.createElement("i",{className:"fa fa-arrow-right"}))),a.map((function(e,a){return v.a.createElement("td",{key:a,exportType:l},r(t.total[e.prop]))})),v.a.createElement("td",{exportType:l},r(t.grandTotal))))}}]),a}(h.PureComponent),se=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).state={},e.getComments=function(t){return t&&0!==t.length?t.map((function(t){return"".concat(e.props.formatTime(t.logTime),"(").concat(e.props.convertSecs(t.totalHours),") - ").concat(t.comment)})).join(";\n"):""},e.toggleDisplay=function(){return e.setState({expanded:!e.state.expanded})},e.addWorklog=function(t,a){var r=e.props,n=r.user,o=r.addWorklog,s=a.date,i=a.prop;o(n,t,s,n.total[i])},e}return Object(u.a)(a,[{key:"getTotalTime",value:function(e){return e&&0!==e.length?e.sum((function(e){return e.totalHours})):""}},{key:"getLogEntries",value:function(e){var t=this;if(Array.isArray(e)&&e.length>0){var a=e.length>1?";":"";return e.map((function(e,r){return v.a.createElement("span",{key:r,title:"".concat(t.props.formatTime(e.logTime)," - ").concat(e.comment)},t.props.convertSecs(e.totalHours)+a)}))}}},{key:"render",value:function(){var e=this,t=this.props,a=t.user,r=t.dates,n=t.convertSecs,o=t.breakupMode,s=t.pageSettings.hideEstimate,i=t.timeExportFormat,l=this.state.expanded;return v.a.createElement(v.a.Fragment,null,v.a.createElement("tr",{className:"pointer auto-wrap",onClick:this.toggleDisplay},v.a.createElement("td",{className:"data-left"},v.a.createElement("div",{className:"user-info",style:{paddingLeft:0}},v.a.createElement("i",{className:"pull-left drill-down fa ".concat(l?"fa-chevron-circle-down":"fa-chevron-circle-right"),title:"Click to toggle ticket details"}),v.a.createElement("img",{src:a.imageUrl,height:40,width:40,className:"pull-left",alt:a.displayName}),v.a.createElement("span",{className:"name"},a.displayName),v.a.createElement("span",{className:"email"},"(",a.emailAddress||a.name,a.timeZone&&v.a.createElement("span",null,", time zone: ",a.timeZone),")"))),r.map((function(t,r){return v.a.createElement("td",{key:r,className:"".concat(a.logClass[t.prop]," day-wl-block"),exportType:i},a.isCurrentUser&&v.a.createElement("span",{className:"fa fa-clock-o add-wl",title:"Click to add worklog",onClick:function(){return e.addWorklog(null,t)}}),n(a.total[t.prop]))})),v.a.createElement("td",{exportType:i},n(a.grandTotal))),l&&a.tickets.map((function(t,l){var c=n(t.originalestimate),u=n(t.remainingestimate),d=n(t.totalLogged)||0,m=(t.estVariance>0?"+":"")+(n(t.estVariance)||(t.originalestimate>0?0:"NA")),p="Original Estimate: ".concat(c||0,"\nRemaining: ").concat(u||0,"\nTotal Logged: ").concat(d,"\nEstimate Variance: ").concat(m);return v.a.createElement("tr",{key:l,className:"auto-wrap"},v.a.createElement("td",{className:"data-left"},t.parent&&v.a.createElement("a",{href:t.parentUrl,className:"link",target:"_blank",rel:"noopener noreferrer"},t.parent," - "),v.a.createElement("a",{href:t.url,className:"link",target:"_blank",rel:"noopener noreferrer"},t.ticketNo)," -",v.a.createElement("span",null,t.summary),v.a.createElement("strong",null," (",t.statusName,")"),!s&&!(!c&&!u)&&v.a.createElement("span",{className:"estimate",title:p},"(est: ",c||0," / rem: ",u||0," / log: ",d," / var: ",m,")")),r.map((function(r,s){return v.a.createElement("td",{key:s,className:"day-wl-block",exportType:i},a.isCurrentUser&&v.a.createElement("span",{className:"fa fa-clock-o add-wl",title:"Click to add worklog",onClick:function(){return e.addWorklog(t.ticketNo,r)}}),"2"!==o&&v.a.createElement("span",{title:e.getComments(t.logs[r.prop])},n(e.getTotalTime(t.logs[r.prop]))),"2"===o&&v.a.createElement("div",null," ",e.getLogEntries(t.logs[r.prop])))})),v.a.createElement("td",{exportType:i},n(t.totalHours)))})))}}]),a}(h.PureComponent),ie=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(u.a)(a,[{key:"render",value:function(){return v.a.createElement("div",{className:"pad-15"},v.a.createElement("strong",null,"How to use:"),v.a.createElement("ul",null,v.a.createElement("li",null,"Choose a date for which you would like to view the report or click the refresh ( ",v.a.createElement("i",{className:"fa fa-refresh"})," ) icon to load the report if date is already selected."),v.a.createElement("li",null,"You can choose the list of users by clicking the ( ",v.a.createElement("i",{className:"fa fa-users"})," ) icon."),v.a.createElement("li",null,"Click on Settings ",v.a.createElement("i",{className:"fa fa-arrow-right"})," User groups from left hand menu to add users permenantly to a group and use it in future."),v.a.createElement("li",null,"Click on ( ",v.a.createElement("i",{className:"fa fa-cogs"})," ) icon to change the settings of the report."),v.a.createElement("li",null,"Time zone settings - Configure the time zone of each user & group properly while adding in group and select appropriate option in settings as well."),v.a.createElement("li",null,"You have additional settings affecting this report in Settings ",v.a.createElement("i",{className:"fa fa-arrow-right"}),"General menu in left hand side.")),v.a.createElement("p",null,v.a.createElement("strong",null,"Note:")," Any changes you make to the group or the users under the group in this page will not get saved and is only for this session."),v.a.createElement("div",null,v.a.createElement("strong",null,"Planned enhancements:")," Some of the enhancements in roadmap for this reports are as follows",v.a.createElement("ul",null,v.a.createElement("li",null,"Viewing report based on sprint as an additional option alternate for date selection"),v.a.createElement("li",null,"Add custom columns to the report"))))}}]),a}(h.PureComponent),le=(a(275),function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var r;Object(c.a)(this,a),r=t.call(this,e);var n=e.groups,o=e.flatData;return r.state=r.getGroupedData(n,o),r}return Object(u.a)(a,[{key:"getGroupedData",value:function(e,t){var a=[],r={},n=t.groupBy((function(e){return e.username})).reduce((function(e,t){return e[t.key]=t.values,e}),{});t.groupBy((function(e){return{key:e.projectKey,name:e.projectName}})).sortBy((function(e){return e.key.key})).forEach((function(e){var t=e.key,n=e.values;a.push(t),r[t.key]=n,t.issueTypes=n.distinct((function(e){return e.issueType}))}));var o=e.map((function(e){var t=e.name,o=e.users,s={grandTotal:0,projects:{}},i={name:t,overallTotal:s};return i.users=o.map((function(e){var t=Object(F.e)(e),o=e.emailAddress,i=e.displayName,l={name:t,emailAddress:o,displayName:i};l.projects=a.reduce((function(e,a){var n=s.projects[a.key]||{total:0};s.projects[a.key]=n;var o=r[a.key];if(o){var i=o.filter((function(e){return e.username===t}));if(i.length){var l=i.groupBy((function(e){return e.issueType})).reduce((function(e,t){var a=t.values.sum((function(e){return e.timeSpent}))||0;return e[t.key]={total:a,logs:t.values},n[t.key]=(n[t.key]||0)+a,e}),{});l.grandTotal={total:i.sum((function(e){return e.timeSpent})),logs:i},n.total+=l.grandTotal.total||0,e[a.key]=l}}return e}),{});var c=n[t]||[];return l.grandTotal={total:c.sum((function(e){return e.timeSpent})),logs:c},s.grandTotal+=l.grandTotal.total,l})),i})),s=o.reduce((function(e,t){var r=t.overallTotal,n=r.grandTotal,o=r.projects;return e.grandTotal=(e.grandTotal||0)+n,a.forEach((function(t){var a=o[t.key]||{},r=e[t.key]||{total:0};e[t.key]=r,r.total+=a.total||0,t.issueTypes.forEach((function(e){var t=a[e]||0;r[e]=(r[e]||0)+t}))})),e}),{grandTotal:0});return{projects:a,projectsData:r,groupedData:o,grandTotal:s}}},{key:"render",value:function(){var e=this.props.convertSecs,t=this.state,a=t.projects,r=t.groupedData,n=t.grandTotal;return v.a.createElement(J.c,{dataset:r,exportSheetName:"Summary - [User project wise]"},v.a.createElement(J.e,null,v.a.createElement(J.f,null,v.a.createElement(J.a,{rowSpan:2},"Group Name"),v.a.createElement(J.a,{rowSpan:2},"User Name"),a.map((function(e){return v.a.createElement(J.a,{key:e.key,colSpan:e.issueTypes.length+1},e.name)})),v.a.createElement(J.a,{rowSpan:2},"Grand Total")),v.a.createElement(J.f,null,a.map((function(e,t){return v.a.createElement(h.Fragment,{key:t},e.issueTypes.map((function(e,t){return v.a.createElement(J.a,{key:t},e)})),v.a.createElement(J.a,null,"Total"))})))),v.a.createElement(J.d,null,(function(t,r){return v.a.createElement(h.Fragment,{key:r},t.users.map((function(r,n){return v.a.createElement("tr",{key:n},0===n&&v.a.createElement("td",{rowSpan:t.users.length+1},t.name),v.a.createElement("td",null,r.displayName),a.map((function(t,a){var n=r.projects[t.key]||{};return v.a.createElement(h.Fragment,{key:a},t.issueTypes.map((function(t,a){var r=n[t];return v.a.createElement("td",{key:a,className:"data-center",exportType:"float"},r?e(r.total):null)})),v.a.createElement("td",{className:"strong data-center",exportType:"float"},n.grandTotal?e(n.grandTotal.total):null))})),v.a.createElement("td",{className:"strong data-center",exportType:"float"},e(r.grandTotal.total)))})),v.a.createElement("tr",{className:"strong data-center"},v.a.createElement("td",{className:"data-right"},"Group Total ",v.a.createElement("span",{className:"fa fa-arrow-right"})),a.map((function(a,r){var n=t.overallTotal.projects[a.key]||{};return v.a.createElement(h.Fragment,{key:r},a.issueTypes.map((function(t,a){return v.a.createElement("td",{key:a,exportType:"float"},e(n[t]))})),v.a.createElement("td",{exportType:"float"},e(n.total)))})),v.a.createElement("td",{exportType:"float"},e(t.overallTotal.grandTotal))))})),v.a.createElement("tfoot",null,v.a.createElement("tr",{className:"strong data-center"},v.a.createElement("td",{colSpan:2,className:"data-right"},"Grand total ",v.a.createElement("span",{className:"fa fa-arrow-right"})),a.map((function(t,a){return v.a.createElement(h.Fragment,{key:a},t.issueTypes.map((function(a,r){return v.a.createElement("td",{key:r,exportType:"float"},e(n[t.key][a]))})),v.a.createElement("td",{exportType:"float"},e(n[t.key].total)))})),v.a.createElement("td",{exportType:"float"},e(n.grandTotal)))),v.a.createElement(J.b,{span:11},"No worklog details available"))}}]),a}(h.PureComponent)),ce=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var r;Object(c.a)(this,a),(r=t.call(this,e,"Worklog Report","fa-list-alt")).dateSelected=function(e){e&&e.fromDate&&e.toDate&&r.setState({dateRange:e},r.refreshData)},r.refreshData=function(){var e=r.state.groups;if(e&&0!==e.length){r.userList=e.union((function(e){return e.users.forEach((function(t){return t.groupName=e.name})),e.users}));var t={userList:r.userList.map((function(e){return Object(F.e)(e,!0)})),fromDate:r.state.dateRange.fromDate,toDate:r.state.dateRange.toDate};r.setState({isLoading:!0}),r.getDayWiseReportData(t).then((function(e){r.$analytics.trackEvent("Worklog report viewed",$.i.UserActions),r.rawData=e,r.generateFlatData(e),r.setState({isLoading:!1}),r.onResize({target:window})}))}else r.$message.warning("User list need to be added before generating report","Missing input")},r.showGroupsPopup=function(){return r.setState({showGroupsPopup:!0})},r.showSettings=function(){return r.setState({showSettings:!0})},r.groupsChanged=function(e){var t={showGroupsPopup:!1};e&&Array.isArray(e)&&(t.groups=e),r.setState(t)},r.settingsChanged=function(e){e||(e=r.state.pageSettings),r.setState({showSettings:!1,pageSettings:e})},r.groupSettingsChanged=function(e){var t=e.groupBy,a=e.groupFoldable,n=e.displayColumns,o=e.sortField,s=e.isDesc,i=r.state.pageSettings;i=Object(l.a)(Object(l.a)({},i),{},{flatTableSettings:{groupBy:t,groupFoldable:a,displayColumns:n,sortField:o,isDesc:s}}),r.$config.saveSettings("reports_UserDayWise",i),r.settingsChanged(i)},r.addWorklog=function(e,t,a,n){var o=(r.maxSecsPerDay||0)-(n||0);o<60&&(o="01:00"),r.worklogItem={ticketNo:t,dateStarted:a,timeSpent:o},r.setState({showWorklogPopup:!0})},r.worklogAdded=function(e){var t=e.added.sourceObject;console.log("Worklog added: ",t)},r.hideWorklog=function(){r.worklogItem=null,r.setState({showWorklogPopup:!1})},r.convertSecs=function(e){return r.$utils.convertSecs(e,{format:"1"===r.state.pageSettings.logFormat})},r.formatTime=function(e){return r.$userutils.formatTime(e)},r.formatDateTime=function(e){return r.$userutils.formatDateTime(e)},Object(Y.b)(Object(d.a)(r),"SessionService","CacheService","UtilsService","UserUtilsService","JiraService","MessageService","ConfigService","UserGroupService","AnalyticsService");var n=r.$session.pageSettings.reports_UserDayWise;n.timeZone||(n.timeZone="1"),r.state.dateRange={},r.state.pageSettings=n;var o=r.$session.CurrentUser,s=o.maxHours,i=o.epicNameField,u=o.name;return r.currentUserName=u.toLowerCase(),r.maxSecsPerDay=60*(s||8)*60,r.epicNameField=(i||{}).id,r}return Object(u.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){var e=this;this.$usergroup.getUserGroups().then((function(t){return e.setState({groups:t})}))}},{key:"getDayWiseReportData",value:function(e){var t=this,a=e.userList.distinct(),r=O()(e.fromDate).startOf("day"),n=O()(e.toDate).endOf("day"),o=r.toDate(),s=n.toDate(),i=this.getDateArray(o,s);this.dates=i.map((function(e){return{prop:e.format("yyyyMMdd"),display:e.format("DDD, dd"),date:e,isHoliday:t.$userutils.isHoliday(e)}})),this.months=i.groupBy((function(e){return e.format("MMM, yyyy")})).map((function(e){return{monthName:e.key,days:e.values.length}}));var l=this.state.pageSettings.hideEstimate,c=(this.state.pageSettings.jql||"").trim();c&&(c=" AND (".concat(c,")"));var u='worklogAuthor in ("'.concat(a.join('","'),"\") and worklogDate >= '").concat(r.clone().add(-1,"days").format("YYYY-MM-DD"),"' and worklogDate < '").concat(n.clone().add(1,"days").format("YYYY-MM-DD"),"'").concat(c),d=["summary","worklog","issuetype","parent","project","status"];l||(d.push("timeoriginalestimate"),d.push("timeestimate"));var m=this.epicNameField;return m&&d.push(m),this.$jira.searchTickets(u,d).then((function(e){for(var r=a.map((function(e){var a={logData:[],userName:e.toLowerCase()};return a.userName===t.currentUserName&&(a.isCurrentUser=!0),a})),n={},i=0;i<r.length;i++){var l=r[i];n[l.userName]=l}for(var c=0;c<e.length;c++)for(var u=e[c],d=u.fields||{},p=(d.worklog||{}).worklogs||[],g=p.sum((function(e){return e.timeSpentSeconds})),f=d.timeoriginalestimate||0,h=d.timeestimate||0,v=f>0?h+g-f:0,y=0;y<p.length;y++){var k=p[y],b=O()(k.started).toDate(),E=O()(k.started).startOf("day").toDate();if(E.getTime()>=o.getTime()&&E.getTime()<=s.getTime()){var w=n[Object(F.e)(k.author,!0)];if(w){var S={ticketNo:u.key,epicDisplay:null,epicUrl:null,url:t.$userutils.getTicketUrl(u.key),issueType:(d.issuetype||"").name,parent:(d.parent||"").key,summary:d.summary,originalestimate:f,remainingestimate:h,totalLogged:g,estVariance:v,logTime:b,comment:k.comment,projectName:d.project.name,statusName:(d.status||{}).name,projectKey:d.project.key,totalHours:k.timeSpentSeconds};if(m){S.epicDisplay=d[m];var N=S.ticketNo.split("-")[0];S.epicDisplay&&0===S.epicDisplay.indexOf("".concat(N,"-"))&&(S.epicUrl=t.$userutils.getTicketUrl(S.epicDisplay))}w.logData.push(S)}}}for(var C=0;C<r.length;C++){var j=r[C];j.totalHours=j.logData.sum((function(e){return e.totalHours}))}return r}))}},{key:"generateFlatData",value:function(e){var t=this;this.flatData=this.state.groups.union((function(a){var r=a.name;return a.users.union((function(a){var n=a.displayName;return e.first((function(e){return e.userName===Object(F.e)(a,!0)})).logData.map((function(e){return{groupName:r,username:Object(F.e)(a),userDisplay:n,parent:e.parent,parentUrl:e.parent?t.$userutils.getTicketUrl(e.parent):null,epicDisplay:e.epicDisplay,epicUrl:e.epicUrl,ticketNo:e.ticketNo,ticketUrl:e.url,issueType:e.issueType,summary:e.summary,projectKey:e.projectKey,projectName:e.projectName,statusName:e.statusName,logTime:e.logTime,timeSpent:e.totalHours,originalestimate:e.originalestimate,remainingestimate:e.remainingestimate,totalLogged:e.totalLogged,estVariance:e.estVariance,comment:e.comment}}))}))}))}},{key:"getDateArray",value:function(e,t){for(var a=[],r=new Date(e);r<=t;)a.push(new Date(r)),r=r.addDays(1);return a}},{key:"renderCustomActions",value:function(){var e=this.state.dateRange;return v.a.createElement(v.a.Fragment,null,v.a.createElement(I.e,{value:e,range:!0,onChange:this.dateSelected,style:{marginRight:"35px"}}),v.a.createElement(I.b,{icon:"fa fa-users",onClick:this.showGroupsPopup,title:"Add users / groups to report"}),v.a.createElement(I.b,{icon:"fa fa-cogs",onClick:this.showSettings,title:"Show settings"}))}},{key:"render",value:function(){var e=this.months,t=this.dates,r=this.convertSecs,n=this.formatTime,o=this.formatDateTime,s=this.rawData,i=this.flatData,l=void 0===i?[]:i,c=this.state,u=c.isLoading,d=c.showGroupsPopup,m=c.showWorklogPopup,p=c.showSettings,h=c.groups,y=c.pageSettings,k=void 0===y?{}:y,b=k.breakupMode,E="".concat(k._uniqueId,"_").concat(l._uniqueId);return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement("div",{className:"worklog-gadget-container"},!s&&!u&&v.a.createElement(ie,null),u&&v.a.createElement("div",{className:"pad-15"},"Loading... please wait while the report is being loaded. It may take few seconds / minute based on the range you had selected."),s&&v.a.createElement(X.TabView,{className:"no-padding",renderActiveOnly:!1},v.a.createElement(X.TabPanel,{header:"Grouped - [User daywise]",contentClassName:"no-padding"},s&&v.a.createElement(ne,{rawData:s,groups:h,dates:t,months:e,pageSettings:k,convertSecs:r,formatTime:n,breakupMode:b,getTicketUrl:this.$userutils.getTicketUrl,maxSecsPerDay:this.maxSecsPerDay,addWorklog:this.addWorklog})),v.a.createElement(X.TabPanel,{header:"Summary - [User project wise]"},l&&v.a.createElement(le,{key:E,groups:h,flatData:l,formatDateTime:o,convertSecs:r})),v.a.createElement(X.TabPanel,{header:"Flat (Groupable)"},l&&v.a.createElement(ae,{key:E,flatData:l,formatDateTime:o,convertSecs:r,pageSettings:k,onChange:this.groupSettingsChanged}))),d&&v.a.createElement(Z.a,{groups:h,onHide:this.groupsChanged}),p&&v.a.createElement(ee,{pageSettings:k,onHide:this.settingsChanged}),m&&v.a.createElement(W.a,{worklog:this.worklogItem,onDone:this.worklogAdded,onHide:this.hideWorklog,uploadImmediately:!0})))}}]),a}(b.b),ue=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e,"Add Bookmark")).addBookmark=function(){var e=r.state.ticketsList;e.length>0?(r.setState({isLoading:!0}),r.$bookmark.addBookmark(e).then((function(t){0===t.length?r.onHide(!0):(r.setState({isLoading:!1,ticketsList:t}),e.length===t.length?r.$message.warning("None of the ticket numbers provided are valid."):e.length>t.length&&r.$message.warning("Some of the ticket numbers provided are not valid."))}))):r.onHide()},r.listChanged=function(e){return r.setState({ticketsList:e})},Object(Y.b)(Object(d.a)(r),"BookmarkService","MessageService"),r.style.width="380px",r.state.ticketsList=[],r}return Object(u.a)(a,[{key:"getFooter",value:function(){return v.a.createElement(v.a.Fragment,null,v.a.createElement(I.b,{type:"primary",onClick:this.addBookmark,label:"Save"}),v.a.createElement(I.b,{type:"default",onClick:this.onHide,label:"Cancel"}))}},{key:"render",value:function(){var e=this.state.ticketsList;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement("div",{className:"pad-22"},v.a.createElement(I.g,{value:e,onChange:this.listChanged,placeholder:"Enter one or more ticket numbers"}),v.a.createElement("strong",null,"Note:")," Press enter key to add multiple items"))}}]),a}(L.a),de=a(249),me=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e,"My Bookmarks","fa-bookmark")).refreshData=function(){r.setState({isLoading:!0,showAddPopup:!1}),r.$bookmark.getBookmarks().then((function(e){var t=r.state.selAllChk;e.forEach((function(e){e.ticketUrl=r.$userutils.getTicketUrl(e.ticketNo),e.selected=t,e.rowClass=r.$utils.getRowStatus(e)})),r.setState({isLoading:!1,bookmarksList:e})}))},r.selectAll=function(e){var t=r.state.bookmarksList;(t=Object(n.a)(t)).forEach((function(t){return t.selected=e})),r.setState({selAllChk:e,bookmarksList:t})},r.showAddPopup=function(){return r.setState({showAddPopup:!0})},r.hideAddPopup=function(e){e?r.refreshData():r.setState({showAddPopup:!1})},Object(E.a)(Object(d.a)(r),"JiraService","BookmarkService","UtilsService","UserUtilsService","MessageService"),r.contextMenu=[{label:"Select Bookmark",icon:"fa fa-check-square-o",command:function(){return r.selectTicket(r.selectedTicket)}},{label:"Add worklog",icon:"fa fa-clock-o",command:function(){return r.addWorklogOn(r.selectedTicket.ticketNo)}},{label:"Delete Bookmark",icon:"fa fa-trash-o",command:function(){return r.deleteBookmark(r.selectedTicket.ticketNo)}}],r.state.selAllBks=!1,r.state.bookmarksList=[],r}return Object(u.a)(a,[{key:"selectTicket",value:function(e){e.selected=!e.selected;var t=this.state.bookmarksList;t=Object(n.a)(t),this.setState({bookmarksList:t})}},{key:"UNSAFE_componentWillMount",value:function(){this.refreshData()}},{key:"showContext",value:function(e,t){this.selectedTicket=t,Object(x.showContextMenu)(e,this.contextMenu)}},{key:"deleteBookmark",value:function(e){var t,a=this;0!==(t=e?[e]:this.state.bookmarksList.filter((function(e){return e.selected})).map((function(e){return e.ticketNo}))).length?de.b.confirmDelete("Are you sure to delete the selected bookmark(s)?","Confirm delete bookmark(s)").then((function(){a.setState({isLoading:!0}),a.$bookmark.removeBookmark(t).then((function(e){a.setState({bookmarksList:e,isLoading:!1})}))})):this.$message.info("Select the bookmarks to be deleted!")}},{key:"executeEvent",value:function(e){e.type===r.a.TicketBookmarked?this.refreshData():Object(g.a)(Object(f.a)(a.prototype),"executeEvent",this).call(this,e)}},{key:"renderCustomActions",value:function(){var e=this;return v.a.createElement(v.a.Fragment,null,v.a.createElement(I.b,{icon:"fa fa-plus",onClick:this.showAddPopup,title:"Add ticket to bookmarks"}),v.a.createElement(I.b,{type:"danger",icon:"fa fa-trash-o",onClick:function(){return e.deleteBookmark()},title:"Remove selected ticket(s) from bookmarks"}))}},{key:"render",value:function(){var e=this,t=this.state,r=t.bookmarksList,n=t.selAllChk,o=t.showAddPopup;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement(v.a.Fragment,null,v.a.createElement(J.c,{dataset:r,exportSheetName:"My bookmarks"},v.a.createElement(J.e,null,v.a.createElement("tr",null,v.a.createElement(J.a,{className:"w40",noExport:!0},v.a.createElement(I.c,{checked:n,onChange:this.selectAll})),v.a.createElement(J.a,{sortBy:"ticketNo"},"Ticket No"),v.a.createElement(J.a,{sortBy:"issuetype"},"Type"),v.a.createElement(J.a,{sortBy:"summary"},"Summary"),v.a.createElement(J.a,{sortBy:"assigneeName"},"Assignee"),v.a.createElement(J.a,{sortBy:"reporter"},"Reporter"),v.a.createElement(J.a,{sortBy:"priority"},"Priority"),v.a.createElement(J.a,{sortBy:"status"},"Status"),v.a.createElement(J.a,{sortBy:"resolution"},"Resolution"),v.a.createElement(J.a,{sortBy:"createdSortable"},"Created"),v.a.createElement(J.a,{sortBy:"updatedSortable"},"Updated"))),v.a.createElement(J.d,null,(function(t,a){return v.a.createElement("tr",{key:t.ticketNo,onContextMenu:function(a){return e.showContext(a,t)},className:t.rowClass},v.a.createElement("td",{className:"text-center"},t.selected&&v.a.createElement(I.c,{checked:!0,onChange:function(){return e.selectTicket(t)}}),!t.selected&&v.a.createElement("i",{className:"fa fa-ellipsis-v",onClick:function(a){return e.showContext(a,t)}})),v.a.createElement("td",null,v.a.createElement("a",{href:t.ticketUrl,rel:"noopener noreferrer",className:"link strike",target:"_blank"},t.ticketNo)),v.a.createElement("td",null,t.issuetypeIcon&&v.a.createElement(I.f,{src:t.issuetypeIcon}),t.issuetype),v.a.createElement("td",null,t.summary),v.a.createElement("td",null,t.assigneeName),v.a.createElement("td",null,t.reporterName),v.a.createElement("td",null,t.priorityIcon&&v.a.createElement(I.f,{src:t.priorityIcon}),t.priority),v.a.createElement("td",null,t.statusIcon&&v.a.createElement(I.f,{src:t.statusIcon}),t.status),v.a.createElement("td",null,t.resolutionIcon&&v.a.createElement(I.f,{src:t.resolutionIcon}),t.resolution),v.a.createElement("td",null,t.created),v.a.createElement("td",null,t.updated))})),v.a.createElement(J.b,{span:11},"You have not yet bookmarked any tickets. Bookmark your frequently used tickets")),o&&v.a.createElement(ue,{onHide:this.hideAddPopup})))}}]),a}(b.b),pe=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e,"My open tickets","fa-eye")).refreshData=function(e){r.setState({isLoading:!0}),r.$jira.getOpenTickets(e).then((function(e){var t=e.map((function(e){var t=e.fields;return{ticketNo:e.key,ticketUrl:r.$userutils.getTicketUrl(e.key),issuetypeIcon:(t.issuetype||{}).iconUrl,issuetype:(t.issuetype||{}).name,summary:t.summary,reporter:(t.reporter||{}).displayName,priorityIcon:(t.priority||{}).iconUrl,priority:(t.priority||{}).name,statusIcon:(t.status||{}).iconUrl,status:(t.status||{}).name,resolutionIcon:(t.resolution||{}).iconUrl,resolution:(t.resolution||{}).name,createdSortable:t.created,updatedSortable:t.updated,created:r.$userutils.formatDateTime(t.created),updated:r.$userutils.formatDateTime(t.updated)}}));r.setState({ticketList:t,isLoading:!1})}))},r.bookmarkAdded=function(){return r.performAction(b.a.TicketBookmarked)},Object(E.a)(Object(d.a)(r),"JiraService","BookmarkService","UserUtilsService"),r.state.isLoading=!0,r.state.ticketList=[],r}return Object(u.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){this.refreshData()}},{key:"render",value:function(){var e=this,t=this.state.ticketList;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement(J.c,{dataset:t,exportSheetName:"My open tickets"},v.a.createElement(J.e,null,v.a.createElement("tr",null,v.a.createElement(J.a,{sortBy:"ticketNo"},"Ticket No"),v.a.createElement(J.a,{sortBy:"issuetype"},"Type"),v.a.createElement(J.a,{sortBy:"summary"},"Summary"),v.a.createElement(J.a,{sortBy:"reporter"},"Reporter"),v.a.createElement(J.a,{sortBy:"priority"},"Priority"),v.a.createElement(J.a,{sortBy:"status"},"Status"),v.a.createElement(J.a,{sortBy:"resolution"},"Resolution"),v.a.createElement(J.a,{sortBy:"createdSortable"},"Created"),v.a.createElement(J.a,{sortBy:"updatedSortable"},"Updated"))),v.a.createElement(J.d,null,(function(t,a){return v.a.createElement(ge,{key:a,ticket:t,onAddWorklog:e.addWorklogOn,onBookmark:e.bookmarkAdded})})),v.a.createElement(J.b,{span:9},"No open tickets were assigned to you. Enjoy your day!")))}},{key:"showContext",value:function(e,t){this.selectedTicket=t,Object(x.showContextMenu)(e,this.contextMenu)}}]),a}(b.b),ge=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(c.a)(this,a);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=t.call.apply(t,[this].concat(n))).setRef=function(t){return e.keyCtr=t},e}return Object(u.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.ticket,r=t.onAddWorklog,n=t.onBookmark;return v.a.createElement("tr",{onContextMenu:function(t){return e.keyCtr.showContext(t)}},v.a.createElement(q.i,{ref:this.setRef,value:a.ticketNo,onAddWorklog:r,onBookmark:n}),v.a.createElement("td",null,v.a.createElement(I.f,{src:a.issuetypeIcon}),a.issuetype),v.a.createElement("td",null,a.summary),v.a.createElement("td",null,a.reporter),v.a.createElement("td",null,v.a.createElement(I.f,{src:a.priorityIcon}),a.priority),v.a.createElement("td",null,v.a.createElement(I.f,{src:a.statusIcon}),a.status),v.a.createElement("td",null,a.resolutionIcon&&v.a.createElement(I.f,{src:a.resolutionIcon}),a.resolution),v.a.createElement("td",null,a.created),v.a.createElement("td",null,a.updated))}}]),a}(h.PureComponent),fe=pe,he=a(75),ve=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e,"My Reports","fa-filter")).refreshData=function(){r.setState({isLoading:!0}),r.$report.getReportsList().then((function(e){var t=r.state.selAllChk;e.forEach((function(e){e.selected=t,e.displayDate=r.$userutils.formatDateTime(e.dateCreated),e.sortDate=e.dateCreated.getTime()})),r.setState({reportsList:e,isLoading:!1})}))},r.deleteSelectedReports=function(){var e=r.state.reportsList.filter((function(e){return e.selected})).map((function(e){return e.id}));0!==e.length?de.b.confirmDelete("Are you sure to delete the selected report(s)?","Confirm delete report(s)").then((function(){r.setState({isLoading:!0}),r.$report.deleteSavedQuery(e).then((function(){return r.refreshData()}))})):r.$message.info("Select the reports to be deleted!")},r.selectAll=function(){var e=r.state,t=e.reportsList,a=e.selAllChk;a=!a,t.forEach((function(e){return e.selected=a})),t=Object(n.a)(t),r.setState({reportsList:t,selAllChk:a,selReportsCount:a?t.length:null})},r.downloadReports=function(){var e=r.state.reportsList.filter((function(e){return e.selected})).map((function(e){return e.id}));0!==e.length?r.$report.exportQueries(e):r.$message.info("Select the reports to be exported!")},r.fileSelected=function(){var e=r.fileSelector,t=e.files[0];if(t){if(!t.name.endsWith(".jrd"))return r.$message.warning("Unknown file selected to import. Select a valid Jira Assist Report definition (*.jrd) file"),void(e.value="");var a=new FileReader;a.readAsText(t,"UTF-8"),a.onload=function(e){var t=e.target.result;try{var a=JSON.parse(t).reports;if(!a||!Array.isArray(a))return void r.$message.error("Selected file is invalid or is corrupted");a.forEach((function(e){e.oldName=e.queryName,e.selected=!0,e.status="Will import"})),r.setState({reportsToImport:a})}catch(n){r.$message.error("Selected file is invalid or is corrupted")}},a.onerror=function(e){r.$message.error("Selected file is invalid or is corrupted. Unable to load the file!")}}e.value=""},r.editReport=function(e){r.context.navigate("/reports/".concat(e.advanced?"advanced":e.isNew?"custom":"customgrouped","/").concat(e.id),!0)},r.hideImportPopup=function(e){e&&r.refreshData(),r.setState({reportsToImport:null})},r.setFileSelector=function(e){return r.fileSelector=e},r.chooseFileForImport=function(){return r.fileSelector.click()},Object(E.a)(Object(d.a)(r),"ReportService","MessageService","UserUtils"),r.state.isLoading=!0,r}return Object(u.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){this.refreshData()}},{key:"selectRowItem",value:function(e){e.selected=!e.selected;var t=this.state.reportsList,a=(t=Object(n.a)(t)).count((function(e){return e.selected}));this.setState({reportsList:t,selReportsCount:a})}},{key:"renderCustomActions",value:function(){return v.a.createElement(v.a.Fragment,null,v.a.createElement("input",{ref:this.setFileSelector,type:"file",className:"hide",accept:".jrd",onChange:this.fileSelected}),v.a.createElement(I.b,{icon:"fa fa-upload",onClick:this.chooseFileForImport,title:"Import reports shared by others"}),v.a.createElement(I.b,{icon:"fa fa-download",disabled:!this.state.selReportsCount,onClick:this.downloadReports,title:"Export reports to share with others"}),v.a.createElement(I.b,{type:"danger",icon:"fa fa-trash-o",onClick:this.deleteSelectedReports,title:"Delete selected report(s)"}))}},{key:"render",value:function(){var e=this,t=this.state,r=t.reportsList,n=t.selAllChk,o=t.reportsToImport;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement(v.a.Fragment,null,v.a.createElement(J.c,{dataset:r,exportSheetName:"My reports"},v.a.createElement(J.e,null,v.a.createElement("tr",null,v.a.createElement(J.a,{className:"w40"},v.a.createElement(I.c,{checked:n,onChange:this.selectAll})),v.a.createElement(J.a,{sortBy:"queryName"},"Report name"),v.a.createElement(J.a,{sortBy:"sortDate"},"Created On"),v.a.createElement(J.a,{sortBy:"advanced"},"Report type"),v.a.createElement(J.a,{sortBy:"outputCount"},"Output fields"),v.a.createElement(J.a,null,"Options"))),v.a.createElement(J.d,null,(function(t){return v.a.createElement("tr",{key:t.id},v.a.createElement("td",{className:"text-center"},v.a.createElement(I.c,{checked:t.selected,onChange:function(){return e.selectRowItem(t)}})),v.a.createElement("td",null,t.queryName),v.a.createElement("td",null,t.displayDate),v.a.createElement("td",null,t.advanced?"Advanced report":"Custom Report".concat(t.isNew?"":" (old)")),v.a.createElement("td",null,t.outputCount),v.a.createElement("td",{className:"text-center"},v.a.createElement(I.b,{icon:"fa fa-edit",onClick:function(){return e.editReport(t)},title:"Click to edit this report"})))})),v.a.createElement(J.b,{span:7},"You have not yet created or imported any reports.")),o&&v.a.createElement(ke,{reportsToImport:o,onHide:this.hideImportPopup})))}}]),a}(b.b);ve.contextType=he.a;var ye=ve,ke=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e,"Select reports to import")).selectAllReports=function(){var e=r.state,t=e.selectAll,a=e.reportsToImport;t=!t,(a=Object(n.a)(a)).forEach((function(e){e.selected=!e.disabled&&t,r.updateReportStatus(e)})),r.setState({selectAll:t,reportsToImport:a,selReportsCount:r.getReportsCount(a)})},r.getReportsCount=function(e){return(e||r.state.reportsToImport).filter((function(e){return e.selected})).length},r.importReports=function(){var e=r.state.reportsToImport.filter((function(e){return e.selected})),t=e.map((function(e){var t=Object(l.a)({},e);return delete t.selected,delete t.id,delete t.oldName,delete t.status,r.$report.saveQuery(t).then((function(t){return e.selected=!1,e.disabled=!0,e.status="Imported",!0}),(function(){return e.status="Duplicate name",!1}))}));Promise.all(t).then((function(t){if(t.all((function(e){return e})))r.$message.success("".concat(e.length," selected reports were imported"),"Reports imported"),r.onHide(!0);else{r.$message.error("Some of the reports were not import!","Import failed");var a=r.state.reportsToImport;a=Object(n.a)(a),r.setState({selReportsCount:r.getReportsCount(a),reportsToImport:a})}}))},Object(E.a)(Object(d.a)(r),"UserUtilsService","MessageService","ReportService"),r.style={width:"850px"},r.state.selectAll=!0,r.state.reportsToImport=r.props.reportsToImport,r.state.selReportsCount=r.getReportsCount(),r}return Object(u.a)(a,[{key:"reportSelected",value:function(e){e.selected=!e.selected,this.updateReportStatus(e),this.setState({selReportsCount:this.getReportsCount()})}},{key:"updateReportStatus",value:function(e){e.selected?(e.queryName||(e.queryName=e.oldName),e.status="Will import"):e.status="Excluded"}},{key:"reportNameChanged",value:function(e,t){e.queryName=t,e.queryName?e.status="Will import":e.status="Name required",this.forceUpdate()}},{key:"getFooter",value:function(){var e=this.state.selReportsCount;return v.a.createElement(v.a.Fragment,null,v.a.createElement(I.b,{icon:"fa fa-times",onClick:this.onHide,label:"Cancel",type:"default"}),v.a.createElement(I.b,{icon:"fa fa-check",disabled:!e,onClick:this.importReports,label:"Import",type:"primary"}))}},{key:"render",value:function(){var e=this,t=this.state,r=t.reportsToImport,n=t.selectAll;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement("div",null,v.a.createElement(J.c,{dataset:r},v.a.createElement("caption",null,"Select all the reports which you would like to import and provide a name for the report to import."),v.a.createElement(J.e,null,v.a.createElement("tr",null,v.a.createElement("th",{className:"no-min-width no-pad"},v.a.createElement(I.c,{checked:n,onChange:this.selectAllReports})),v.a.createElement("th",null,"Report name"),v.a.createElement("th",null,"Report name (new)"),v.a.createElement("th",null,"Created date"),v.a.createElement("th",null,"Last modified date"),v.a.createElement("th",null,"Status"))),v.a.createElement(J.d,null,(function(t,a){return v.a.createElement("tr",{key:"".concat(a,"_").concat(t.status)},v.a.createElement("td",{className:"data-center"},v.a.createElement(I.c,{checked:t.selected,disabled:t.disabled,onChange:function(a){return e.reportSelected(t,a)}})),v.a.createElement("td",null,t.oldName),v.a.createElement("td",null,v.a.createElement(I.j,{value:t.queryName,disabled:t.disabled||!t.selected,onChange:function(a){return e.reportNameChanged(t,a)}})),v.a.createElement("td",null,e.$userutils.formatDateTime(t.dateCreated)),v.a.createElement("td",null,e.$userutils.formatDateTime(t.dateUpdated)),v.a.createElement("td",null,t.status))})))))}}]),a}(L.a),be=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e,"Worklog - [Pending upload]","fa-clock-o")).refreshData=function(){return r.setState({isLoading:!0}),r.$worklog.getPendingWorklogs().then((function(e){var t=r.state.selAllChk;e.forEach((function(e){e.ticketUrl=r.$userutils.getTicketUrl(e.ticketNo),e.rowClass=r.$utils.getRowStatus(e),e.displayDate=r.$userutils.formatDateTime(e.dateStarted),e.selected=t,e.timeSpent=r.$utils.formatTs(e.timeSpent),e.overrideTimeSpent=r.$utils.formatTs(e.overrideTimeSpent)})),r.setState({isLoading:!1,worklogs:e})}))},r.selectAll=function(e){var t=r.state.worklogs;t.forEach((function(t){return t.selected=e})),r.setState({worklogs:Object(n.a)(t),selAllChk:e})},Object(E.a)(Object(d.a)(r),"WorklogService","UtilsService","UserUtilsService","MessageService"),r.contextMenu=[{label:"Select worklog",icon:"fa fa-check-square-o",command:function(){return r.selectRowItem(r.selectedItem)}},{label:"Edit worklog",icon:"fa fa-edit",command:function(){return r.editWorklogObj()}},{label:"Copy worklog",icon:"fa fa-copy",command:function(){return r.editWorklogObj(!0)}},{label:"Upload worklog",icon:"fa fa-upload",command:function(){return r.uploadWorklog([r.selectedItem])}},{label:"Delete worklog",icon:"fa fa-trash-o",command:function(){return r.deleteWorklog([r.selectedItem])}}],r.state.selAllChk=!0,r.state.isLoading=!0,r}return Object(u.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){this.refreshData()}},{key:"editWorklogObj",value:function(e){var t=Object.create(this.selectedItem);t.copy=e,this.addWorklog(t)}},{key:"showContext",value:function(e,t){this.selectedItem=t,Object(x.showContextMenu)(e,this.contextMenu)}},{key:"uploadWorklog",value:function(e){var t=this;e||(e=this.state.worklogs.filter((function(e){return e.selected})));var r=e.map((function(e){return e.id}));0!==r.length?(this.setState({isLoading:!0}),this.$worklog.uploadWorklogs(r).then((function(e){t.setState({isLoading:!1,worklogs:e}),Object(g.a)(Object(f.a)(a.prototype),"performAction",t).call(t,b.a.WorklogModified)}),(function(e){e&&e.$message&&t.$message.warning(e.message),t.refreshData()}))):this.$message.info("Select the worklogs to be uploaded!")}},{key:"deleteWorklog",value:function(e){var t=this;e||(e=this.state.worklogs.filter((function(e){return e.selected})));var a=e.map((function(e){return e.id}));0!==a.length?de.b.confirmDelete("Are you sure to delete the selected worklog(s)?","Confirm delete worklog(s)").then((function(){t.setState({isLoading:!0}),t.$worklog.deleteWorklogs(a).then((function(e){t.refreshData(),t.performAction(b.a.DeletedWorklog)}))})):this.$message.info("Select the worklogs to be deleted!")}},{key:"executeEvent",value:function(e){e.type===b.a.AddWorklog||e.type===b.a.DeletedWorklog||e.type===b.a.WorklogModified?this.refreshData():Object(g.a)(Object(f.a)(a.prototype),"executeEvent",this).call(this,e)}},{key:"selectRowItem",value:function(e){e.selected=!e.selected;var t=this.state.worklogs;this.setState({worklogs:Object(n.a)(t)})}},{key:"renderCustomActions",value:function(){var e=this;return v.a.createElement(v.a.Fragment,null,v.a.createElement(I.b,{icon:"fa fa-upload",onClick:function(){return e.uploadWorklog()},title:"Upload selected worklogs"}),v.a.createElement(I.b,{type:"danger",icon:"fa fa-trash-o",onClick:function(){return e.deleteWorklog()},title:"Delete selected worklogs"}))}},{key:"render",value:function(){var e=this,t=this.state,r=t.worklogs,n=t.selAllChk;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement(J.c,{dataset:r,exportSheetName:"Pending worklogs"},v.a.createElement(J.e,null,v.a.createElement("tr",null,v.a.createElement(J.a,{className:"w40",noExport:!0},v.a.createElement(I.c,{checked:n,onChange:this.selectAll})),v.a.createElement(J.a,{sortBy:"ticketNo"},"Ticket No"),v.a.createElement(J.a,{sortBy:"summary"},"Summary"),v.a.createElement(J.a,{sortBy:"dateStarted"},"Log Time"),v.a.createElement(J.a,{sortBy:"timeSpent"},"Time Spent"),v.a.createElement(J.a,{sortBy:"overrideTimeSpent"},"Override Time"),v.a.createElement(J.a,null,"Description"))),v.a.createElement(J.d,null,(function(t){return v.a.createElement("tr",{key:t.id,onContextMenu:function(a){return e.showContext(a,t)},className:t.rowClass},v.a.createElement("td",{className:"text-center"},t.selected&&v.a.createElement(I.c,{checked:!0,onChange:function(){return e.selectRowItem(t)}}),!t.selected&&v.a.createElement("i",{className:"fa fa-ellipsis-v",onClick:function(a){return e.showContext(a,t)}})),v.a.createElement("td",null,v.a.createElement("a",{href:t.ticketUrl,rel:"noopener noreferrer",className:"link strike",target:"_blank"},t.ticketNo)),v.a.createElement("td",null,t.summary),v.a.createElement("td",null,t.displayDate),v.a.createElement("td",null,t.timeSpent),v.a.createElement("td",null,t.overrideTimeSpent),v.a.createElement("td",null,t.description))})),v.a.createElement(J.b,{span:7},"No worklog pending to be uploaded!")))}}]),a}(b.b),Ee=function(e){Object(m.a)(a,e);var t=Object(p.a)(a);function a(e){var r;return Object(c.a)(this,a),(r=t.call(this,e,"Ticketwise worklog","fa-list-alt")).refreshData=function(){var e=r.settings.dateRange;e&&e.fromDate&&(r.setState({isLoading:!0}),e.dateWise=!1,r.$worklog.getWorklogs(e).then((function(e){e.forEach((function(e){e.rowClass=r.$utils.getRowStatus(e),e.ticketUrl=r.$userutils.getTicketUrl(e.ticketNo),e.totalHours=r.$utils.formatTs(e.totalHours),e.uploaded=r.$utils.formatTs(e.uploaded),e.pendingUpload=r.$utils.formatTs(e.pendingUpload)})),r.setState({isLoading:!1,worklogs:e})})))},r.dateSelected=function(e){r.settings.dateRange=e,e.toDate&&(r.refreshData(),e.auto||r.saveSettings())},Object(Y.b)(Object(d.a)(r),"WorklogService","UserUtilsService","UtilsService"),r.contextMenu=[{label:"Upload worklog",icon:"fa fa-clock-o",command:function(){return r.uploadWorklog()}},{label:"Add worklog",icon:"fa fa-bookmark",command:function(){return r.addWorklog()}}],r}return Object(u.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){this.refreshData()}},{key:"showContext",value:function(e,t){this.selectedTicket=t,Object(x.showContextMenu)(e,this.contextMenu)}},{key:"renderCustomActions",value:function(){return v.a.createElement(I.e,{range:!0,value:this.settings.dateRange,onChange:this.dateSelected,style:{marginRight:"35px"}})}},{key:"getWorklogUrl",value:function(e,t){return this.$userutils.getWorklogUrl(e,t)}},{key:"getTicketUrl",value:function(e){return this.$userutils.getTicketUrl(e)}},{key:"uploadWorklog",value:function(){var e=this,t=this.selectedTicket.logData.filter((function(e){return!e.worklogId})).map((function(e){return e.id}));t.length&&(this.setState({isLoading:!0}),this.$worklog.uploadWorklogs(t).then((function(){e.refreshData(),Object(g.a)(Object(f.a)(a.prototype),"performAction",e).call(e,r.a.WorklogModified)}),(function(t){e.setState({isLoading:!1})})))}},{key:"addWorklog",value:function(){var e=this.selectedTicket.ticketNo,t=j().subtract(1,"hours").toDate();Object(g.a)(Object(f.a)(a.prototype),"addWorklog",this).call(this,{ticketNo:e,startTime:t,timeSpent:"01:00",allowOverride:!0})}},{key:"render",value:function(){var e=this,t=this.state.worklogs;return Object(g.a)(Object(f.a)(a.prototype),"renderBase",this).call(this,v.a.createElement(J.c,{dataset:t,exportSheetName:"Ticketwise worklog"},v.a.createElement(J.e,null,v.a.createElement("tr",null,v.a.createElement(J.a,{sortBy:"ticketNo",style:{width:"100px"}},"Ticket No"),v.a.createElement(J.a,{sortBy:"summary"},"Summary"),v.a.createElement(J.a,{sortBy:"totalHours"},"Total Hours"),v.a.createElement(J.a,{sortBy:"uploaded"},"Uploaded"),v.a.createElement(J.a,{sortBy:"pendingUpload"},"Pending Upload"),v.a.createElement(J.a,{sortBy:"parentKey"},"Parent Ticket"),v.a.createElement(J.a,null,"Dates Logged"),v.a.createElement(J.a,{style:{width:"400px"}},"Description"))),v.a.createElement(J.d,null,(function(t){return v.a.createElement("tr",{key:t.ticketNo,onContextMenu:function(a){return e.showContext(a,t)},className:t.rowClass},v.a.createElement("td",null,v.a.createElement("a",{href:t.ticketUrl,rel:"noopener noreferrer",className:"link strike",target:"_blank"},t.ticketNo)),v.a.createElement("td",null,t.summary),v.a.createElement("td",null,t.totalHours),v.a.createElement("td",null,t.uploaded),v.a.createElement("td",null,t.pendingUpload),v.a.createElement("td",null,t.parentKey?"".concat(t.parentKey," - ").concat(t.parentSumm):""),v.a.createElement("td",null,v.a.createElement("ul",{className:"tags"},t.logData.map((function(a,r){return v.a.createElement("li",{key:r},a.worklogId&&v.a.createElement("a",{className:"link badge badge-pill skin-bg-font",href:e.getWorklogUrl(t.ticketNo,a.worklogId),target:"_blank",rel:"noopener noreferrer",title:a.comments},v.a.createElement("span",{className:"fa fa-clock-o"}),"  ",v.a.createElement(q.b,{tag:"span",value:a.dateLogged}),": ",a.uploaded),!a.worklogId&&v.a.createElement("span",{className:"link badge badge-pill skin-bg-font",onClick:function(){return e.editWorklog(a.id)},title:a.comments},v.a.createElement("span",{className:"fa fa-clock-o"})," ",v.a.createElement(q.b,{tag:"span",value:a.dateLogged}),": ",a.uploaded))})))),v.a.createElement("td",null,t.description))})),v.a.createElement(J.b,{span:8},"No records exists")))}}]),a}(b.b),we=[{id:"myOpenTickets",icon:"fa-eye",name:"My Open Tickets",details:"Contains the list of open tickets assigned to you"},{id:"myBookmarks",icon:"fa-bookmark",name:"Bookmarks",details:"List of bookmarked tickets"},{id:"dateWiseWorklog",icon:"fa-list-alt",name:"Logged Work - [Daywise]",details:"List of worklog's grouped by date"},{id:"pendingWorklog",icon:"fa-clock-o",name:"Worklog - [Pending Upload]",details:"Worklog's still pending for upload"},{id:"ticketWiseWorklog",icon:"fa-list-alt",name:"Logged Work - [Ticketwise]",details:"List of worklog's grouped by ticket"},{id:"myFilters",icon:"fa-filter",name:"My Reports",details:"List of custom & advanced report built / imported by you"},{id:"agendaDay",icon:"fa-calendar",name:"Current day calendar",details:"Display calendar for current date for worklog and meetings"},{id:"agendaWeek",icon:"fa-calendar",name:"Current week calendar",details:"Display calendar for current week for worklog and meetings"},{id:"sWiseTSpent",icon:"fa-list-alt",name:"Status Wise Time Spent",details:"Provides summary of time spent on each ticket on individual status"}]},272:function(e,t,a){},273:function(e,t,a){},275:function(e,t,a){},297:function(e,t,a){"use strict";var r=a(5),n=a(6),o=a(243),s=a(37),i=a(15),l=a(16),c=a(2),u=a.n(c),d=a(247),m=a(242),p=function(e){Object(i.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e,"Save Report As")).nameChanged=function(e){return n.setState({newQueryName:e})},n.copyChanged=function(e){return n.setState({copyQuery:e})},n.done=function(){var e=n.state,t=e.newQueryName,a=e.copyQuery;n.props.onChange(t,a)},n.style={width:"350px"},n.state={showDialog:!0,newQueryName:e.queryName||"",copyQuery:!1},n}return Object(n.a)(a,[{key:"getFooter",value:function(){var e=this.state.newQueryName;return u.a.createElement(u.a.Fragment,null,u.a.createElement(m.b,{type:"secondary",label:"Cancel",onClick:this.onHide}),u.a.createElement(m.b,{type:"primary",icon:"fa fa-floppy-o",label:"Save",disabled:!e||e.length<3,onClick:this.done}))}},{key:"render",value:function(){var e=this.props.allowCopy,t=this.state,r=t.newQueryName,n=t.copyQuery;return Object(o.a)(Object(s.a)(a.prototype),"renderBase",this).call(this,u.a.createElement("div",{className:"pad-15"},u.a.createElement("label",null,"Report Name"),u.a.createElement("div",null,u.a.createElement(m.j,{value:r,onChange:this.nameChanged,style:{width:"100%"}})),e&&u.a.createElement("div",null,u.a.createElement(m.c,{checked:n,onChange:this.copyChanged,label:"Save as new report"}))))}}]),a}(d.a);t.a=p},331:function(e,t,a){},356:function(e,t,a){"use strict";var r=a(5),n=a(6),o=a(46),s=a(243),i=a(37),l=a(15),c=a(16),u=a(2),d=a.n(u),m=a(244),p=a(9),g=a(245),f=(a(331),a(1)),h=a(10),v=a(253),y=a(255),k=function(e){Object(l.a)(a,e);var t=Object(c.a)(a);function a(e){var n;Object(r.a)(this,a);var s=e.definition;return s=s||{},(n=t.call(this,e,s.queryName||"Custom report viewer (deprecated)","fa-clock-o")).refreshData=function(){n.props.reportId>0?n.$report.getReportDefinition(n.props.reportId).then((function(e){n.setState({reportDefinition:e},n.fillReport)})):n.state.reportDefinition&&n.fillReport()},n.fillReport=function(){var e=n.state.reportDefinition||{};e&&(n.title="".concat(e.queryName," (deprecated)")),e.jql&&e.outputFields&&e.outputFields.length&&(n.setState({isLoading:!0}),n.dataFields=e.outputFields.map((function(e){return e.id})),n.$jira.searchTickets(e.jql,n.dataFields).then((function(t){n.headerFields=e.outputFields.map((function(e){var t=e.name;return e.functions&&e.functions.header&&(t=e.functions.header.replace("{0}",t)),{text:t,rowspan:2}})),n.processIssues(t);var a=n.headerFields,r=[];n.headerFields.filter((function(e){return e.subCols&&e.subCols.length>0})).forEach((function(e){r.addRange(e.subCols),r.push({text:"Total"}),e.colspan=e.subCols.length+1,e.rowspan=1}));var o=e.outputFields.filter((function(e){return e.groupBy})),s=o.length>0?n.groupData(t,Array.from(o)):t;n.dataFields=e.outputFields.filter((function(e){return!e.groupBy})),n.reportHtml=n.genHtmlRow(s);var i=s.length>0;n.setState({subFields:r,hasReportData:i,displayFields:a,isLoading:!1}),n.$analytics.trackEvent("Custom report viewed",f.i.UserActions)})))},n.addWorklog=function(e){var t={ticketNo:e};n.setState({showWorklogPopup:!0,worklogItem:t})},n.hideWorklog=function(){n.setState({showWorklogPopup:!1})},Object(p.a)(Object(o.a)(n),"AnalyticsService","ReportService","JiraService","UtilsService","UserUtilsService"),n.state.reportDefinition=s,n}return Object(n.a)(a,[{key:"UNSAFE_componentWillMount",value:function(){this.refreshData()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){(e.definition&&e.definition!==this.state.reportDefinition||e.reportId)&&this.setState({reportDefinition:e.definition},this.refreshData)}},{key:"genHtmlRow",value:function(e,t){for(var a=this,r=function(e,r,n,o){var s=[];t&&0===e&&0===r&&s.addRange(t),0===r&&n.issues&&s.push(a.getGroupedTD(n.name,o.length));for(var i=o[r],l=i.fields,c=function(e){var t=a.dataFields[e];if(t.functions&&t.functions.useArray)0===r&&("issuekey"===t.id?s.push(a.getAggregateTD(o.map((function(e){return e.key})),t.functions)):s.push(a.getAggregateTD(o.map((function(e){return e.fields[t.id]})),t.functions)));else if("worklog"===t.id){for(var n=a.fieldOpts.worklogUsers,c=l.worklogs_proc,u=0,d=0;d<n.length;d++)if(c){var m=c[n[d].id];m?(u+=m.timespent,s.push(a.getTD(m.timespent,t.functions))):s.push(a.getTD())}else s.push(a.getTD("#Error"));u?s.push(a.getTD(u,t.functions)):s.push(a.getTD())}else"issuekey"===t.id?s.push(a.getIssueKeyTD(i.key,t.functions)):s.push(a.getTD(l[t.id],t.functions))},u=0;u<a.dataFields.length;u++)c(u);return s},n=[],o=0;o<e.length;o++){var s=e[o];if(s.subGroups){var i=this.getGroupedTD(s.name,s.issueCount);n.addRange(this.genHtmlRow(s.subGroups,0===o?[t,i]:[i]))}else for(var l=s.issues||[s],c=0;c<l.length;c++)n.push(d.a.createElement("tr",null,r(o,c,s,l)))}return n}},{key:"getTD",value:function(e,t){return e?d.a.createElement("td",null,this.execute(e,t)):d.a.createElement("td",null,"\xa0")}},{key:"getIssueKeyTD",value:function(e,t){return"string"===typeof e?d.a.createElement(v.i,{value:e,onAddWorklog:this.addWorklog}):this.getTD(e,t)}},{key:"getAggregateTD",value:function(e,t){return d.a.createElement("td",{className:"bold",rowSpan:e.length},this.execute(e,t))}},{key:"getGroupedTD",value:function(e,t){e||(e="<No Value>"),e+=" (".concat(t,")");var a=t>4||e.length/t<2.5;return d.a.createElement("td",{className:a?"rotateM90":"bold",rowSpan:t},"\xa0",d.a.createElement("div",null,e))}},{key:"groupData",value:function(e,t){var a=this;if(!t||!t.length)return e;var r=t[0],n=r.id,o=r.functions;t.removeAt(0);var s=o.useArray,i=function(e){var r={name:e.key},n=e.values;return t.length>0?(r.subGroups=a.groupData(n,Array.from(t)),r.issueCount=r.subGroups.sum((function(e){return e.issueCount}))):(r.issues=n,r.issueCount=r.issues.length),r};if(s){var l=e.map("issuekey"===n?function(e){return e.key}:function(e){return e.fields[n]},!0);return[i({key:this.execute(l,o),values:e})]}return e.groupBy((function(e){var t=e.fields[n];return t?a.execute(t,o):t})).map((function(e){return i(e)}))}},{key:"execute",value:function(e,t){if(!e||!t||!t.name)return e;var a="#Error";try{var r=this.$utils,n=this.$utils[t.name];if(n&&n.apply||(n=this.$userutils[t.name],r=this.$userutils),n&&n.apply||(n=b[t.name],r=e),!n||!n.apply)return"#Error: Func not found";var o=[e].addRange(t.params);a=n.apply(r,o)}catch(s){console.error(s)}return null!==a?a:""}},{key:"processIssues",value:function(e){var t=this.dataFields.indexOf("worklog");if(-1!==t){var a=[],r=[];this.fieldOpts={};for(var n=0;n<e.length;n++){var o=e[n].fields;if(o.worklog&&o.worklog.worklogs.length>0){for(var s=o.worklog.worklogs.groupBy((function(e){return{id:Object(h.e)(e.author),text:e.author.displayName}})),i={},l=0;l<s.length;l++){var c=s[l],u=c.key.id;-1===r.indexOf(u)&&(a.push(c.key),r.push(u)),i[u]={timespent:c.values.sum((function(e){return e.timeSpentSeconds}))}}o.worklogs_proc=i}else o.worklog&&o.worklog.worklogs&&0===o.worklog.worklogs.length&&(o.worklogs_proc={})}var d=this.headerFields[t];d.subCols=a.orderBy((function(e){return e.text})),this.fieldOpts.worklogUsers=d.subCols}}},{key:"render",value:function(){var e=this.reportHtml,t=this.state,r=t.isLoading,n=t.hasReportData,o=t.displayFields,l=t.subFields,c=t.showWorklogPopup,u=t.worklogItem;return Object(s.a)(Object(i.a)(a.prototype),"renderBase",this).call(this,d.a.createElement("div",{className:"cust-report-viewer"},n&&d.a.createElement(g.c,null,d.a.createElement(g.e,null,d.a.createElement("tr",{className:"data-center"},o.map((function(e,t){return d.a.createElement("th",{key:t,rowSpan:e.rowspan,colSpan:e.colspan},e.text)}))),!!l&&l.length>0&&d.a.createElement("tr",{className:"data-center"},l.map((function(e,t){return d.a.createElement("th",{key:t},e.text)})))),!n&&!r&&d.a.createElement("tbody",null,d.a.createElement("tr",null,d.a.createElement("td",{colSpan:o&&o.length},"No records exists"))),n&&d.a.createElement("tbody",null,e)),c&&d.a.createElement(y.a,{worklog:u,onDone:this.hideWorklog,onHide:this.hideWorklog})))}}]),a}(m.b);t.a=k;var b={last:function(e){return null!==e&&void 0!==e&&e.length?e[e.length-1]:null},first:function(e){return null!==e&&void 0!==e&&e.length?e[0]:null}}},399:function(e,t,a){"use strict";var r=a(31),n=a(8),o=a(5),s=a(6),i=a(46),l=a(243),c=a(37),u=a(15),d=a(16),m=a(2),p=a.n(m),g=a(9),f=a(1),h=a(244),v=a(242),y=a(112),k=a(245),b=[{name:"formatDate",returns:"string",text:"Format Date",description:"",types:["date","datetime"]},{name:"formatDateTime",returns:"string",text:"Format Date & time",description:"",types:["datetime","date"]},{name:"formatTime",returns:"string",text:"Format Time",description:"",types:["datetime"]},{name:"formatDateTime?1",returns:"string",text:"Custom Format",description:"",types:["datetime","date"]},{name:"",text:"No formatting",description:"",types:["string","number","datetime","date","seconds"]},{name:"sum?0",returns:"number",text:"Sum values",description:"",types:["number"],forArray:!0},{name:"min?0",returns:"number",text:"Min of values",description:"",types:["number"],forArray:!0},{name:"max?0",returns:"number",text:"Max of values",description:"",types:["number"],forArray:!0},{name:"avg?0",returns:"number",text:"Average of values",description:"",types:["number"],forArray:!0},{name:"count?0",returns:"number",text:"Count of values",description:"",types:["*"],forArray:!0},{name:"count?1",returns:"number",text:"Count of distinct values",description:"",types:["number","datetime","date"],forArray:!0},{name:"sum?1",returns:"number",text:"Sum of group",description:"",types:["number"],aggregate:!0,header:"Sum of {0}"},{name:"min?1",returns:"number",text:"Min of group",description:"",types:["number"],aggregate:!0,header:"Min of {0}"},{name:"max?1",returns:"number",text:"Max of group",description:"",types:["number"],aggregate:!0,header:"Max of {0}"},{name:"avg?1",returns:"number",text:"Average of group",description:"",types:["number"],aggregate:!0,header:"Average of {0}"},{name:"count?2",returns:"number",text:"Count of group",description:"",types:["*","!worklog"],aggregate:!0,header:"Count of {0}"},{name:"count?3",returns:"number",text:"Count of distinct values",description:"",types:["number","datetime","date"],aggregate:!0,header:"Count of distinct {0}"},{name:"first",returns:"number",text:"First",description:"",types:["*"],forArray:!0},{name:"last",returns:"number",text:"Last",description:"",types:["*"],forArray:!0},{name:"propOfNthItem?0",returns:"string",text:"Name of First Item",description:"",types:["object"],forArray:!0,params:[{value:0},{value:"name"}]},{name:"propOfNthItem?1",returns:"string",text:"Name of Last Item",description:"",types:["object"],forArray:!0,params:[{value:"last"},{value:"name"}]},{name:"propOfNthItem?2",returns:"string",text:"Name of First Item (from csv)",description:"",types:["string"],forArray:!0,params:[{value:0},{value:"name"},{value:!0}]},{name:"propOfNthItem?3",returns:"string",text:"Name of Last Item (from csv)",description:"",types:["string"],forArray:!0,params:[{value:"last"},{value:"name"},{value:!0}]},{name:"format?1",returns:"number",text:"Two Decimals",description:"",types:["number"]},{name:"format?2",returns:"number",text:"No Decimals",description:"",types:["number"]},{name:"format?3",returns:"number",text:"Currency",description:"",types:["number"]},{name:"formatSecs?1",returns:"string",text:"Sum & Format Seconds (hours)",description:"Format seconds and show in hours, mins and secs",aggregate:!0,types:["seconds","number"]},{name:"formatSecs?0",returns:"string",text:"Format Seconds (hours)",description:"Format seconds and show in hours, mins and secs",types:["seconds","number"]},{name:"formatDays?0",returns:"string",text:"Format Seconds (days)",description:"Format seconds and show in days, hours, mins and secs",types:["seconds","number"]},{name:"convertSecs?0",returns:"number",text:"Convert Seconds (hours)",description:"Convert seconds into hours",types:["seconds","number"]},{name:"convertSecs?0",returns:"number",text:"Time spent (hours)",description:"Display worklog in hours",types:["worklog"]},{name:"formatSecs?0",returns:"number",text:"Format Time spent (hours)",description:"Display worklog in hours",types:["worklog"]},{name:"formatUser?1",returns:"string",text:"User Display Name",description:"",types:["user"],params:[{value:"DN"}]},{name:"formatUser?2",returns:"string",text:"User Email",description:"",types:["user"],params:[{value:"EM"}]},{name:"formatUser?3",returns:"string",text:"User Login",description:"",types:["user"],params:[{value:"LG"}]},{name:"formatUser?4",returns:"string",text:"User Display Name & Email",description:"",types:["user"],params:[{value:"NE"}]},{name:"formatUser?5",returns:"string",text:"User Display Name & Login",description:"",types:["user"],params:[{value:"NL"}]},{name:"getProperty?0",returns:"string",text:"Get name value",description:"",types:["object"],params:[{type:"string",display:"Property Name:",value:"name"}]},{name:"getProperty?1",returns:"string",text:"Get property value (string)",description:"",types:["object"],params:[{type:"string",display:"Property Name:",default:"name",prompt:!0}]},{name:"getProperty?2",returns:"number",text:"Get property value (number)",description:"",types:["object"]},{name:"getProperty?3",returns:"datetime",text:"Get property value (datetime)",description:"",types:["object"]},{name:"convertToNumber",returns:"number",text:"Try convert to number",description:"",types:["string"]},{name:"objFromCSV?1",returns:"object",text:"Object from CSV",description:"",types:["string"]},{name:"objFromCSV?2",returns:"object",text:"Name from CSV",description:"",types:["string"]}],E={date:"formatDate",datetime:"formatDateTime",number:"",user:"formatUser?1",string:"",object:"getProperty?0",seconds:"formatSecs?0",worklog:"convertSecs?0"},w=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var r;Object(o.a)(this,a),(r=t.call(this,e)).selectionChanged=function(e){r.setState(r.setFunction(e))};var n=e.row,s=b.filter((function(e){return(e.types.indexOf(n.type)>-1||e.types.indexOf("*")>-1||n.knownObj&&e.types.indexOf("object")>-1)&&!n.isArray===!e.forArray&&-1===e.types.indexOf("!".concat(n.type))})).map((function(e){return{value:e.name||"~~",label:e.text}}));if(r.state={applFuncs:s},!n.functions){var i=E[n.type];i||""===i?r.setFunction(i):r.setFunction((s.first()||{}).value)}return r}return Object(s.a)(a,[{key:"setFunction",value:function(e){if(e||""===e){""!==e||this.state.applFuncs.some((function(t){return t.value===e}))||(e=this.state.applFuncs.first().value),"~~"===e&&(e="");var t=b.first((function(t){return t.name===e}));if(!t&&e&&(t=b.first((function(t){return t.name.startsWith("".concat(e,"?"))}))),t){var a=e,r=t.name.split("?")[0],n=t.params?t.params.map((function(e){return void 0!==e.value?e.value:e.default})):null;return this.props.onChange({id:t.name,name:r,params:n,useArray:t.aggregate,header:t.header}),{selFunction:a}}console.error("Unknown function expression:",e)}}},{key:"render",value:function(){var e=this.state.applFuncs,t=this.props.row.functions,a=(t=void 0===t?{}:t).id;return p.a.createElement(v.i,{dataset:e,value:a||"~~",valueField:"value",style:{width:"100%"},onChange:this.selectionChanged})}}]),a}(m.PureComponent),S=a(297),N=a(249),C=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e,"Query Editor","fa-filter")).initModel=function(e){s.setState(s.getClearState(!!e,s.props))},s.saveQuery=function(e,t){var a=s.state.reportQuery,r=(a=Object(n.a)({},a)).queryName,o=!1;a.queryName=e,t?(delete a.id,o=!0):r!==e&&(o=!0),s.$report.saveQuery(a).then((function(e){a.id=e,s.setState({showSaveDialog:!1,selReportId:a.id,reportQuery:a}),o&&s.fillQueriesList(),s.$message.success("Report saved successfully!"),s.$analytics.trackEvent("Custom Report Saved")}),(function(e){e&&e.message&&s.$message.error(e.message)}))},s.displayFieldAdded=function(e){if(e&&!e.items){var t=s.state.reportQuery;t=Object(n.a)({},t);var a=s.jiraFields.first((function(t){return t.id===e}));t.outputFields=t.outputFields.concat(s.getField(a,!1)),s.queryChanged(t)}},s.processJson=function(e){s.jiraFields=e;var t=[],a=[];e.forEach((function(e){e.label=e.name+(e.name.toLowerCase()!==e.id.toLowerCase()?" (".concat(e.id,")"):""),e.value=e.id,e.custom?a.push(e):t.push(e)})),t=t.orderBy((function(e){return e.name})),a=a.orderBy((function(e){return e.name})),s.setState({filterFields:[{label:"Basic Fields",items:t.filter((function(e){return e.clauseNames&&e.clauseNames.length>0}))},{label:"Custom Fields",items:a.filter((function(e){return e.clauseNames&&e.clauseNames.length>0}))}]}),s.setState({displayFields:[{label:"Basic Fields",items:t},{label:"Custom Fields",items:a}]})},s.querySelected=function(e){s.$report.getReportDefinition(e).then((function(t){return s.setState({selReportId:e,reportQuery:t})}))},s.deleteQuery=function(){N.b.confirmDelete('Are you sure to delete the report named "'.concat(s.state.reportQuery.queryName,'" permenantly?')).then((function(){s.$report.deleteSavedQuery(s.state.selReportId).then((function(e){s.$message.success("Report deleted successfully!"),s.setState({selReportId:null}),s.initModel(),s.fillQueriesList()}))}))},s.queryChanged=function(e){s.setState({reportQuery:e}),s.props.onChange(e)},s.jqlChanged=function(e){var t=s.state.reportQuery;(t=Object(n.a)({},t)).jql=e,s.queryChanged(t)},s.setFunction=function(e,t){var a=s.state.reportQuery;a=Object(n.a)({},a);var o=Object(r.a)(a.outputFields);a.outputFields=o;var i=Object(n.a)({},o[e]);o[e]=i,i.functions=t,s.queryChanged(a)},s.viewReport=function(){return s.props.onViewReport(s.state.reportQuery)},s.showSaveDialog=function(){return s.setState({showSaveDialog:!0})},s.saveAs=function(){return s.saveQuery(s.state.reportQuery.queryName)},s.hideSaveDialog=function(){return s.setState({showSaveDialog:!1})},s.className="query-editor-gadget",s.isGadget=!1,s.hideMenu=!0,s.hideRefresh=!0,Object(g.a)(Object(i.a)(s),"ReportService","JiraService","MessageService","AnalyticsService"),s.state=s.getClearState(!1,e),s.state.displayFields=[],s}return Object(s.a)(a,[{key:"getClearState",value:function(e,t){var a=this.state.reportQuery;return!a||e?a=t&&t.reportQuery?Object(n.a)({},t.reportQuery):{fields:{},filterFields:[],outputFields:[]}:(a.fields=a.fields||{},a.filterFields=a.filterFields||[],a.outputFields=a.outputFields||[]),t.reportId>0&&this.querySelected(parseInt(t.reportId)),{reportQuery:a,selReportId:null}}},{key:"UNSAFE_componentWillMount",value:function(){this.$jira.getCustomFields().then(this.processJson),this.props.builderOnly||this.fillQueriesList()}},{key:"fillQueriesList",value:function(){var e=this;this.$report.getReportsList().then((function(t){var a=t.filter((function(e){return!e.advanced&&!e.isNew})).map((function(e){return{value:e.id,label:e.queryName}}));e.setState({reportsList:a})}))}},{key:"generateJql",value:function(){for(var e=[],t=this.state.reportQuery.filterFields,a=0;a<t.length;a++){var r=t[a],n=r.value,o=r.custom?r.name:r.clauseName,s=r.value2;if(s&&(s='"'.concat(s.trim(),'"')),o.indexOf(" ")>-1&&(o='"'.concat(o,'"')),Array.isArray(r.valueArr)&&r.valueArr.length>0)n=r.valueArr.filter((function(e){return!!e})).map((function(e){return'"'.concat(e.trim(),'"')})).join(",");else if(r.quickDate){var i=Object(f.v)(r.quickDate);n=i[0].format("yyyy-MM-dd"),s=i[1].format("yyyy-MM-dd")}else"string"===typeof n&&(n='"'.concat(n.trim(),'"'));n&&e.push(r.operator.format([o,n,s]))}return e.join(" AND ")}},{key:"isSaveEnabled",value:function(){var e=this.state.reportQuery;return e.jql&&e.jql.trim().length>10&&e.outputFields&&e.outputFields.length>=1}},{key:"groupField",value:function(e,t){var a=!e.groupBy,o=this.state.reportQuery;o=Object(n.a)({},o);var s=Object(r.a)(o.outputFields);if(o.outputFields=s,a)for(var i=0;i<t;i++)s[i].groupBy=a;else for(var l=t+1;l<s.length;l++)s[l].groupBy=a;this.queryChanged(o)}},{key:"getField",value:function(e,t){var a={id:e.id,name:e.name,custom:e.custom};t&&(a.clauseName=e.clauseNames[0]);var r=e.schema||{},n=r.type||"(Unsupported)",o=r.system,s=r.items;if("issuekey"===e.id)return a.type="string",a;switch(n){case"user":a.knownObj=!0;case"string":case"date":case"datetime":case"(Unsupported)":a.type=n;break;case"number":switch(o){case"timeoriginalestimate":case"aggregatetimespent":case"aggregatetimeoriginalestimate":case"workratio":case"timespent":case"timeestimate":case"aggregatetimeestimate":a.type="seconds";break;default:a.type=n}break;case"issuetype":case"priority":case"project":case"progress":case"comments-page":case"resolution":case"securitylevel":case"status":case"timetracking":case"votes":case"watches":a.knownObj=!0,a.type=o;break;case"array":if(a.isArray=!0,e.custom)switch(s){case"user":a.knownObj=!0;case"string":case"date":case"datetime":case"numeric":case"option":a.type=s;break;default:a.type=JSON.stringify(e)}else switch(o){case"versions":case"fixVersions":case"attachment":case"components":case"issuelinks":case"subtasks":a.knownObj=!0,a.type=s||o;break;case"worklog":a.type=s||o,a.isArray=!1;break;case"labels":a.type=s||o;break;default:a.type=JSON.stringify(e)}break;default:a.type=JSON.stringify(e)}return a}},{key:"filterAdded",value:function(e){if(e&&!e.items){var t=this.jiraFields.first((function(t){return t.id===e})),a=this.state.reportQuery;(a=Object(n.a)({},a)).filterFields=a.filterFields.concat(this.getField(t,!0)),this.queryChanged(a),this.selectedFilterField=""}}},{key:"removeOutputField",value:function(e){var t=this.state.reportQuery;(t=Object(n.a)({},t)).outputFields.splice(e,1),this.queryChanged(t)}},{key:"columnReordered",value:function(e){var t=e.value,a=e.dropIndex,r=this.state.reportQuery.outputFields[a+1]||this.state.reportQuery.outputFields[a-1];r&&(t.groupBy=r.groupBy)}},{key:"updateJql",value:function(){this.state.reportQuery.filterFields&&this.state.reportQuery.filterFields.length>0&&(this.state.reportQuery.jql=this.generateJql())}},{key:"tabChanged",value:function(e){1===e.index&&this.updateJql()}},{key:"renderCustomActions",value:function(){var e=this.state,t=e.reportsList,a=e.selReportId;return t&&0!==t.length?p.a.createElement(p.a.Fragment,null,p.a.createElement(v.i,{dataset:t,value:a,valueField:"value",onChange:this.querySelected,placeholder:"Select a report to edit"}),p.a.createElement(v.b,{icon:"fa fa-plus",onClick:this.initModel,label:"New query"})):null}},{key:"renderFooter",value:function(){var e=this.state.reportQuery,t=this.isSaveEnabled(),a=e.id>0;return p.a.createElement("div",{className:"pnl-footer"},e.id&&p.a.createElement("div",{className:"pull-left"},p.a.createElement(v.b,{icon:"fa fa-trash",label:"Delete Query",type:"danger",onClick:this.deleteQuery}),p.a.createElement(v.b,{icon:"fa fa-floppy-o",label:"Save Query As",type:"success",onClick:this.showSaveDialog,disabled:!t})),p.a.createElement("div",{className:"pull-right"},p.a.createElement(v.b,{icon:"fa fa-floppy-o",label:"Save Query",type:"success",onClick:a?this.saveAs:this.showSaveDialog,disabled:!t||e.isSystemQuery}),p.a.createElement(v.b,{icon:"fa fa-list",label:"View Report",type:"info",onClick:this.viewReport,disabled:!t})))}},{key:"render",value:function(){var e=this,t=this.props.builderOnly,r=this.state,n=r.reportQuery,o=r.displayFields,s=r.showSaveDialog,i=n.id>0,u=p.a.createElement(p.a.Fragment,null,p.a.createElement(y.TabView,null,p.a.createElement(y.TabPanel,{header:"Advanced Filter (JQL)"},p.a.createElement(v.j,{multiline:!0,value:n.jql,onChange:this.jqlChanged,style:{minWidth:"100%",minHeight:100,height:"100%"}})),p.a.createElement(y.TabPanel,{header:"Display Settings",leftIcon:"fa fa-columns"},p.a.createElement(k.c,{className:"query-editor"},p.a.createElement(k.e,null,p.a.createElement("tr",null,p.a.createElement("th",null,"#"),p.a.createElement("th",null,"Display Column"),p.a.createElement("th",{className:"col-type"},"Type"),!t&&p.a.createElement("th",{className:"col-group-by"},"Group By"),!t&&p.a.createElement("th",{className:"col-format-func"},"Format function"),p.a.createElement("th",null,"Remove"))),p.a.createElement("tbody",{model:n.outputFields,onDrop:this.columnReordered},n.outputFields.map((function(a,r){return p.a.createElement("tr",{key:a._uniqueId,style:{cursor:"move"},model:a},p.a.createElement("td",{className:"data-center"},r+1),p.a.createElement("td",null,a.name),p.a.createElement("td",null,a.type," ",a.isArray?"(multiple)":""),!t&&p.a.createElement("td",{className:"data-center"},p.a.createElement(v.c,{checked:a.groupBy,onChange:function(t){a.groupBy=t,e.groupField(a,r)}})),!t&&p.a.createElement("td",null,p.a.createElement(w,{row:a,onChange:function(t){return e.setFunction(r,t)}})),p.a.createElement("td",{className:"data-center"},p.a.createElement("i",{className:"fa fa-times pointer",onClick:function(){return e.removeOutputField(r)}})))}))),p.a.createElement("tbody",null,p.a.createElement("tr",null,p.a.createElement("td",{className:"data-center"},n.outputFields.length+1),p.a.createElement("td",null,p.a.createElement(v.i,{dataset:o,value:"",style:{width:"100%"},placeholder:"Choose a column to add to the list",group:!0,displayField:"name",valueField:"id",dataKey:"id",filterPlaceholder:"Type the field name to filter",onChange:this.displayFieldAdded},(function(e,t){return p.a.createElement("span",null,e.name)}),(function(e,t){return p.a.createElement("strong",null,e.label)}))),p.a.createElement("td",{colSpan:5},"Note: Select the column from the list to add it as output")))))),s&&p.a.createElement(S.a,{queryName:n.queryName,allowCopy:i,onHide:this.hideSaveDialog,onChange:this.saveQuery}));return t?u:Object(l.a)(Object(c.a)(a.prototype),"renderBase",this).call(this,u)}}]),a}(h.b);t.a=C},853:function(e,t,a){"use strict";a.r(t);var r=a(5),n=a(6),o=a(15),s=a(16),i=a(2),l=a.n(i),c=a(399),u=a(356),d=(a(331),function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(e){var n;Object(r.a)(this,a),(n=t.call(this,e)).viewReport=function(e){n.setState({viewReport:!0,reportDefinition:e})},n.queryChanged=function(e){};var o=e.match.params.reportId;return n.state={reportId:o},n}return Object(n.a)(a,[{key:"render",value:function(){var e=this.state,t=e.reportId,a=e.viewReport,r=e.reportDefinition;return l.a.createElement("div",{className:"custom-report"},l.a.createElement(c.a,{reportId:t,onViewReport:this.viewReport,onChange:this.queryChanged}),a&&r&&l.a.createElement(u.a,{key:r._uniqueId,isGadget:!1,definition:r}))}}]),a}(i.PureComponent));t.default=d}}]);
//# sourceMappingURL=21.b508c383.chunk.js.map